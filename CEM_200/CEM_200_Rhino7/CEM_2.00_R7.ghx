<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<Archive name="Root">
  <!--Grasshopper archive-->
  <!--Grasshopper and GH_IO.dll are copyrighted by Robert McNeel & Associates-->
  <!--Archive generated by GH_IO.dll file utility library {0.2.0002}-->
  <items count="1">
    <item name="ArchiveVersion" type_name="gh_version" type_code="80">
      <Major>0</Major>
      <Minor>2</Minor>
      <Revision>2</Revision>
    </item>
  </items>
  <chunks count="2">
    <chunk name="Definition">
      <items count="1">
        <item name="plugin_version" type_name="gh_version" type_code="80">
          <Major>1</Major>
          <Minor>0</Minor>
          <Revision>7</Revision>
        </item>
      </items>
      <chunks count="5">
        <chunk name="DocumentHeader">
          <items count="5">
            <item name="DocumentID" type_name="gh_guid" type_code="9">3cc3db46-5aed-4547-88a3-2d41819a70fc</item>
            <item name="Preview" type_name="gh_string" type_code="10">Shaded</item>
            <item name="PreviewMeshType" type_name="gh_int32" type_code="3">1</item>
            <item name="PreviewNormal" type_name="gh_drawing_color" type_code="36">
              <ARGB>100;150;0;0</ARGB>
            </item>
            <item name="PreviewSelected" type_name="gh_drawing_color" type_code="36">
              <ARGB>100;0;150;0</ARGB>
            </item>
          </items>
        </chunk>
        <chunk name="DefinitionProperties">
          <items count="3">
            <item name="Date" type_name="gh_date" type_code="8">636423691844301730</item>
            <item name="Description" type_name="gh_string" type_code="10"></item>
            <item name="Name" type_name="gh_string" type_code="10">CEM_2.00_R7.ghx</item>
          </items>
          <chunks count="3">
            <chunk name="Revisions">
              <items count="1">
                <item name="RevisionCount" type_name="gh_int32" type_code="3">0</item>
              </items>
            </chunk>
            <chunk name="Projection">
              <items count="2">
                <item name="Target" type_name="gh_drawing_point" type_code="30">
                  <X>-1104</X>
                  <Y>-682</Y>
                </item>
                <item name="Zoom" type_name="gh_single" type_code="5">0.850000143</item>
              </items>
            </chunk>
            <chunk name="Views">
              <items count="1">
                <item name="ViewCount" type_name="gh_int32" type_code="3">0</item>
              </items>
            </chunk>
          </chunks>
        </chunk>
        <chunk name="RcpLayout">
          <items count="1">
            <item name="GroupCount" type_name="gh_int32" type_code="3">0</item>
          </items>
        </chunk>
        <chunk name="GHALibraries">
          <items count="1">
            <item name="Count" type_name="gh_int32" type_code="3">1</item>
          </items>
          <chunks count="1">
            <chunk name="Library" index="0">
              <items count="6">
                <item name="AssemblyFullName" type_name="gh_string" type_code="10">GhPython, Version=7.9.21222.15001, Culture=neutral, PublicKeyToken=null</item>
                <item name="AssemblyVersion" type_name="gh_string" type_code="10">7.9.21222.15001</item>
                <item name="Author" type_name="gh_string" type_code="10"></item>
                <item name="Id" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10"></item>
                <item name="Version" type_name="gh_string" type_code="10"></item>
              </items>
            </chunk>
          </chunks>
        </chunk>
        <chunk name="DefinitionObjects">
          <items count="1">
            <item name="ObjectCount" type_name="gh_int32" type_code="3">67</item>
          </items>
          <chunks count="67">
            <chunk name="Object" index="0">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">c552a431-af5b-46a9-a8a4-0fcbc27ef596</item>
                <item name="Name" type_name="gh_string" type_code="10">Group</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="9">
                    <item name="Border" type_name="gh_int32" type_code="3">1</item>
                    <item name="Colour" type_name="gh_drawing_color" type_code="36">
                      <ARGB>150;255;255;255</ARGB>
                    </item>
                    <item name="Description" type_name="gh_string" type_code="10">A group of Grasshopper objects</item>
                    <item name="ID" index="0" type_name="gh_guid" type_code="9">ae44c1fa-2097-48ac-a7f9-48469e691592</item>
                    <item name="ID" index="1" type_name="gh_guid" type_code="9">a4bd705a-e545-457b-8f18-2801fe620612</item>
                    <item name="ID_Count" type_name="gh_int32" type_code="3">2</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">d7455c65-1539-463a-a8ff-c5da252c7916</item>
                    <item name="Name" type_name="gh_string" type_code="10">Group</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                  </items>
                  <chunks count="1">
                    <chunk name="Attributes" />
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="1">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">7f5c6c55-f846-4a08-9c9a-cfdc285cc6fe</item>
                <item name="Name" type_name="gh_string" type_code="10">Scribble</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="Bold" type_name="gh_bool" type_code="1">true</item>
                    <item name="Ca" type_name="gh_drawing_pointf" type_code="31">
                      <X>44.80301</X>
                      <Y>46.41676</Y>
                    </item>
                    <item name="Cb" type_name="gh_drawing_pointf" type_code="31">
                      <X>186.4168</X>
                      <Y>46.41676</Y>
                    </item>
                    <item name="Cc" type_name="gh_drawing_pointf" type_code="31">
                      <X>186.4168</X>
                      <Y>57.81324</Y>
                    </item>
                    <item name="Cd" type_name="gh_drawing_pointf" type_code="31">
                      <X>44.80301</X>
                      <Y>57.81324</Y>
                    </item>
                    <item name="Description" type_name="gh_string" type_code="10">A quick note</item>
                    <item name="Font" type_name="gh_string" type_code="10">Microsoft Sans Serif</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">ae44c1fa-2097-48ac-a7f9-48469e691592</item>
                    <item name="Italic" type_name="gh_bool" type_code="1">false</item>
                    <item name="Name" type_name="gh_string" type_code="10">Scribble</item>
                    <item name="NickName" type_name="gh_string" type_code="10">Scribble</item>
                    <item name="Size" type_name="gh_single" type_code="5">15</item>
                    <item name="Text" type_name="gh_string" type_code="10">CEM - Release 2.00</item>
                  </items>
                  <chunks count="1">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>39.80301</X>
                          <Y>41.41676</Y>
                          <W>151.6138</W>
                          <H>21.39648</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>44.80301</X>
                          <Y>46.41676</Y>
                        </item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="2">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">7f5c6c55-f846-4a08-9c9a-cfdc285cc6fe</item>
                <item name="Name" type_name="gh_string" type_code="10">Scribble</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="Bold" type_name="gh_bool" type_code="1">true</item>
                    <item name="Ca" type_name="gh_drawing_pointf" type_code="31">
                      <X>45.1748</X>
                      <Y>72.87675</Y>
                    </item>
                    <item name="Cb" type_name="gh_drawing_pointf" type_code="31">
                      <X>440.3701</X>
                      <Y>72.87675</Y>
                    </item>
                    <item name="Cc" type_name="gh_drawing_pointf" type_code="31">
                      <X>440.3701</X>
                      <Y>172.9988</Y>
                    </item>
                    <item name="Cd" type_name="gh_drawing_pointf" type_code="31">
                      <X>45.1748</X>
                      <Y>172.9988</Y>
                    </item>
                    <item name="Description" type_name="gh_string" type_code="10">A quick note</item>
                    <item name="Font" type_name="gh_string" type_code="10">Microsoft Sans Serif</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">a4bd705a-e545-457b-8f18-2801fe620612</item>
                    <item name="Italic" type_name="gh_bool" type_code="1">false</item>
                    <item name="Name" type_name="gh_string" type_code="10">Scribble</item>
                    <item name="NickName" type_name="gh_string" type_code="10">Scribble</item>
                    <item name="Size" type_name="gh_single" type_code="5">10</item>
                    <item name="Text" type_name="gh_string" type_code="10">If you use the library of CEM in a project, please refer to the CEM GitHub repository:

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}</item>
                  </items>
                  <chunks count="1">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>40.1748</X>
                          <Y>67.87675</Y>
                          <W>405.1953</W>
                          <H>110.1221</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>45.1748</X>
                          <Y>72.87675</Y>
                        </item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="3">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">2e78987b-9dfb-42a2-8b76-3923ac8bd91a</item>
                <item name="Name" type_name="gh_string" type_code="10">Boolean Toggle</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="7">
                    <item name="Description" type_name="gh_string" type_code="10">Boolean (true/false) toggle</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">4163c080-6465-4b0b-a20e-09bfb6103258</item>
                    <item name="Name" type_name="gh_string" type_code="10">Boolean Toggle</item>
                    <item name="NickName" type_name="gh_string" type_code="10">Self Weight</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                    <item name="ToggleValue" type_name="gh_bool" type_code="1">false</item>
                  </items>
                  <chunks count="1">
                    <chunk name="Attributes">
                      <items count="1">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1239</X>
                          <Y>866</Y>
                          <W>126</W>
                          <H>22</H>
                        </item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="4">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Defines a new deviation object from inputs
    Inputs:
        deviationEdge: (curves) The curves that define the deviation members in the topological diagram
        deviationMagn: (float) The force magnitudes of the deviation members [kN] (tension-positive, compression-negative) 
    Outputs:
        D: (deviationObject) The constructed deviation object
    Remarks:
        This generates a new instance of the deviation object
"""


__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""


class Deviation(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        if deviationEdge:
            return "Deviation Member"

if deviationEdge:
    D = Deviation()
    D.geom = []
    D.magn = []
    
    if deviationMagn and None not in deviationMagn:
        if len(deviationEdge) == len(deviationMagn):
            deviationMagnC = []
            for i in range(len(deviationEdge)):
                deviationMagnC.append( deviationMagn[i] )
            D.geom = deviationEdge
            D.magn = deviationMagnC
        elif len(deviationMagn) == 1:
            deviationMagnC = []
            for i in range(len(deviationEdge)):
                deviationMagnC.append( deviationMagn[0] )
            D.geom = deviationEdge
            D.magn = deviationMagnC
        else:
            deviationMagnC = []
            for i in range(len(deviationEdge)):
                deviationMagnC.append( 1 )
            D.geom = deviationEdge
            D.magn = deviationMagnC
    else:
        deviationMagnC = []
        for i in range(len(deviationEdge)):
            deviationMagnC.append( 1 )
        D.geom = deviationEdge
        D.magn = deviationMagnC</item>
                    <item name="Description" type_name="gh_string" type_code="10">Defines a new deviation object from inputs</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>182</X>
                      <Y>182</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>2200</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">312bd41b-ca79-47c3-b1da-1c109bacfc2f</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Deviation_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>326</X>
                          <Y>716</Y>
                          <W>148</W>
                          <H>44</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>439</X>
                          <Y>738</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="5">
                        <item name="InputCount" type_name="gh_int32" type_code="3">2</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="3">
                        <chunk name="InputParam" index="0">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(curves) The curves that define the deviation members in the topological diagram</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">d8c819dd-7ab4-443b-94ec-b7bf410d0f97</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">deviationEdge</item>
                            <item name="NickName" type_name="gh_string" type_code="10">deviationEdge</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">975873b3-c21e-4f57-bd5d-1e072de1672a</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">9ba89ec2-5315-435f-a621-b66c5fa2f301</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>328</X>
                                  <Y>718</Y>
                                  <W>96</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>385.5</X>
                                  <Y>728</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The force magnitudes of the deviation members [kN] (tension-positive, compression-negative) </item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">5c181fe9-ac88-4328-bab1-e6458b932f8e</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">deviationMagn</item>
                            <item name="NickName" type_name="gh_string" type_code="10">deviationMagn</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">a847a333-6c84-40ee-ae67-9432356b1a88</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>328</X>
                                  <Y>738</Y>
                                  <W>96</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>385.5</X>
                                  <Y>748</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(deviationObject) The constructed deviation object</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">5b0f0d53-8226-4037-ab21-e051867b2cf5</item>
                            <item name="Name" type_name="gh_string" type_code="10">D</item>
                            <item name="NickName" type_name="gh_string" type_code="10">D</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>454</X>
                                  <Y>718</Y>
                                  <W>18</W>
                                  <H>40</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>463</X>
                                  <Y>738</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="5">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">
"""
Defines a new support object from inputs
    Inputs:
        support: (points) The support points in the topological diagram
    Outputs:
        S: (supportObject) The constructed support object 
    Remarks:
        This generates a new instance of the support object
"""


__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""

class Support(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        if support:
            return "Support"


if support:
    S = Support()
    S.geom = support
</item>
                    <item name="Description" type_name="gh_string" type_code="10">Defines a new support object from inputs</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>335</X>
                      <Y>125</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1301</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">e7291208-4884-4a61-8513-2a4acf53647c</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Support_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>363</X>
                          <Y>889</Y>
                          <W>111</W>
                          <H>28</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>441</X>
                          <Y>903</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="4">
                        <item name="InputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="2">
                        <chunk name="InputParam" index="0">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(points) The support points in the topological diagram</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">08b5abe9-46f3-4a8d-84ba-2ae33ccedcfc</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">support</item>
                            <item name="NickName" type_name="gh_string" type_code="10">support</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">b5e5237d-534d-4823-80b2-00955e8e1fe3</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">e1937b56-b1da-4c12-8bd8-e34ee81746ef</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>365</X>
                                  <Y>891</Y>
                                  <W>61</W>
                                  <H>24</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>405</X>
                                  <Y>903</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(supportObject) The constructed support object </item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">7b84febe-62cc-4200-b79e-7b0fbe8d2f22</item>
                            <item name="Name" type_name="gh_string" type_code="10">S</item>
                            <item name="NickName" type_name="gh_string" type_code="10">S</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>456</X>
                                  <Y>891</Y>
                                  <W>16</W>
                                  <H>24</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>464</X>
                                  <Y>903</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="6">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Assign self weight
    Inputs:
        selfWeight: (bool) Activate the self weight of the structure
        yieldStress: (double) The yield stress of the structural members
        specWeight: (double) The specific weight of the structural members
    Outputs:
        SW: (self-weight) The assigned self weight properties 
    Remarks:
        This generates a new instance of self weight
"""


__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""



import Rhino


class SWeight(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        if selfWeight and yieldStress and specWeight:
                return "Self Weight"
        else:
            return "No Self Weight"

SW = SWeight()
if selfWeight and yieldStress and specWeight:
    SW.yieldStress = yieldStress
    SW.specWeight = specWeight


</item>
                    <item name="Description" type_name="gh_string" type_code="10">Assign self weight</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>396</X>
                      <Y>396</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1301</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">8bd1b861-1c18-4024-86eb-0a72a820c36a</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Material_Properties_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1694</X>
                          <Y>911</Y>
                          <W>124</W>
                          <H>64</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1775</X>
                          <Y>943</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="6">
                        <item name="InputCount" type_name="gh_int32" type_code="3">3</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="2" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="4">
                        <chunk name="InputParam" index="0">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(bool) Activate the self weight of the structure</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">9792569b-3bed-49fc-833f-fce29e6dd326</item>
                            <item name="Name" type_name="gh_string" type_code="10">selfWeight</item>
                            <item name="NickName" type_name="gh_string" type_code="10">selfWeight</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">4163c080-6465-4b0b-a20e-09bfb6103258</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">d60527f5-b5af-4ef6-8970-5f96fe412559</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1696</X>
                                  <Y>913</Y>
                                  <W>64</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1729.5</X>
                                  <Y>923</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(double) The yield stress of the structural members</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">705ef387-12f0-45b9-b7e3-9c2496dfa860</item>
                            <item name="Name" type_name="gh_string" type_code="10">yieldStress</item>
                            <item name="NickName" type_name="gh_string" type_code="10">yieldStress</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">36b9d765-08a5-4e7e-ad88-833a3447e9b4</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1696</X>
                                  <Y>933</Y>
                                  <W>64</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1729.5</X>
                                  <Y>943</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="2">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(double) The specific weight of the structural members</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">247560ba-df19-466d-9bb1-2e38505ec686</item>
                            <item name="Name" type_name="gh_string" type_code="10">specWeight</item>
                            <item name="NickName" type_name="gh_string" type_code="10">specWeight</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">a2b124ff-1377-4c97-b8c3-4d88ff8ceed0</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1696</X>
                                  <Y>953</Y>
                                  <W>64</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1729.5</X>
                                  <Y>963</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(self-weight) The assigned self weight properties </item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">ea66d6c1-2e43-435b-8373-c1b8e49a3d87</item>
                            <item name="Name" type_name="gh_string" type_code="10">SW</item>
                            <item name="NickName" type_name="gh_string" type_code="10">SW</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1790</X>
                                  <Y>913</Y>
                                  <W>26</W>
                                  <H>60</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1803</X>
                                  <Y>943</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="7">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Locate origin nodes
    Inputs:
        originNode: (point3d) position of origin node in form diagram
        originNodeID: (integer) index of corresponding node
    Outputs:
        N: (origin-nodes) The assigned origin nodes
    Remarks:
        This generates a new instance of origin nodes
"""


__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""


import Rhino


class ONode(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        if originNode and originNode[0] is not None and len(originNode) == len(originNodeID):
            return str(len(originNode)) + " Defined Origin Nodes"
        else:
            return "Undefined Origin Nodes"


N = ONode()

if originNode and originNode[0] is not None and len(originNode) == len(originNodeID):
    N.originNode = originNode
    originNodeID = [ int(nodeID[1:]) for nodeID in originNodeID]
    N.originNodeID = originNodeID

</item>
                    <item name="Description" type_name="gh_string" type_code="10">Locate origin nodes</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>52</X>
                      <Y>52</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1301</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">1cee786c-1a85-428e-8d5c-4c8b766bd569</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Origin_Node_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1677</X>
                          <Y>736</Y>
                          <W>141</W>
                          <H>44</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1783</X>
                          <Y>758</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="5">
                        <item name="InputCount" type_name="gh_int32" type_code="3">2</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="3">
                        <chunk name="InputParam" index="0">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(point3d) position of origin node in form diagram</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">77bf11c2-1c40-4fcf-8e03-2d65326a4bfe</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">originNode</item>
                            <item name="NickName" type_name="gh_string" type_code="10">originNode</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">9c8503be-0683-40a5-ad3d-13f8c2902a11</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">e1937b56-b1da-4c12-8bd8-e34ee81746ef</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1679</X>
                                  <Y>738</Y>
                                  <W>89</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1733</X>
                                  <Y>748</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(integer) index of corresponding node</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">342d7576-df32-4466-b539-1e17af5d6af7</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">originNodeID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">originNodeID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">441133c2-e05b-449f-918a-77aad1252fc9</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">37261734-eec7-4f50-b6a8-b8d1f3c4396b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1679</X>
                                  <Y>758</Y>
                                  <W>89</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1733</X>
                                  <Y>768</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(origin-nodes) The assigned origin nodes</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">ed6f0ae9-eed8-4917-9d07-39feb0e56262</item>
                            <item name="Name" type_name="gh_string" type_code="10">N</item>
                            <item name="NickName" type_name="gh_string" type_code="10">N</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1798</X>
                                  <Y>738</Y>
                                  <W>18</W>
                                  <H>40</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1807</X>
                                  <Y>758</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="8">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Defines new trail edges from inputs
    Inputs:
        trailEdge: (curves) The curves (segments) that define the trail members in the topological diagram
        trailLen: (float) The lenghts of the trail members [m] (tension-positive, compression-negative)
    Outputs:
        T: (trailObject) The constructed trail object
    Remarks:
        This generates a new instance of a trail object
"""

__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""

import Rhino


class Trail(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        if trailEdge:
            return "Trail Member"



if trailEdge:
    T = Trail()
    T.geom = []
    T.len = []
    
    if trailLen and None not in trailLen:
        if len(trailEdge) == len(trailLen):
            trailLenC = []
            for i in range(len(trailEdge)):
                trailLenC.append( trailLen[i] )
            T.geom = trailEdge
            T.len = trailLenC
        elif len(trailLen) == 1:
            trailLenC = []
            for i in range(len(trailEdge)):
                trailLenC.append( trailLen[0] )
            T.geom = trailEdge
            T.len = trailLenC
        else:
            trailLenC = []
            for i in range(len(trailEdge)):
                trailLenC.append( 1 )
            T.geom = trailEdge
            T.len = trailLenC
    else:
        trailLenC = []
        for i in range(len(trailEdge)):
            trailLenC.append( 1 )
        T.geom = trailEdge
        T.len = trailLenC


</item>
                    <item name="Description" type_name="gh_string" type_code="10">Defines new trail edges from inputs</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>52</X>
                      <Y>52</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1725</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">10f752a8-a273-4caa-8dd2-bdd81296b024</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Trail_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>358</X>
                          <Y>413</Y>
                          <W>116</W>
                          <H>44</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>441</X>
                          <Y>435</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="5">
                        <item name="InputCount" type_name="gh_int32" type_code="3">2</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="3">
                        <chunk name="InputParam" index="0">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(curves) The curves (segments) that define the trail members in the topological diagram</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">3c949a2f-c615-4ab2-a47b-a27dbbdd887e</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">trailEdge</item>
                            <item name="NickName" type_name="gh_string" type_code="10">trailEdge</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">4ffc0dfc-f146-4a7f-b29b-49ef66c29d6e</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">9ba89ec2-5315-435f-a621-b66c5fa2f301</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>360</X>
                                  <Y>415</Y>
                                  <W>66</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>402.5</X>
                                  <Y>425</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The lenghts of the trail members [m] (tension-positive, compression-negative)</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">3df87358-53fa-4ba9-87ab-42cae4f819eb</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">trailLen</item>
                            <item name="NickName" type_name="gh_string" type_code="10">trailLen</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">a84b9765-6d5f-4d88-8f44-69171189d187</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>360</X>
                                  <Y>435</Y>
                                  <W>66</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>402.5</X>
                                  <Y>445</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(trailObject) The constructed trail object</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">07a525d6-dedc-4ab1-8200-45627ee63768</item>
                            <item name="Name" type_name="gh_string" type_code="10">T</item>
                            <item name="NickName" type_name="gh_string" type_code="10">T</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>456</X>
                                  <Y>415</Y>
                                  <W>16</W>
                                  <H>40</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>464</X>
                                  <Y>435</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="9">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="14">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Defines a new point load object from inputs
    Inputs:
        pointLoad: (point) The vertices that define the point loads in the topological diagram
        loadMagnX: (float) The magnitude of the point load in x-direction [kN]
        loadMagnY: (float) The magnitude of the point load in y-direction [kN]
        loadMagnZ: (float) The magnitude of the point load in z-direction [kN]
    Outputs:
        L: (pointLoadObject) The constructed point load object
    Remarks:
        This generates a new instance of the constructed point load object 
"""

__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""


import Rhino


class Load(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        if pointLoad:
            return "Point Load"
        else:
            return "No external Load"



if pointLoad:
    L = Load()
    L.geom = []
    L.magn = []
    
    if not loadMagnX: loadMagnX.append(0.0)
    if not loadMagnY: loadMagnY.append(0.0)
    if not loadMagnZ: loadMagnZ.append(0.0)
    
    loadMagn = []
    if len(loadMagnX) == len(loadMagnY) == len(loadMagnZ) and None not in loadMagnX and None not in loadMagnY and None not in loadMagnZ:
        if len(pointLoad) == len(loadMagnX):
            for i in range(len(pointLoad)):
                loadMagn.append( (loadMagnX[i],loadMagnY[i],loadMagnZ[i]) )
            L.geom = pointLoad
            L.magn = loadMagn
        elif len(loadMagnX) == 1:
            for i in range(len(pointLoad)):
                loadMagn.append( (loadMagnX[0],loadMagnY[0],loadMagnZ[0]) )
            L.geom = pointLoad
            L.magn = loadMagn
        else:
            for i in range(len(pointLoad)):
                loadMagn.append( (0,0,0) )
            L.geom = pointLoad
            L.magn = loadMagn
    else:
        for i in range(len(pointLoad)):
            loadMagn.append( (0,0,0) )
        L.geom = pointLoad
        L.magn = loadMagn
</item>
                    <item name="Description" type_name="gh_string" type_code="10">Defines a new point load object from inputs</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>156</X>
                      <Y>156</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1723</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="IconDisplay" type_name="gh_int32" type_code="3">1</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">bb7350c0-ebc3-4f5b-b4e9-dec17413ffd5</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Load_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>346</X>
                          <Y>519</Y>
                          <W>128</W>
                          <H>105</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>442</X>
                          <Y>572</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="7">
                        <item name="InputCount" type_name="gh_int32" type_code="3">4</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="2" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="3" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="5">
                        <chunk name="InputParam" index="0">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(point) The vertices that define the point loads in the topological diagram</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">5da44f6c-1da9-4177-8000-802dc2dbe4c3</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">pointLoad</item>
                            <item name="NickName" type_name="gh_string" type_code="10">pointLoad</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">0a88a001-f0a2-44c6-9184-6b232e4de7af</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">e1937b56-b1da-4c12-8bd8-e34ee81746ef</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>348</X>
                                  <Y>521</Y>
                                  <W>79</W>
                                  <H>25</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>397</X>
                                  <Y>533.625</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The magnitude of the point load in x-direction [kN]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">723f54a0-3dbd-42a6-883f-b2d23543bf9c</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">loadMagnX</item>
                            <item name="NickName" type_name="gh_string" type_code="10">loadMagnX</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">47897302-9fea-4128-961d-7801c009c67b</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>348</X>
                                  <Y>546</Y>
                                  <W>79</W>
                                  <H>25</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>397</X>
                                  <Y>558.875</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="2">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The magnitude of the point load in y-direction [kN]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">3d12f18e-47cf-4ccf-a115-e75d197a3ab1</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">loadMagnY</item>
                            <item name="NickName" type_name="gh_string" type_code="10">loadMagnY</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">3901472b-d20b-44de-a3e2-eaf6e709a6e8</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>348</X>
                                  <Y>571</Y>
                                  <W>79</W>
                                  <H>25</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>397</X>
                                  <Y>584.125</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="3">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The magnitude of the point load in z-direction [kN]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">bd77aba6-ce5b-4456-aeb8-7e053035fe80</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">loadMagnZ</item>
                            <item name="NickName" type_name="gh_string" type_code="10">loadMagnZ</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">78ab3ff7-bf46-42c5-8905-b92a8cb033b4</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>348</X>
                                  <Y>596</Y>
                                  <W>79</W>
                                  <H>26</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>397</X>
                                  <Y>609.375</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(pointLoadObject) The constructed point load object</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">575cd6b9-7cde-4316-8096-41cebaa4f14e</item>
                            <item name="Name" type_name="gh_string" type_code="10">L</item>
                            <item name="NickName" type_name="gh_string" type_code="10">L</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>457</X>
                                  <Y>521</Y>
                                  <W>15</W>
                                  <H>101</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>464.5</X>
                                  <Y>571.5</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="10">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">537b0419-bbc2-4ff4-bf08-afe526367b2c</item>
                <item name="Name" type_name="gh_string" type_code="10">Custom Preview</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Allows for customized geometry previews</item>
                    <item name="IncludeInRender" type_name="gh_bool" type_code="1">true</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">c1e3c86b-af3e-4690-8d76-570cd382c939</item>
                    <item name="Name" type_name="gh_string" type_code="10">Custom Preview</item>
                    <item name="NickName" type_name="gh_string" type_code="10">Preview</item>
                    <item name="ViewportFilter" type_name="gh_string" type_code="10"></item>
                  </items>
                  <chunks count="3">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>2978</X>
                          <Y>1436</Y>
                          <W>48</W>
                          <H>44</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>3012</X>
                          <Y>1458</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="param_input" index="0">
                      <items count="10">
                        <item name="Description" type_name="gh_string" type_code="10">Geometry to preview</item>
                        <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">38018124-311a-4be3-960c-065207727972</item>
                        <item name="Name" type_name="gh_string" type_code="10">Geometry</item>
                        <item name="NickName" type_name="gh_string" type_code="10">G</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="Source" index="0" type_name="gh_guid" type_code="9">3b96d462-fe30-49f8-bf76-4c2a0887941c</item>
                        <item name="Source" index="1" type_name="gh_guid" type_code="9">6dfe8acf-d3cd-4f16-a454-8fc784e6c970</item>
                        <item name="Source" index="2" type_name="gh_guid" type_code="9">7d1f41f7-3d39-4732-8c86-9eb6738ab134</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">3</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2980</X>
                              <Y>1438</Y>
                              <W>17</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2990</X>
                              <Y>1448</Y>
                            </item>
                          </items>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_input" index="1">
                      <items count="9">
                        <item name="Description" type_name="gh_string" type_code="10">The material override</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">a1c38de5-c810-486e-ac97-528a8289073c</item>
                        <item name="Name" type_name="gh_string" type_code="10">Material</item>
                        <item name="NickName" type_name="gh_string" type_code="10">M</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="Source" index="0" type_name="gh_guid" type_code="9">ce841d39-c35c-4e66-b476-7de59a965506</item>
                        <item name="Source" index="1" type_name="gh_guid" type_code="9">b0fc9ece-ddb4-4ffd-ab31-f68637034559</item>
                        <item name="Source" index="2" type_name="gh_guid" type_code="9">05d9ffd3-ea83-468e-8afc-8c1ca05b7504</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">3</item>
                      </items>
                      <chunks count="2">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2980</X>
                              <Y>1458</Y>
                              <W>17</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2990</X>
                              <Y>1468</Y>
                            </item>
                          </items>
                        </chunk>
                        <chunk name="PersistentData">
                          <items count="1">
                            <item name="Count" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Branch" index="0">
                              <items count="2">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Item" index="0">
                                  <items count="5">
                                    <item name="diffuse" type_name="gh_drawing_color" type_code="36">
                                      <ARGB>255;221;160;221</ARGB>
                                    </item>
                                    <item name="emission" type_name="gh_drawing_color" type_code="36">
                                      <ARGB>255;66;48;66</ARGB>
                                    </item>
                                    <item name="shine" type_name="gh_double" type_code="6">0.5</item>
                                    <item name="specular" type_name="gh_drawing_color" type_code="36">
                                      <ARGB>255;255;255;255</ARGB>
                                    </item>
                                    <item name="transparency" type_name="gh_double" type_code="6">0</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="11">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">5a41528b-12b9-40dc-a3f2-842034d267c4</item>
                <item name="Name" type_name="gh_string" type_code="10">Text Tag 3D</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="4">
                    <item name="Description" type_name="gh_string" type_code="10">Represents a list of 3D text tags in a Rhino viewport</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">ea82255d-5674-48d4-8dfa-58000c836104</item>
                    <item name="Name" type_name="gh_string" type_code="10">Text Tag 3D</item>
                    <item name="NickName" type_name="gh_string" type_code="10">Tag</item>
                  </items>
                  <chunks count="6">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>2977</X>
                          <Y>1213</Y>
                          <W>45</W>
                          <H>104</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>3008</X>
                          <Y>1265</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="param_input" index="0">
                      <items count="8">
                        <item name="Description" type_name="gh_string" type_code="10">Location and orientation of text tag</item>
                        <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">78a78520-7b96-409e-bd74-84b6def82f40</item>
                        <item name="Name" type_name="gh_string" type_code="10">Location</item>
                        <item name="NickName" type_name="gh_string" type_code="10">L</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="Source" index="0" type_name="gh_guid" type_code="9">9423ec84-e841-4ae2-b445-4259802bd687</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2979</X>
                              <Y>1215</Y>
                              <W>14</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2987.5</X>
                              <Y>1225</Y>
                            </item>
                          </items>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_input" index="1">
                      <items count="7">
                        <item name="Description" type_name="gh_string" type_code="10">The text to display</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">4ff72268-f58f-4243-86a5-fa5fefd66913</item>
                        <item name="Name" type_name="gh_string" type_code="10">Text</item>
                        <item name="NickName" type_name="gh_string" type_code="10">T</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                        <item name="Source" index="0" type_name="gh_guid" type_code="9">ef9f9f8c-f1b5-44c9-b81f-e0a245217811</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2979</X>
                              <Y>1235</Y>
                              <W>14</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2987.5</X>
                              <Y>1245</Y>
                            </item>
                          </items>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_input" index="2">
                      <items count="6">
                        <item name="Description" type_name="gh_string" type_code="10">Size of text</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">920ef27c-e035-4c7d-8598-390b13d2d6bd</item>
                        <item name="Name" type_name="gh_string" type_code="10">Size</item>
                        <item name="NickName" type_name="gh_string" type_code="10">S</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="2">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2979</X>
                              <Y>1255</Y>
                              <W>14</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2987.5</X>
                              <Y>1265</Y>
                            </item>
                          </items>
                        </chunk>
                        <chunk name="PersistentData">
                          <items count="1">
                            <item name="Count" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Branch" index="0">
                              <items count="2">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Item" index="0">
                                  <items count="1">
                                    <item name="number" type_name="gh_double" type_code="6">0.25</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_input" index="3">
                      <items count="6">
                        <item name="Description" type_name="gh_string" type_code="10">Optional colour of tag</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">1f12d3f5-2ebd-44ac-815e-6b584d3c2531</item>
                        <item name="Name" type_name="gh_string" type_code="10">Colour</item>
                        <item name="NickName" type_name="gh_string" type_code="10">C</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="2">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2979</X>
                              <Y>1275</Y>
                              <W>14</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2987.5</X>
                              <Y>1285</Y>
                            </item>
                          </items>
                        </chunk>
                        <chunk name="PersistentData">
                          <items count="1">
                            <item name="Count" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Branch" index="0">
                              <items count="2">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Item" index="0">
                                  <items count="1">
                                    <item name="color" type_name="gh_drawing_color" type_code="36">
                                      <ARGB>255;0;0;0</ARGB>
                                    </item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_input" index="4">
                      <items count="6">
                        <item name="Description" type_name="gh_string" type_code="10">Text justification</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">fa260630-cbaa-434e-9865-954279c48e8b</item>
                        <item name="Name" type_name="gh_string" type_code="10">Justification</item>
                        <item name="NickName" type_name="gh_string" type_code="10">J</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="2">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2979</X>
                              <Y>1295</Y>
                              <W>14</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2987.5</X>
                              <Y>1305</Y>
                            </item>
                          </items>
                        </chunk>
                        <chunk name="PersistentData">
                          <items count="1">
                            <item name="Count" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Branch" index="0">
                              <items count="2">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Item" index="0">
                                  <items count="1">
                                    <item name="number" type_name="gh_int32" type_code="3">7</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="12">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">Python Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="14">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Defines a new topological diagram from inputs
    Inputs:
        T: (trailObjects) Trail members in the topological diagram 
        L: (pointLoadObjects) Point Loads in the topological diagram 
        D: (deviationObjects) Deviation members in the topological diagram 
        S: (supportObjects) Supports in the topological diagram
    Outputs:
        TP: (topological diagram) The constructed topological diagram (empty topology on error)
    Remarks:
        This generates a new instance of the topological diagram
"""

__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""



import System.Drawing.Color
import System.Guid
import Rhino
import rhinoscriptsyntax as rs
db0_T = 0.000001

class topology(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        if trailMembers and trailMembersID:
            if len(trailMembers) == len(trailMembersID):
                str0_Description = ""
                if hasattr(self, "db1_StructuralBehaviourOut"):
                    str0_Description += "Topological Diagram"
                    return str0_Description
                else:
                    return "Empty topology"
            else:
                return "Empty topology"
        else:
            return "Empty topology"


def ListListToList(xx2_Data):
    xx1_DataOut = []
    for xx1_Data in xx2_Data:
        xx1_DataOut.extend(xx1_Data)
    return xx1_DataOut


TP = topology()


externalForces = []
externalForcesID = []
if L:
    for l in L:
        if l:
            externalForces.extend(l.geom)
            externalForcesID.extend(l.magn)

trailMembers = []
trailMembersID = []
if T:
    for t in T:
        if t:
            trailMembers.extend(t.geom)
            trailMembersID.extend(t.len)


deviationMembers = []
deviationMembersID = []
if D:
    for d in D:
        if d:
            deviationMembers.extend(d.geom)
            deviationMembersID.extend(d.magn)

supports = []
if S:
    for s in S:
        if s:
            supports.extend(s.geom)



if trailMembers and trailMembersID or deviationMembers and deviationMembersID:
    if len(trailMembers) == len(trailMembersID) and len(deviationMembers) == len(deviationMembersID) and len(externalForces) == len(externalForcesID):

        # Create List of Nodes and trailMembers' Connectivity
        pt1_Node = []
        pt1_NodeRes = []
        int2_Trail = []
        int2_Deviation = []
        int2_ExtForce = []
        
        if trailMembers and trailMembersID:
            pt1_Node.append(trailMembers[0].PointAtStart)


        # Create support trails if support is detached from any trail
        int1_numoftrails = (len(trailMembers))
        for i in range(len(supports)):
            if int1_numoftrails &gt;= 1:
                for j in range(len(trailMembers)):
                    bl0_Check = False
                    pt0_Start = trailMembers[j].PointAtStart
                    pt0_End = trailMembers[j].PointAtEnd
                    if (abs(pt0_Start.X - supports[i].X) &lt; db0_T and abs(pt0_Start.Y - supports[i].Y) &lt; db0_T and abs(pt0_Start.Z - supports[i].Z) &lt; db0_T) or (abs(pt0_End.X - supports[i].X) &lt; db0_T and abs(pt0_End.Y - supports[i].Y) &lt; db0_T and abs(pt0_End.Z - supports[i].Z) &lt; db0_T):
                        bl0_Check = True
                        break
                if bl0_Check == False:
                    ln0_TrailAux = Rhino.Geometry.Line(supports[i],Rhino.Geometry.Vector3d(0,0,10*db0_T))
                    crv0_TrailAux = Rhino.Geometry.LineCurve(ln0_TrailAux)
                    trailMembers.append(crv0_TrailAux)
                    trailMembersID.append(1.0)
            else:
                ln0_TrailAux = Rhino.Geometry.Line(supports[i],Rhino.Geometry.Vector3d(0,0,10*db0_T))
                crv0_TrailAux = Rhino.Geometry.LineCurve(ln0_TrailAux)
                trailMembers.append(crv0_TrailAux)
                trailMembersID.append(1.0)


        
        # Nodes and Egdes from trailMembers
        for crv0_Trail in trailMembers:
            int1_Trail = []
            pt0_Start = crv0_Trail.PointAtStart
            bl0_Check = False
            for i in range(len(pt1_Node)):
                if abs(pt0_Start.X - pt1_Node[i].X) &lt; db0_T and abs(pt0_Start.Y - pt1_Node[i].Y) &lt; db0_T and abs(pt0_Start.Z - pt1_Node[i].Z) &lt; db0_T:
                    int1_Trail.append(i)
                    bl0_Check = True
                    break
            if bl0_Check == False:
                pt1_Node.append(pt0_Start)
                int1_Trail.append(len(pt1_Node)-1)
            pt0_End = crv0_Trail.PointAtEnd
            bl0_Check = False
            for i in range(len(pt1_Node)):
                if abs(pt0_End.X - pt1_Node[i].X) &lt; db0_T and abs(pt0_End.Y - pt1_Node[i].Y) &lt; db0_T and abs(pt0_End.Z - pt1_Node[i].Z) &lt; db0_T:
                    int1_Trail.append(i)
                    bl0_Check = True
                    break
            if bl0_Check == False:
                pt1_Node.append(pt0_End)
                int1_Trail.append(len(pt1_Node)-1)
            int2_Trail.append(int1_Trail)
        
        # Nodes and Egdes from deviatioMembers
        for crv0_Deviation in deviationMembers:
            int1_Deviation = []
            
            pt0_Start = crv0_Deviation.PointAtStart
            bl0_Check = False
            bl0_CheckRes = False
            for i in range(len(pt1_Node)):
                if abs(pt0_Start.X - pt1_Node[i].X) &lt; db0_T and abs(pt0_Start.Y - pt1_Node[i].Y) &lt; db0_T and abs(pt0_Start.Z - pt1_Node[i].Z) &lt; db0_T:
                    int1_Deviation.append(i)
                    bl0_Check = True
                    break
            for i in range(len(pt1_NodeRes)):
                if abs(pt0_Start.X - pt1_NodeRes[i].X) &lt; db0_T and abs(pt0_Start.Y - pt1_NodeRes[i].Y) &lt; db0_T and abs(pt0_Start.Z - pt1_NodeRes[i].Z) &lt; db0_T:
                    int1_Deviation.append(i+len(pt1_Node))
                    bl0_CheckRes = True
                    break
            if bl0_Check == False and bl0_CheckRes == False:
                pt1_NodeRes.append(pt0_Start)
                int1_Deviation.append(len(pt1_Node) + len(pt1_NodeRes)-1)
            points_a = pt1_NodeRes
            pt0_End = crv0_Deviation.PointAtEnd
            bl0_Check = False
            bl0_CheckRes = False
            for i in range(len(pt1_Node)):
                if abs(pt0_End.X - pt1_Node[i].X) &lt; db0_T and abs(pt0_End.Y - pt1_Node[i].Y) &lt; db0_T and abs(pt0_End.Z - pt1_Node[i].Z) &lt; db0_T:
                    int1_Deviation.append(i)
                    bl0_Check = True
                    break
            for i in range(len(pt1_NodeRes)):
                if abs(pt0_End.X - pt1_NodeRes[i].X) &lt; db0_T and abs(pt0_End.Y - pt1_NodeRes[i].Y) &lt; db0_T and abs(pt0_End.Z - pt1_NodeRes[i].Z) &lt; db0_T:
                    int1_Deviation.append(i+len(pt1_Node))
                    bl0_CheckRes = True
                    break
            if bl0_Check == False and bl0_CheckRes == False:
                pt1_NodeRes.append(pt0_End)
                int1_Deviation.append(len(pt1_Node)+len(pt1_NodeRes)-1)
            int2_Deviation.append(int1_Deviation)

        # Add Residual Forces from Auxiliary Trails
        crv1_TrailAux = []
        for i in range(len(pt1_NodeRes)):
            ln0_TrailAux = Rhino.Geometry.Line(pt1_NodeRes[i],Rhino.Geometry.Vector3d(0,0,1))
            crv0_TrailAux = Rhino.Geometry.LineCurve(ln0_TrailAux)
            crv1_TrailAux.append(crv0_TrailAux)
            trailMembers.append(crv0_TrailAux)
            trailMembersID.append(0.0)
            

        # Extend  list of nodes
        pt1_Node.extend(pt1_NodeRes)
        
        # Nodes and Egdes from trailMembers
        pt1_NodeResEnd = []
        for crv0_Trail in crv1_TrailAux:
            int1_Trail = []
            pt0_Start = crv0_Trail.PointAtStart
            pt0_End = crv0_Trail.PointAtEnd
            bl0_Check = False
            for i in range(len(pt1_Node)):
                if abs(pt0_Start.X - pt1_Node[i].X) &lt; db0_T and abs(pt0_Start.Y - pt1_Node[i].Y) &lt; db0_T and abs(pt0_Start.Z - pt1_Node[i].Z) &lt; db0_T:
                    int1_Trail.append(i)
                    int1_Trail.append(i+len(pt1_NodeRes))
                    pt1_NodeResEnd.append(pt0_End)
                    bl0_Check = True
                    break
            int2_Trail.append(int1_Trail)
        pt1_Node.extend(pt1_NodeResEnd)
        
        # Deviation
        crv1_DeviationClean = []
        id1_DeviationClean = []
        for k in range(len(deviationMembers)):
            pt0_StartDeviation = deviationMembers[k].PointAtStart
            pt0_EndDeviation = deviationMembers[k].PointAtEnd
            for i in range(len(pt1_Node)):
                if abs(pt0_StartDeviation.X - pt1_Node[i].X) &lt; db0_T and abs(pt0_StartDeviation.Y - pt1_Node[i].Y) &lt; db0_T and abs(pt0_StartDeviation.Z - pt1_Node[i].Z) &lt; db0_T:
                    for j in range(len(pt1_Node)):
                        if abs(pt0_EndDeviation.X - pt1_Node[j].X) &lt; db0_T and abs(pt0_EndDeviation.Y - pt1_Node[j].Y) &lt; db0_T and abs(pt0_EndDeviation.Z - pt1_Node[j].Z) &lt; db0_T:
                            crv1_DeviationClean.append(deviationMembers[k])
                            id1_DeviationClean.append(deviationMembersID[k])
                            int1_Deviation = []
                            int1_Deviation.append(i)
                            int1_Deviation.append(j)
                            int2_Deviation.append(int1_Deviation)
                            break
                    break
        deviationMembers = crv1_DeviationClean
        deviationMembersID = id1_DeviationClean
        
        # External Force
        pt1_ExtForceClean = []
        External_Forces_IDClean = []
        for k in range(len(externalForces)):
            for i in range(len(pt1_Node)):
                if abs(externalForces[k].X - pt1_Node[i].X) &lt; db0_T and abs(externalForces[k].Y - pt1_Node[i].Y) &lt; db0_T and abs(externalForces[k].Z - pt1_Node[i].Z) &lt; db0_T:
                    pt1_ExtForceClean.append(externalForces[k])
                    External_Forces_IDClean.append(externalForcesID[k])
                    int2_ExtForce.append(i)
                    break
        
        externalForces = pt1_ExtForceClean
        externalForcesID = External_Forces_IDClean

        
        # Extract Attributes External Forces
        st2_externalForcesID = []
        for i in range(len(externalForcesID)):
            st1_externalForcesID = []
            for j in range(len(externalForcesID[i])):
                st1_externalForcesID.append(str(externalForcesID[i][j]))
            st2_externalForcesID.append(st1_externalForcesID)
        str2_ExtForceAtt = st2_externalForcesID

        # Extract Attributes trailMembers
        str1_TrailAtt = [str(x) for x in trailMembersID]

        # Extract Attributes Deviation
        str1_DeviationAtt = [str(x) for x in deviationMembersID]
        
        
        # Create Dictionary of trailMembers' Ends
        dc2_TrailEnds = {}
        for i in range(len(int2_Trail)):
            dc2_TrailEnds[str(i)] = [str(x) for x in int2_Trail[i]]
        
        # Create Dictionary of trailMembers' Attributes
        dc1_TrailAtt = {}
        for i in range(len(str1_TrailAtt)):
            dc1_TrailAtt[str(i)] = str1_TrailAtt[i]
                
        # Create Dictionary of External Forces' End
        dc1_ExtForceEnds = {}
        for i in range(len(int2_ExtForce)):
            dc1_ExtForceEnds[str(i)] = str(int2_ExtForce[i])
        
        # Create Dictionary of External Forces' Attributes
        dc2_ExtForceAtt = {}
        for i in range(len(str2_ExtForceAtt)):
            dc2_ExtForceAtt[str(i)] = [float(x) for x in str2_ExtForceAtt[i]]

        # Create Dictionary of External Forces' Attributes and Labels
        dc2_ExtForce = dc2_ExtForceAtt.copy()
        for key in dc2_ExtForce:
            dc2_ExtForce[key].append(dc1_ExtForceEnds[key])

        
        # Create Lists of Node-Node Connectivity from trailMembers
        int2_Node = []
        for pt0_Node in pt1_Node:
            int1_Node = []
            int2_Node.append(int1_Node)
        for int1_Trail in int2_Trail:
            int2_Node[int1_Trail[0]].append(int1_Trail[1])
            int2_Node[int1_Trail[1]].append(int1_Trail[0])
        
        
        # Create Lists of Deviations' Ends and Attributes
        str2_Deviation = []
        for i in range(len(str1_DeviationAtt)):
            str2_Deviation.append( [str(item) for item in int2_Deviation[i] ] )
            str2_Deviation[i].extend([str1_DeviationAtt[i]])
        
        # Convert Trail Input into Polylines
        ln1_Trail = []
        for crv0_Trail in trailMembers:
            if crv0_Trail is Rhino.Geometry.Line:
                ln1_Trail.append(crv0_Trail)
            else:
                ln1_Trail.append(Rhino.Geometry.Line(crv0_Trail.PointAtStart, crv0_Trail.PointAtEnd))
        
        trailMembers = []
        for ln0_Trail in ln1_Trail:
            trailMembers.append(ln0_Trail.ToNurbsCurve())
        
        plc1_Trail = Rhino.Geometry.Curve.JoinCurves(trailMembers)
        
        pln1_Trail = []
        for plc0_Trail in plc1_Trail:
            pln1_Trail.append(plc0_Trail.TryGetPolyline()[1])
        
        
        # Check supports
        pt1_SupportClean = []
        for j in range(len(pln1_Trail)):
            if supports:
                pt1_SupportClean.append(pln1_Trail[j][len(pln1_Trail[j])-1])
                for i in range(len(supports)):
                    if abs(pln1_Trail[j][0].X - supports[i].X) &lt; db0_T and abs(pln1_Trail[j][0].Y - supports[i].Y) &lt; db0_T and abs(pln1_Trail[j][0].Z - supports[i].Z) &lt; db0_T:
                        pt1_SupportClean[j] = pln1_Trail[j][0]
                        pln1_Trail[j].Reverse()
            else:
                pt1_SupportClean.append(pln1_Trail[j][len(pln1_Trail[j])-1])
        supports = pt1_SupportClean
        
        
        # Find Node Indexes of supports
        int1_Support = []
        for pt0_Support in supports:
            for i in range(len(pt1_Node)):
                if abs(pt0_Support.X - pt1_Node[i].X) &lt; db0_T and abs(pt0_Support.Y - pt1_Node[i].Y) &lt; db0_T and abs(pt0_Support.Z - pt1_Node[i].Z) &lt; db0_T:
                    int1_Support.append(i)
                    break
        
        # Create Graph (Dictionary of Node-Node Connectivity from trailMembers)
        dc2_Node = {}
        for i in range(len(int2_Node)):
            dc2_Node[str(i)] = [str(x) for x in int2_Node[i]]
        
        int2_TrailPoly = []
        for pln0_Trail in pln1_Trail:
            int1_TrailPoly = []
            for i in range(len(pln0_Trail)):
                for k in range(len(pt1_Node)):
                    if abs(pln0_Trail[i].X - pt1_Node[k].X) &lt; db0_T and abs(pln0_Trail[i].Y - pt1_Node[k].Y) &lt; db0_T and abs(pln0_Trail[i].Z - pt1_Node[k].Z) &lt; db0_T:
                        int1_TrailPoly.append(k)
                        break
            int2_TrailPoly.append(list(reversed(int1_TrailPoly)))
        
        dc2_ShortPath = {}

        for i in range(len(pt1_Node)):
            for int1_TrailPoly in int2_TrailPoly:
                if i in int1_TrailPoly:
                    str1_ShortPath = ["S"]
                    str1_ShortPath.extend(map(str, int1_TrailPoly[:int1_TrailPoly.index(i)+1]))
                    dc2_ShortPath[str(i)] = str1_ShortPath
                    break
        
        dc1_ShortPathDist = {}
        dc2_ShortPathDistGrade = {}
        
        for i in range(len(pt1_Node)):
            for pln0_Trail in pln1_Trail:
                for j in range(len(pln0_Trail)):
                    if abs(pln0_Trail[j].X - pt1_Node[i].X) &lt; db0_T and abs(pln0_Trail[j].Y - pt1_Node[i].Y) &lt; db0_T and abs(pln0_Trail[j].Z - pt1_Node[i].Z) &lt; db0_T:
                        dc1_ShortPathDist[str(i)] = len(pln0_Trail) - j
                        break
        

        # Define Sequences
        for key in dc1_ShortPathDist:
            if dc1_ShortPathDist[key] not in dc2_ShortPathDistGrade:
                dc2_ShortPathDistGrade[dc1_ShortPathDist[key]] = [key]
            else:
                dc2_ShortPathDistGrade[dc1_ShortPathDist[key]].extend([key])
        
        
        # Separate Deviation1 (direct) and Deviation2 (indirect-bracing)
        
        dc2_Deviation1Ends = {}
        dc2_Deviation2Ends = {}
        
        dc1_Deviation1Att = {}
        dc1_Deviation2Att = {}
        
        int2_Deviation1 = []
        str2_Deviation2 = []
        
        crv1_Deviation1 = []
        crv1_Deviation2 = []
        
        int1_Deviation1ID = []
        int1_Deviation2ID = []
        
        j = 0
        k = 0
        
        
        for i in range(len(str2_Deviation)):
            if dc1_ShortPathDist[ str(str2_Deviation[i][0]) ] == dc1_ShortPathDist[ str(str2_Deviation[i][1]) ]:
                dc2_Deviation1Ends[str(j)] = [str(str2_Deviation[i][0]),str(str2_Deviation[i][1])]
                dc1_Deviation1Att[str(j)] = str(str2_Deviation[i][2])
                int2_Deviation1.append([int(str2_Deviation[i][0]),int(str2_Deviation[i][1])])
                crv1_Deviation1.append(deviationMembers[i])
                int1_Deviation1ID.append(i)
                j += 1
            else:
                dc2_Deviation2Ends[str(k)] = [str(str2_Deviation[i][0]),str(str2_Deviation[i][1])]
                dc1_Deviation2Att[str(k)] = str(str2_Deviation[i][2])
                str2_Deviation2.append(str2_Deviation[i])
                crv1_Deviation2.append(deviationMembers[i])
                int1_Deviation2ID.append(i)
                k += 1

        
        # Create Dictionary of Trail and Deviation 1 for Structural Matrix
        dc2_EdgeEnds = {}
        dc2_TrailEndsOut = dc2_TrailEnds.copy()
        dc2_Deviation1EndsOut = {}
        
        for key in dc2_TrailEnds:
            dc2_EdgeEnds[str(int(key))] = dc2_TrailEnds[key]
        for key in dc2_Deviation1Ends:
            dc2_EdgeEnds[str(int(key)+len(dc2_TrailEnds))] = dc2_Deviation1Ends[key]
            dc2_Deviation1EndsOut[str(int(key)+len(dc2_TrailEnds))] = dc2_Deviation1Ends[key]
            
        dc1_EdgeAtt = {}
        for key in dc1_TrailAtt:
            dc1_EdgeAtt[str(int(key))] = dc1_TrailAtt[key]
        for key in dc1_Deviation1Att:
            dc1_EdgeAtt[str(int(key)+len(dc1_TrailAtt))] = dc1_Deviation1Att[key]
        
        # Create Dictionary of Trail and Deviation 1 and 2 for Visualization
        dc1_Edge = {}
        for key in dc1_TrailAtt:
            dc1_Edge[str(int(key))] = dc1_TrailAtt[key]
        for key in dc1_Deviation1Att:
            dc1_Edge[str(int(key)+len(dc1_TrailAtt))] = dc1_Deviation1Att[key]
        for key in dc1_Deviation2Att:
            dc1_Edge[str(int(key)+len(dc1_TrailAtt)+len(dc1_Deviation1Att))] = dc1_Deviation2Att[key]
        

        # Update Lists of Node-Node Connectivity from Deviation 1
        for int1_DevTemp in int2_Deviation1:
            int2_Node[int1_DevTemp[0]].append(int1_DevTemp[1])
            int2_Node[int1_DevTemp[1]].append(int1_DevTemp[0])
        
        
        # Create Graph (Dictionary of Node-Node Connectivity from trailMembers)
        for i in range(len(int2_Node)):
            dc2_Node[str(i)] = [str(x) for x in int2_Node[i]]
        
        
        ## Create Dictionaries for Structural Matrix
        dc1_NodeTrailOut = {}
        dc1_NodeTrailIn = {}
        dc2_NodeDeviation = {}
        dc1_NodeExtForce = {}
        dc1_NodeExtForceAtt = {}
        int0_NodeTrailIn = {}

        
        # Trail In and Out
        for key in dc2_ShortPath:
            dc1_NodeTrailOut[key] = dc2_ShortPath[key][len(dc2_ShortPath[key])-2]
        
        int0_ShortPathDistGradeMax = max(dc2_ShortPathDistGrade)
        
        for key in dc1_NodeTrailOut:
            if dc1_NodeTrailOut[key] == "S": dc1_NodeTrailOut[key] = dc1_NodeTrailOut[key] + key
            dc1_NodeTrailIn[dc1_NodeTrailOut[key]] = key

        for key in dc1_NodeTrailOut:
            if key not in dc1_NodeTrailIn:
                str0_Key = "W" + key
                for i in range(int0_ShortPathDistGradeMax - dc1_ShortPathDist[key] + 1):
                    dc1_NodeTrailIn[str0_Key[1:]] = str0_Key
                    str0_Key = "L" + str0_Key

        
        for key in dc1_NodeTrailIn:
            if "L" + key not in dc1_NodeTrailOut:
                dc1_NodeTrailOut[dc1_NodeTrailIn[key]] = key
        
        # Deviation
        for key in dc2_Node:
            str1_v = []
            for v in dc2_Node[key]:
                if v != dc1_NodeTrailOut[key] and v != dc1_NodeTrailIn[key]:
                    str1_v.append(v)
            dc2_NodeDeviation[key] = str1_v
        
        # External Forces
        for key in dc1_ExtForceEnds:
            if dc1_ExtForceEnds[key] not in dc1_NodeExtForce:
                dc1_NodeExtForce[dc1_ExtForceEnds[key]] = [key]
            else:
                dc1_NodeExtForce[dc1_ExtForceEnds[key]].append(key)

        for key in dc1_NodeExtForce:
            for v in dc1_NodeExtForce[key]:
                if dc1_ExtForceEnds[v] not in dc1_NodeExtForceAtt:
                    dc1_NodeExtForceAtt[key] = [dc2_ExtForceAtt[v]]
                else:
                    dc1_NodeExtForceAtt[key].append(dc2_ExtForceAtt[v])

        
        ## Create Structural Matrix According to Weight
        
        # Initialize Matrix with Indices
        str2_StructuralMatrix = []
        str1_NodeOrderMatrix = []
        str2_NodeOrderMatrix = []
        
        str1_NodeOrder = dc2_ShortPathDistGrade[1]

        for i in sorted(range(1,len(dc2_ShortPathDistGrade)+1)):
            str1_NodeOrderUp = []
            str2_NodeOrderMatrix.append(str1_NodeOrder)
            for str0_NodeOrder in str1_NodeOrder:
                str1_NodeOrderMatrix.append(str0_NodeOrder)
                if str0_NodeOrder[0] != "W":
                    str2_StructuralMatrix.append(["0"]*(3+len(str1_NodeOrder)+1))
                    str1_NodeOrderUp.append(dc1_NodeTrailIn[str0_NodeOrder])
                    
                else:
                    str2_StructuralMatrix.append(["0"]*(3+len(str1_NodeOrder)+1))
                    str1_NodeOrderUp.append("W" + str0_NodeOrder)
                    dc1_NodeTrailIn[str0_NodeOrder] = str0_NodeOrder[1:]
                    dc2_EdgeEnds[str0_NodeOrder.replace("W","E")] = [str0_NodeOrder[1:], str0_NodeOrder]
                    dc2_TrailEndsOut[str0_NodeOrder.replace("W","E")] = [str0_NodeOrder[1:], str0_NodeOrder]
            str1_NodeOrder = str1_NodeOrderUp
            
        int0_NodeOrderMatrix = len(str2_NodeOrderMatrix[0])
        
        # Add Attributes Auxiliary Trails
        for key in dc2_EdgeEnds: 
            if key[0] == "E": dc1_EdgeAtt[key] = "0.0"
        
        # Add Attribute Trail Out
        for key in dc2_EdgeEnds:
            if dc2_EdgeEnds[key][0] in dc1_NodeTrailOut and dc2_EdgeEnds[key][1] == dc1_NodeTrailOut[dc2_EdgeEnds[key][0]]:
                int0_NodeIndex = str1_NodeOrderMatrix.index(dc2_EdgeEnds[key][0])
                str2_StructuralMatrix[int0_NodeIndex][len(str2_StructuralMatrix[int0_NodeIndex])-1] = dc1_EdgeAtt[key]
            elif dc2_EdgeEnds[key][1] in dc1_NodeTrailOut and dc2_EdgeEnds[key][0] == dc1_NodeTrailOut[dc2_EdgeEnds[key][1]]:
                int0_NodeIndex = str1_NodeOrderMatrix.index(dc2_EdgeEnds[key][1])
                str2_StructuralMatrix[int0_NodeIndex][len(str2_StructuralMatrix[int0_NodeIndex])-1] = dc1_EdgeAtt[key]
        
        # Add Attribute Deviation
        for key in dc2_EdgeEnds:
            if dc2_EdgeEnds[key][0] in dc2_NodeDeviation and dc2_EdgeEnds[key][1] in dc2_NodeDeviation[dc2_EdgeEnds[key][0]]:
                int0_NodeIndex = str1_NodeOrderMatrix.index(dc2_EdgeEnds[key][0])
                int0_NodeIndexTo = str1_NodeOrderMatrix.index(dc2_EdgeEnds[key][1])
                int0_NodeIndexRaw = (int0_NodeIndexTo) % int0_NodeOrderMatrix
                str2_StructuralMatrix[int0_NodeIndex][3 + int0_NodeIndexRaw] = dc1_EdgeAtt[key]
            if dc2_EdgeEnds[key][1] in dc2_NodeDeviation and dc2_EdgeEnds[key][0] in dc2_NodeDeviation[dc2_EdgeEnds[key][1]]:
                int0_NodeIndex = str1_NodeOrderMatrix.index(dc2_EdgeEnds[key][1])
                int0_NodeIndexTo = str1_NodeOrderMatrix.index(dc2_EdgeEnds[key][0])
                int0_NodeIndexRaw = (int0_NodeIndexTo) % int0_NodeOrderMatrix
                str2_StructuralMatrix[int0_NodeIndex][3 + int0_NodeIndexRaw] = dc1_EdgeAtt[key]
        
        # Order Matrix
        str2_StructuralMatrixOrder = []
        int1_StructuralMatrixOrder = []
        str2_NodeOrderMatrixReversed = []
        
        for i in reversed(range(1,len(str2_NodeOrderMatrix)+1)):
            for j in range(int0_NodeOrderMatrix):
                int0_Index = int0_NodeOrderMatrix*(i-1)+j
                if i != len(str2_NodeOrderMatrix):
                    int1_StructuralMatrixOrder.append(str2_NodeOrderMatrix[i-1][j])
                str2_StructuralMatrixOrder.append(str2_StructuralMatrix[int0_NodeOrderMatrix*(i-1)+j])
        
        for i in reversed(range(1,len(str2_NodeOrderMatrix)+1)):
            str1_NodeOrderMatrixReversed = []
            for j in range(int0_NodeOrderMatrix):
                str1_NodeOrderMatrixReversed.append(str2_NodeOrderMatrix[i-1][j])
            str2_NodeOrderMatrixReversed.append(str1_NodeOrderMatrixReversed)

        
        # Substitute Node Index with Matrix Index in Deviation2
        str1_Deviation2 = ListListToList(str2_Deviation2)
        str1_NodeOrder = ListListToList(str2_NodeOrderMatrixReversed)
        
        str1_NodeOrderOut = str1_NodeOrder[:]
        
        # Edge-Node List
        dc2_EdgeEndsComplete = {}
        dc2_EdgeEndsComplete = dict(dc2_EdgeEnds)
        dc2_Deviation2EndsOut = {}
        
        
        int0_EdgeEndsLen = len([k for k in dc2_EdgeEndsComplete if not k.startswith('E')])
        
        for i in range(0,len(str1_Deviation2),3):
            dc2_EdgeEndsComplete[str( int(int0_EdgeEndsLen+i/3) )] = [str1_Deviation2[i],str1_Deviation2[i+1]]
            dc2_Deviation2EndsOut[str( int(int0_EdgeEndsLen+i/3) )] = [str1_Deviation2[i],str1_Deviation2[i+1]]
                
        for i in range(len(str1_Deviation2)):
            if (i+1) % 3 != 0:
                str1_Deviation2[i] = str1_NodeOrder.index(str(str1_Deviation2[i]))

        
        ## Output
        str1_DeviationIndirectOut = str1_Deviation2
        str1_StructuralBehaviourOut = ListListToList(str2_StructuralMatrixOrder)


        ## Visualization
        
        # Nodes
        pt1_NodeOut = pt1_Node
        pt1_TargetOut = pt1_NodeOut
        str1_NodeOut = ["V" + str(i) + " (" + str(dc1_ShortPathDist[str(i)]) + ")" for i in range(len(pt1_Node))]
        str1_TargetOut = [str(i) for i in range(len(pt1_Node))]
        
        # Edges
        crv1_Edge = []
        crv1_Trail = []
        crv1_Deviation = []
        for crv0_Trail in trailMembers:
            crv1_Edge.append(crv0_Trail)
            crv1_Trail.append(crv0_Trail)
        for crv0_Deviation1 in crv1_Deviation1: 
            crv1_Edge.append(crv0_Deviation1)
            crv1_Deviation.append(crv0_Deviation1)
        for crv0_Deviation2 in crv1_Deviation2: 
            crv1_Edge.append(crv0_Deviation2)
            crv1_Deviation.append(crv0_Deviation2)
        
        crv1_EdgeOut = crv1_Edge
        crv1_TrailOut = crv1_Trail
        crv1_DeviationOut = crv1_Deviation
        
        pt1_EdgeOut = [crv0_Edge.PointAtNormalizedLength(0.6) for crv0_Edge in crv1_EdgeOut]
        pt1_TrailOut = [crv0_Trail.PointAtNormalizedLength(0.6) for crv0_Trail in crv1_TrailOut]
        pt1_DeviationOut = [crv0_Deviation.PointAtNormalizedLength(0.6) for crv0_Deviation in crv1_DeviationOut]
        
        str1_EdgeOut = [str(i) + " (" + dc1_Edge[str(i)] + ")" for i in range(len(crv1_EdgeOut))]
        str1_TrailOut = ["T" + str(i) for i in range(len(crv1_TrailOut))]
        str1_DeviationOut = ["D" + str(i) for i in range(len(str1_TrailOut), len(str1_TrailOut) + len(crv1_DeviationOut))]

        # External Forces
        pt1_ForceOut = []
        str1_ForceOut = []
        
        for key in dc1_NodeExtForce:
            pt0_ForceOut = pt1_Node[int(key)]
            str0_ForceOut = "L" + dc1_NodeExtForce[key][0]
            for j in range(1,len(dc1_NodeExtForce[key])):
                str0_ForceOut += "-" + "L" + dc1_NodeExtForce[key][j]
            pt1_ForceOut.append(pt0_ForceOut)
            str1_ForceOut.append(str0_ForceOut)

        
        
        #### AUTOMATIC GEOMETRIC INPUT FOR FORM DIAGRAM
        
        
        # Amount of layers
        N_layers = len(str1_NodeOrder)/len(supports)
        
        # Create List of Origin Nodes with Indexes
        str1_OriginNodeOut = ["V" + str0_OriginNodeOut.replace("W","") for str0_OriginNodeOut in str1_NodeOrder[:len(supports)]]
        pt1_OriginNodeOut = []
        for str0_OriginNodeOut in str1_OriginNodeOut:
            pt1_OriginNodeOut.append(pt1_Node[int(str0_OriginNodeOut[1:])])

        str1_ConstraintPlane = []
        pl1_ConstraintPlane = []

        for key in dc2_TrailEnds:
            
            str0_0 = dc2_TrailEnds[key][0]
            str0_1 = dc2_TrailEnds[key][1]
            int0_0 = dc1_ShortPathDist[str0_0]
            int0_1 = dc1_ShortPathDist[str0_1]
            
            str1_ConstraintPlane.append(str0_0)
            pt0_Start = pt1_NodeOut[int(str0_0)]
            pt0_End = pt1_NodeOut[int(str0_1)]
            
            if int0_0 &gt; int0_1:
                str1_ConstraintPlane[len(str1_ConstraintPlane)-1] = str0_1
                pt0_Start = pt1_NodeOut[int(str0_1)]
                pt0_End = pt1_NodeOut[int(str0_0)]
                
            vc0_Normal = Rhino.Geometry.Vector3d(pt0_End-pt0_Start)
            pl0_Plane = Rhino.Geometry.Plane(pt0_Start,vc0_Normal)
            pl1_ConstraintPlane.append(pl0_Plane)
            

        str1_ConstraintPlaneOut = str1_ConstraintPlane
        pl1_ConstraintPlaneOut = pl1_ConstraintPlane

        TP.str1_StructuralBehaviourOut = str1_StructuralBehaviourOut
        TP.str1_DeviationIndirectOut = str1_DeviationIndirectOut
        TP.pt1_NodeOut = pt1_NodeOut
        TP.str1_NodeOut = str1_NodeOut
        TP.crv1_EdgeOut = crv1_EdgeOut
        TP.pt1_EdgeOut = pt1_EdgeOut
        TP.str1_EdgeOut = str1_EdgeOut
        TP.pt1_TrailOut = pt1_TrailOut
        TP.str1_TrailOut = str1_TrailOut
        TP.pt1_DeviationOut = pt1_DeviationOut
        TP.str1_DeviationOut = str1_DeviationOut
        TP.dc2_EdgeEndsCompleteOut = dc2_EdgeEndsComplete
        TP.dc2_TrailEndsOut = dc2_TrailEndsOut
        TP.dc2_Deviation1EndsOut = dc2_Deviation1EndsOut
        TP.dc2_Deviation2EndsOut = dc2_Deviation2EndsOut
        TP.int1_Deviation1ID = int1_Deviation1ID
        TP.int1_Deviation2ID = int1_Deviation2ID
        TP.dc2_ForceOut = dc2_ExtForce
        TP.pt1_ForceOut = pt1_ForceOut 
        TP.str1_ForceOut = str1_ForceOut
        TP.str1_NodeOrderOut = str1_NodeOrderOut
        TP.str1_ConstraintPlaneOut = str1_ConstraintPlaneOut
        TP.pl1_ConstraintPlaneOut = pl1_ConstraintPlaneOut
        TP.str1_OriginNodeOut = str1_OriginNodeOut
        TP.pt1_OriginNodeOut = pt1_OriginNodeOut
        TP.crv1_TrailAux = crv1_TrailAux

def StringToFloat(val):
    try:
        return float(val)
    except (ValueError, TypeError):
        return 1.0

if TP and hasattr(TP, "str1_StructuralBehaviourOut"):
    str1_StructuralBehaviour = TP.str1_StructuralBehaviourOut[:]
    str1_DeviationIndirect = TP.str1_DeviationIndirectOut[:]
    db1_StructuralBehaviour = []
    db1_DeviationIndirect = []
        
    for i in range(len(str1_StructuralBehaviour)):
        db1_StructuralBehaviour.append(StringToFloat(str1_StructuralBehaviour[i]))
    
    for i in range(len(str1_DeviationIndirect)):
        db1_DeviationIndirect.append(StringToFloat(str1_DeviationIndirect[i]))

    del TP.str1_StructuralBehaviourOut
    del TP.str1_DeviationIndirectOut
    
    TP.db1_StructuralBehaviourOut = db1_StructuralBehaviour
    TP.db1_DeviationIndirectOut = db1_DeviationIndirect</item>
                    <item name="Description" type_name="gh_string" type_code="10">Defines a new topological diagram from inputs</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>2034</X>
                      <Y>108</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1492</W>
                      <H>992</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">false</item>
                    <item name="IconDisplay" type_name="gh_int32" type_code="3">1</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">d54af319-7fdb-4aeb-9a94-1f2c9c5cb649</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">Python Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Build_Topology_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>560</X>
                          <Y>566</Y>
                          <W>75</W>
                          <H>175</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>592</X>
                          <Y>654</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="8">
                        <item name="InputCount" type_name="gh_int32" type_code="3">4</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="2" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="3" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">2</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">3ede854e-c753-40eb-84cb-b48008f14fd4</item>
                        <item name="OutputId" index="1" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="6">
                        <chunk name="InputParam" index="0">
                          <items count="12">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(trailObjects) Trail members in the topological diagram </item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">89482e27-1019-453d-bd4b-33934e815ca7</item>
                            <item name="Name" type_name="gh_string" type_code="10">T</item>
                            <item name="NickName" type_name="gh_string" type_code="10">T</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">07a525d6-dedc-4ab1-8200-45627ee63768</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>562</X>
                                  <Y>568</Y>
                                  <W>15</W>
                                  <H>42</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>571</X>
                                  <Y>589.375</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="12">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(pointLoadObjects) Point Loads in the topological diagram </item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">3eb85cc1-ce80-4f50-ba54-dde57a962701</item>
                            <item name="Name" type_name="gh_string" type_code="10">L</item>
                            <item name="NickName" type_name="gh_string" type_code="10">L</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">575cd6b9-7cde-4316-8096-41cebaa4f14e</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>562</X>
                                  <Y>610</Y>
                                  <W>15</W>
                                  <H>43</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>571</X>
                                  <Y>632.125</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="2">
                          <items count="12">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(deviationObjects) Deviation members in the topological diagram </item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">21130220-32a6-4a4f-9f43-2090cd00ff6e</item>
                            <item name="Name" type_name="gh_string" type_code="10">D</item>
                            <item name="NickName" type_name="gh_string" type_code="10">D</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">5b0f0d53-8226-4037-ab21-e051867b2cf5</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>562</X>
                                  <Y>653</Y>
                                  <W>15</W>
                                  <H>43</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>571</X>
                                  <Y>674.875</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="3">
                          <items count="12">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(supportObjects) Supports in the topological diagram</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">7dea737a-9af2-4916-90d4-7842892a40d6</item>
                            <item name="Name" type_name="gh_string" type_code="10">S</item>
                            <item name="NickName" type_name="gh_string" type_code="10">S</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">7b84febe-62cc-4200-b79e-7b0fbe8d2f22</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>562</X>
                                  <Y>696</Y>
                                  <W>15</W>
                                  <H>43</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>571</X>
                                  <Y>717.625</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">The execution information, as output and error streams</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">0a309b6e-af0d-48d0-8983-632e1f2a5a34</item>
                            <item name="Name" type_name="gh_string" type_code="10">out</item>
                            <item name="NickName" type_name="gh_string" type_code="10">out</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>607</X>
                                  <Y>568</Y>
                                  <W>26</W>
                                  <H>85</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>620</X>
                                  <Y>610.75</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="1">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(topological diagram) The constructed topological diagram (empty topology on error)</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">f424fef5-cffe-4250-ac8f-9c19d0df4fc1</item>
                            <item name="Name" type_name="gh_string" type_code="10">TP</item>
                            <item name="NickName" type_name="gh_string" type_code="10">TP</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>607</X>
                                  <Y>653</Y>
                                  <W>26</W>
                                  <H>86</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>620</X>
                                  <Y>696.25</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="13">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">Python Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Retrieves automatically the data in the structural model
    Inputs:
        M: (structural model) The calculated structural model (empty on error)
    Outputs:
        nodes: (point3D) The nodes of the structural model
        nodesID: (string) The IDs of the nodes
        trails: (line) The trail edges of the structural model
        trailsID: (string) The IDs of the trail edges
        trailsCol: (color) The colors of the trail edges
        trailsMag: (double) The magnitudes of the forces in the trail edges
        deviationDirect: (line) The direct deviation edges of the structural model
        deviationsDirectID: (string) The IDs of the direct deviation edges
        deviationDirectCol: (color) The colors of the direct deviation edges
        deviationDirectMag: (double) The magnitudes of the forces in the direct deviation edges
        deviationIndirect: (line) The indirect deviation edges of the structural model
        deviationsIndirectID: (string) The IDs of the indirect deviation edges
        deviationIndirectCol: (color) The colors of the indirect deviation edges
        deviationIndirectMag: (double) The magnitudes of the forces in the indirect deviation edges
        externalForces: (line) The external forces of the structural model
        externalForcesCol: (color) The colors of the external forces 
        externalForcesMag: (double) The magnitudes of the forces in the external forces 
    Remarks:
        This extract the data within the structural diagram
"""


__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""


if M and hasattr(M, "pt1_GlobNodeOut") and hasattr(M, "str1_NodeOrderOut") and hasattr(M, "ln1_GlobTrailEdgeOut") and hasattr(M, "cl1_GlobTrailEdgeOut") and hasattr(M, "db1_GlobTrailEdgeOut") and hasattr(M, "ln1_GlobDeviation1EdgeOut") and hasattr(M, "cl1_GlobDeviation1EdgeOut") and hasattr(M, "db1_GlobDeviation1EdgeOut") and hasattr(M, "ln1_GlobDeviation2EdgeOut") and hasattr(M, "cl1_GlobDeviation2EdgeOut") and hasattr(M, "db1_GlobDeviation2EdgeOut") and hasattr(M, "ln1_GlobExtFOEdgeOut") and hasattr(M, "cl1_GlobExtFOEdgeOut") and hasattr(M, "db1_GlobExtFOEdgeOut") and hasattr(M, "str1_SupportAux"):

    nodes_C = []
    nodesID_C = []
    for i in range(len(M.pt1_GlobNodeOut)):
        if M.str1_NodeOrderOut[i][0] != "L" and M.str1_NodeOrderOut[i][0] != "W" and M.str1_NodeOrderOut[i] not in M.str1_SupportAux:
            nodes_C.append(M.pt1_GlobNodeOut[i])
            nodesID_C.append("V" + M.str1_NodeOrderOut[i])
        nodes = nodes_C
        nodesID = nodesID_C

    trails_C = []
    trailsID_C = []
    trailsCol_C = []
    trailsMag_C = []
    for i in range(len(M.ln1_GlobTrailEdgeOut)):
        if M.str1_GlobTrailEdgeOut[i][0] != "E" and M.ln1_GlobTrailEdgeOut[i].Length != 0.0:
            trails_C.append(M.ln1_GlobTrailEdgeOut[i])
            trailsID_C.append("T" + M.str1_GlobTrailEdgeOut[i])
            trailsCol_C.append(M.cl1_GlobTrailEdgeOut[i])
            trailsMag_C.append(M.db1_GlobTrailEdgeOut[i])
        trails = trails_C
        trailsID = trailsID_C
        trailsCol = trailsCol_C
        trailsMag = trailsMag_C
    
    deviationsDirect = M.ln1_GlobDeviation1EdgeOut
    deviationsDirectID = M.str1_GlobDeviation1EdgeOut
    deviationsDirectCol = M.cl1_GlobDeviation1EdgeOut
    deviationsDirectMag = M.db1_GlobDeviation1EdgeOut
    deviationsIndirect = M.ln1_GlobDeviation2EdgeOut
    deviationsIndirectID = M.str1_GlobDeviation2EdgeOut
    deviationsIndirectCol = M.cl1_GlobDeviation2EdgeOut
    deviationsIndirectMag = M.db1_GlobDeviation2EdgeOut
    deviations = M.ln1_GlobDeviationEdgeOut
    deviationsID = ["D" + devID for devID in M.str1_GlobDeviationEdgeOut]
    deviationsCol = M.cl1_GlobDeviationEdgeOut
    deviationsMag = M.db1_GlobDeviationEdgeOut
    externalForces = M.ln1_GlobExtFOEdgeOut
    externalForcesID = M.str1_ExtFOEdge
    externalForcesCol = M.cl1_GlobExtFOEdgeOut
    externalForcesMag = M.db1_GlobExtFOEdgeOut
    
</item>
                    <item name="Description" type_name="gh_string" type_code="10">Retrieves automatically the data in the structural model</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>2405</X>
                      <Y>32</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1424</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">1d407cf0-8ed7-493e-8ac0-5cf92bb599e1</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">Python Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Extract_Structure_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>2547</X>
                          <Y>1212</Y>
                          <W>153</W>
                          <H>284</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>2581</X>
                          <Y>1354</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="17">
                        <item name="InputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">14</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="1" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="2" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="3" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="4" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="5" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="6" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="7" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="8" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="9" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="10" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="11" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="12" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="13" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="15">
                        <chunk name="InputParam" index="0">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(structural model) The calculated structural model (empty on error)</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">66543e84-b78b-4bf8-aa00-8a1e28423ced</item>
                            <item name="Name" type_name="gh_string" type_code="10">M</item>
                            <item name="NickName" type_name="gh_string" type_code="10">M</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">e0d07d91-702a-4374-8b7e-f3e6e5c497b3</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2549</X>
                                  <Y>1214</Y>
                                  <W>17</W>
                                  <H>280</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2559</X>
                                  <Y>1354</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(point3D) The nodes of the structural model</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">9423ec84-e841-4ae2-b445-4259802bd687</item>
                            <item name="Name" type_name="gh_string" type_code="10">nodes</item>
                            <item name="NickName" type_name="gh_string" type_code="10">nodes</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1214</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1224</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="1">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(string) The IDs of the nodes</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">ef9f9f8c-f1b5-44c9-b81f-e0a245217811</item>
                            <item name="Name" type_name="gh_string" type_code="10">nodesID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">nodesID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1234</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1244</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="2">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(line) The trail edges of the structural model</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">3b96d462-fe30-49f8-bf76-4c2a0887941c</item>
                            <item name="Name" type_name="gh_string" type_code="10">trails</item>
                            <item name="NickName" type_name="gh_string" type_code="10">trails</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1254</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1264</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="3">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(string) The IDs of the trail edges</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">62d193f1-7aca-428d-8097-3e530117c0c3</item>
                            <item name="Name" type_name="gh_string" type_code="10">trailsID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">trailsID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1274</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1284</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="4">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(color) The colors of the trail edges</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">ce841d39-c35c-4e66-b476-7de59a965506</item>
                            <item name="Name" type_name="gh_string" type_code="10">trailsCol</item>
                            <item name="NickName" type_name="gh_string" type_code="10">trailsCol</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1294</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1304</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="5">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(double) The magnitudes of the forces in the trail edges</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">102a1f6c-7f73-4c38-ba9d-e35f8b0e6c97</item>
                            <item name="Name" type_name="gh_string" type_code="10">trailsMag</item>
                            <item name="NickName" type_name="gh_string" type_code="10">trailsMag</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1314</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1324</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="6">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Extract_Structure</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">7d1f41f7-3d39-4732-8c86-9eb6738ab134</item>
                            <item name="Name" type_name="gh_string" type_code="10">deviations</item>
                            <item name="NickName" type_name="gh_string" type_code="10">deviations</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1334</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1344</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="7">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Extract_Structure</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">cb044d36-8b35-4b28-a22e-50c334aabd81</item>
                            <item name="Name" type_name="gh_string" type_code="10">deviationsID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">deviationsID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1354</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1364</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="8">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Extract_Structure</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">05d9ffd3-ea83-468e-8afc-8c1ca05b7504</item>
                            <item name="Name" type_name="gh_string" type_code="10">deviationsCol</item>
                            <item name="NickName" type_name="gh_string" type_code="10">deviationsCol</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1374</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1384</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="9">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Extract_Structure</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">f557df84-a3ab-44ab-9696-124f7777690b</item>
                            <item name="Name" type_name="gh_string" type_code="10">deviationsMag</item>
                            <item name="NickName" type_name="gh_string" type_code="10">deviationsMag</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1394</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1404</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="10">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(line) The external forces of the structural model</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">6dfe8acf-d3cd-4f16-a454-8fc784e6c970</item>
                            <item name="Name" type_name="gh_string" type_code="10">externalForces</item>
                            <item name="NickName" type_name="gh_string" type_code="10">externalForces</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1414</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1424</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="11">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Extract_Structure</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">61dd57c9-46da-4ca9-a6c1-7d0e8fcdb211</item>
                            <item name="Name" type_name="gh_string" type_code="10">externalForcesID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">externalForcesID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1434</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1444</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="12">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(color) The colors of the external forces </item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">b0fc9ece-ddb4-4ffd-ab31-f68637034559</item>
                            <item name="Name" type_name="gh_string" type_code="10">externalForcesCol</item>
                            <item name="NickName" type_name="gh_string" type_code="10">externalForcesCol</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1454</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1464</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="13">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(double) The magnitudes of the forces in the external forces </item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">07497068-5ca3-4390-ad01-b3843efad090</item>
                            <item name="Name" type_name="gh_string" type_code="10">externalForcesMag</item>
                            <item name="NickName" type_name="gh_string" type_code="10">externalForcesMag</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2596</X>
                                  <Y>1474</Y>
                                  <W>102</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2647</X>
                                  <Y>1484</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="14">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">00027467-0d24-4fa7-b178-8dc0ac5f42ec</item>
                <item name="Name" type_name="gh_string" type_code="10">Value List</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="9">
                    <item name="Description" type_name="gh_string" type_code="10">Provides a list of preset values to choose from</item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">10117d4f-52c1-4184-a1f6-99e0b48cdc72</item>
                    <item name="ListCount" type_name="gh_int32" type_code="3">10</item>
                    <item name="ListMode" type_name="gh_int32" type_code="3">1</item>
                    <item name="Name" type_name="gh_string" type_code="10">Value List</item>
                    <item name="NickName" type_name="gh_string" type_code="10">List</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="11">
                    <chunk name="ListItem" index="0">
                      <items count="3">
                        <item name="Expression" type_name="gh_string" type_code="10">"LD_AUGLAG"</item>
                        <item name="Name" type_name="gh_string" type_code="10">LD_AUGLAG</item>
                        <item name="Selected" type_name="gh_bool" type_code="1">false</item>
                      </items>
                    </chunk>
                    <chunk name="ListItem" index="1">
                      <items count="3">
                        <item name="Expression" type_name="gh_string" type_code="10">"LD_LBFGS"</item>
                        <item name="Name" type_name="gh_string" type_code="10">LD_LBFGS</item>
                        <item name="Selected" type_name="gh_bool" type_code="1">true</item>
                      </items>
                    </chunk>
                    <chunk name="ListItem" index="2">
                      <items count="3">
                        <item name="Expression" type_name="gh_string" type_code="10">"LD_SLSQP"</item>
                        <item name="Name" type_name="gh_string" type_code="10">LD_SLSQP</item>
                        <item name="Selected" type_name="gh_bool" type_code="1">false</item>
                      </items>
                    </chunk>
                    <chunk name="ListItem" index="3">
                      <items count="3">
                        <item name="Expression" type_name="gh_string" type_code="10">"LD_TNEWTON"</item>
                        <item name="Name" type_name="gh_string" type_code="10">LD_TNEWTON</item>
                        <item name="Selected" type_name="gh_bool" type_code="1">false</item>
                      </items>
                    </chunk>
                    <chunk name="ListItem" index="4">
                      <items count="3">
                        <item name="Expression" type_name="gh_string" type_code="10">"LN_BOBYQA"</item>
                        <item name="Name" type_name="gh_string" type_code="10">LN_BOBYQA</item>
                        <item name="Selected" type_name="gh_bool" type_code="1">false</item>
                      </items>
                    </chunk>
                    <chunk name="ListItem" index="5">
                      <items count="3">
                        <item name="Expression" type_name="gh_string" type_code="10">"LN_COBYLA"</item>
                        <item name="Name" type_name="gh_string" type_code="10">LN_COBYLA</item>
                        <item name="Selected" type_name="gh_bool" type_code="1">false</item>
                      </items>
                    </chunk>
                    <chunk name="ListItem" index="6">
                      <items count="3">
                        <item name="Expression" type_name="gh_string" type_code="10">"LN_SBPLX"</item>
                        <item name="Name" type_name="gh_string" type_code="10">LN_SBPLX</item>
                        <item name="Selected" type_name="gh_bool" type_code="1">false</item>
                      </items>
                    </chunk>
                    <chunk name="ListItem" index="7">
                      <items count="3">
                        <item name="Expression" type_name="gh_string" type_code="10">"GD_MLSL"</item>
                        <item name="Name" type_name="gh_string" type_code="10">GD_MLSL</item>
                        <item name="Selected" type_name="gh_bool" type_code="1">false</item>
                      </items>
                    </chunk>
                    <chunk name="ListItem" index="8">
                      <items count="3">
                        <item name="Expression" type_name="gh_string" type_code="10">"GN_MLSL"</item>
                        <item name="Name" type_name="gh_string" type_code="10">GN_MLSL</item>
                        <item name="Selected" type_name="gh_bool" type_code="1">false</item>
                      </items>
                    </chunk>
                    <chunk name="ListItem" index="9">
                      <items count="3">
                        <item name="Expression" type_name="gh_string" type_code="10">"GN_ISRES"</item>
                        <item name="Name" type_name="gh_string" type_code="10">GN_ISRES</item>
                        <item name="Selected" type_name="gh_bool" type_code="1">false</item>
                      </items>
                    </chunk>
                    <chunk name="Attributes">
                      <items count="1">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>2319</Y>
                          <W>106</W>
                          <H>22</H>
                        </item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="15">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">e2dae991-e948-4af1-bb80-65e55b098fda</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>2301</Y>
                          <W>199</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1240.578</X>
                          <Y>2301.389</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">3</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">1</item>
                        <item name="Max" type_name="gh_double" type_code="6">1000</item>
                        <item name="Min" type_name="gh_double" type_code="6">1</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">1</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="16">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">3267af80-ec77-49b1-94eb-4655a81d51c7</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>2281</Y>
                          <W>215</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1240.855</X>
                          <Y>2281.796</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">6</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">1</item>
                        <item name="Min" type_name="gh_double" type_code="6">1E-06</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">1E-06</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="17">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">7207f535-b0a0-4661-a545-92dc1b04ced1</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>2261</Y>
                          <W>199</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1240.421</X>
                          <Y>2261.653</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">6</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">1</item>
                        <item name="Min" type_name="gh_double" type_code="6">0.0001</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">0.0001</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="18">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Assign bounds to deviation forces
    Inputs:
        boundDevID: (string) The deviation edges ID that are allowed to change their force magnitude
        boundUpDev: (float) The upper bound of allowable change of force magnitudes [kN]
        boundLowDev: (float) The lower bound of allowable change of force magnitudes [kN]
    Outputs:
        BD: (Bounds Deviation Edges) The bounds for the deviation edges force magnitudes
    Remarks:
        This generates a new instance of bounds for the deviation edges for the optimization
"""


__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""


import Rhino


class BoundDev(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        if boundDevID and boundDevID[0] is not None:
            return "Bound Deviation"
        else:
            return "Bound Deviation not defined"


BD = BoundDev()
BD.ID = []
BD.Up = []
BD.Low = []

if boundDevID and boundDevID[0] is not None:
    boundDevID = [ int(devID[1:]) for devID in boundDevID]
    if len(boundDevID) == len(boundUpDev) and len(boundDevID) == len(boundLowDev):
        BD.ID = boundDevID
        BD.Up = [abs(boundUpDev_i) for boundUpDev_i in boundUpDev]
        BD.Low = [-abs(boundLowDev_i) for boundLowDev_i in boundLowDev]
    elif len(boundUpDev) == 1 and len(boundLowDev) == 1:
        boundUpDevC = []
        for i in range(len(boundDevID)):
            boundUpDevC.append(abs(boundUpDev[0]))
        boundLowDevC = []
        for i in range(len(boundDevID)):
            boundLowDevC.append(-abs(boundLowDev[0]))
        BD.ID = boundDevID
        BD.Up = boundUpDevC
        BD.Low = boundLowDevC
    else:
        boundUpDevC = []
        for i in range(len(boundDevID)):
            boundUpDevC.append(0.0)
        boundLowDevC = []
        for i in range(len(boundDevID)):
            boundLowDevC.append(0.0)
        BD.ID = boundDevID
        BD.Up = boundUpDevC
        BD.Low = boundLowDevC
else:
    boundUpDevC = []
    for i in range(len(boundDevID)):
        boundUpDevC.append(0.0)
    boundLowDevC = []
    for i in range(len(boundDevID)):
        boundLowDevC.append(0.0)
    BD.ID = boundDevID
    BD.Up = boundUpDevC
    BD.Low = boundLowDevC</item>
                    <item name="Description" type_name="gh_string" type_code="10">Assign bounds to deviation forces</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>104</X>
                      <Y>104</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1821</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">1bb3363e-e511-497d-83d4-410b1bafbbb9</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Bound_Deviation_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1667</X>
                          <Y>2063</Y>
                          <W>151</W>
                          <H>64</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1777</X>
                          <Y>2095</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="6">
                        <item name="InputCount" type_name="gh_int32" type_code="3">3</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="2" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="4">
                        <chunk name="InputParam" index="0">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(string) The deviation edges ID that are allowed to change their force magnitude</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">0f90b546-64d1-4d82-9c9c-e69f0401a36f</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundDevID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundDevID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">e2f19f88-a407-404f-b400-7920351312ac</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">37261734-eec7-4f50-b6a8-b8d1f3c4396b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1669</X>
                                  <Y>2065</Y>
                                  <W>93</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1725</X>
                                  <Y>2075</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The upper bound of allowable change of force magnitudes [kN]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">896d82f6-29d3-4bcf-aec4-ef823f902385</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundUpDev</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundUpDev</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">d7978c6b-5a1d-410d-856d-a9152361f2f8</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1669</X>
                                  <Y>2085</Y>
                                  <W>93</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1725</X>
                                  <Y>2095</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="2">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The lower bound of allowable change of force magnitudes [kN]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">f14dfa76-377f-4b3e-8165-323814e09dff</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundLowDev</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundLowDev</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">d7978c6b-5a1d-410d-856d-a9152361f2f8</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1669</X>
                                  <Y>2105</Y>
                                  <W>93</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1725</X>
                                  <Y>2115</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(Bounds Deviation Edges) The bounds for the deviation edges force magnitudes</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">36a9901a-a226-4e23-ba6b-f393f78712a5</item>
                            <item name="Name" type_name="gh_string" type_code="10">BD</item>
                            <item name="NickName" type_name="gh_string" type_code="10">BD</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1792</X>
                                  <Y>2065</Y>
                                  <W>24</W>
                                  <H>60</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1804</X>
                                  <Y>2095</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="19">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Combines the Optimization settings
    Inputs:
        TN: (target nodes) The assigned target nodes, their ID and weights
        TV: (target vectors) The assigned target vectors, their ID and weights
        BO: (boundsoriginnodeObject) The bounds for the origin nodes
        BT: (boundstrailObject) The bounds for the trail edges lengths
        BD: (boundsdeviationObject) The bounds for the deviation edges force magnitudes
        gradientDelta: (float) The delta for the determination of the gradient through finite differences
        relativeTolerance: (float) The threshold which describes one stoping criteria
        maxIterations: (Integer) The maximum number of iteration steps
        optimAlgorithm: (AlgorithmType) The type of solver from the NLOpt library
    Outputs:
        O: (optimization set-up) The settings for an optimization that can be performed 
    Remarks:
        This generates a new instance of the optimization set-up
"""


__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""


import Rhino


class Opt(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        bl0_targetNode = False
        bl0_targetVector = False
        if TN and hasattr(TN, "targetNode") and hasattr(TN, "targetNodeID") and len(TN.targetNode) == len(TN.targetNodeID):
                bl0_targetNode = True
        if TV and hasattr(TV, "targetVector") and hasattr(TV, "targetVectorID") and len(TV.targetVector) == len(TV.targetVectorID):
                bl0_targetVector = True
        if bl0_targetNode and bl0_targetVector:
            return "Target Node and Target Vector"
        if bl0_targetNode and not bl0_targetVector:
            return "Target Node"
        if not bl0_targetNode and bl0_targetVector:
            return "Target Vector"
        else:
            return "No Target"

O = Opt()

if TN and hasattr(TN, "targetNode") and hasattr(TN, "targetNodeID"):
    O.targetNode = TN.targetNode
    O.targetNodeID = TN.targetNodeID
    O.targetNodeCoeff = TN.targetNodeCoeff
    
if TV and hasattr(TV, "targetVector") and hasattr(TV, "targetVectorID"):
    O.targetVector = TV.targetVector
    O.targetVectorID = TV.targetVectorID
    O.targetVectorCoeffMag = TV.targetVectorCoeffMag
    O.targetVectorCoeffDir = TV.targetVectorCoeffDir

if BO and hasattr(BO, "ID"):
    O.boundsOriginNodeID = BO.ID
    O.boundsOriginNodeUpX = BO.UpX
    O.boundsOriginNodeLowX = BO.LowX
    O.boundsOriginNodeUpY = BO.UpY
    O.boundsOriginNodeLowY = BO.LowY
    O.boundsOriginNodeUpZ = BO.UpZ
    O.boundsOriginNodeLowZ = BO.LowZ
else:
    O.boundsOriginNodeID = []
    O.boundsOriginNodeUpX = []
    O.boundsOriginNodeLowX = []
    O.boundsOriginNodeUpY = []
    O.boundsOriginNodeLowY = []
    O.boundsOriginNodeUpZ = []
    O.boundsOriginNodeLowZ = []

if BL and hasattr(BL, "ID"):
    O.boundsLoadID = BL.ID
    O.boundsLoadUpX = BL.UpX
    O.boundsLoadLowX = BL.LowX
    O.boundsLoadUpY = BL.UpY
    O.boundsLoadLowY = BL.LowY
    O.boundsLoadUpZ = BL.UpZ
    O.boundsLoadLowZ = BL.LowZ
else:
    O.boundsLoadID = []
    O.boundsLoadUpX = []
    O.boundsLoadLowX = []
    O.boundsLoadUpY = []
    O.boundsLoadLowY = []
    O.boundsLoadUpZ = []
    O.boundsLoadLowZ = []

if BT and hasattr(BT, "ID"):
    O.boundsTrailID = BT.ID
    O.boundsTrailUp = BT.Up
    O.boundsTrailLow = BT.Low
else:
    O.boundsTrailID = []
    O.boundsTrailUp = []
    O.boundsTrailLow = []

if BD and hasattr(BD, "ID"):
    O.boundsDevID = BD.ID
    O.boundsDevUp = BD.Up
    O.boundsDevLow = BD.Low
else:
    O.boundsDevID = []
    O.boundsDevUp = []
    O.boundsDevLow = []

if LP is None or LP == False:
    O.loadPath = False
else:
    O.loadPath = True

if gradientDelta is None:
    O.gradientDelta = 0.001
else:
    O.gradientDelta = gradientDelta

if relativeTolerance is None:
    O.relativeTolerance = 0.001
else:
    O.relativeTolerance = relativeTolerance

if maxIterations is None:
    O.maxIterations = 20
else:
    O.maxIterations = maxIterations

if optimAlgorithm is None:
    O.optimAlgorithm = "LN_BOBYQA"
else:
    O.optimAlgorithm = optimAlgorithm
</item>
                    <item name="Description" type_name="gh_string" type_code="10">Combines the Optimization settings</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>130</X>
                      <Y>130</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>2277</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">1ae57ce7-e9ab-4ebf-b3de-4aac7a3cd932</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Optimization_Setup_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>2004</X>
                          <Y>2118</Y>
                          <W>141</W>
                          <H>224</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>2110</X>
                          <Y>2230</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="14">
                        <item name="InputCount" type_name="gh_int32" type_code="3">11</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="2" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="3" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="4" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="5" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="6" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="7" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="8" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="9" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="10" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="12">
                        <chunk name="InputParam" index="0">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(target nodes) The assigned target nodes, their ID and weights</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">47046747-57ca-4fbe-8c9a-915df9eba6a4</item>
                            <item name="Name" type_name="gh_string" type_code="10">TN</item>
                            <item name="NickName" type_name="gh_string" type_code="10">TN</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">979b528b-46ec-4f68-a0b4-c7ef00fea659</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2006</X>
                                  <Y>2120</Y>
                                  <W>89</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2052</X>
                                  <Y>2130</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(target vectors) The assigned target vectors, their ID and weights</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">7127835e-8d77-4fa2-841b-b99b22caeb8a</item>
                            <item name="Name" type_name="gh_string" type_code="10">TV</item>
                            <item name="NickName" type_name="gh_string" type_code="10">TV</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">ca8db80d-c9d1-4f15-b8ff-f71a6729fd39</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2006</X>
                                  <Y>2140</Y>
                                  <W>89</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2052</X>
                                  <Y>2150</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="2">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(boundsoriginnodeObject) The bounds for the origin nodes</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">ce4137dd-e213-4f87-8ea2-9b94ec83bff6</item>
                            <item name="Name" type_name="gh_string" type_code="10">BO</item>
                            <item name="NickName" type_name="gh_string" type_code="10">BO</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">4cd3d1e7-61b5-4a80-8226-f4a0ad9005c4</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2006</X>
                                  <Y>2160</Y>
                                  <W>89</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2052</X>
                                  <Y>2170</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="3">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Optimization_Setup</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">b4236530-2a71-48f8-bee9-0b1e0ca9677c</item>
                            <item name="Name" type_name="gh_string" type_code="10">BL</item>
                            <item name="NickName" type_name="gh_string" type_code="10">BL</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">d08aec19-728d-4163-91bd-db56d4ba73a8</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2006</X>
                                  <Y>2180</Y>
                                  <W>89</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2052</X>
                                  <Y>2190</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="4">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(boundstrailObject) The bounds for the trail edges lengths</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">13ac2293-f655-41d8-9163-f574d0f94071</item>
                            <item name="Name" type_name="gh_string" type_code="10">BT</item>
                            <item name="NickName" type_name="gh_string" type_code="10">BT</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">f8709b4c-3355-4730-b7c4-c85591874de3</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2006</X>
                                  <Y>2200</Y>
                                  <W>89</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2052</X>
                                  <Y>2210</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="5">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(boundsdeviationObject) The bounds for the deviation edges force magnitudes</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">ec033fb5-b245-4315-9475-f06d80b30236</item>
                            <item name="Name" type_name="gh_string" type_code="10">BD</item>
                            <item name="NickName" type_name="gh_string" type_code="10">BD</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">36a9901a-a226-4e23-ba6b-f393f78712a5</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2006</X>
                                  <Y>2220</Y>
                                  <W>89</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2052</X>
                                  <Y>2230</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="6">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Optimization_Setup_2.0</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">dc550273-3541-469c-b946-279e26383ef1</item>
                            <item name="Name" type_name="gh_string" type_code="10">LP</item>
                            <item name="NickName" type_name="gh_string" type_code="10">LP</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">dfd879d9-09e1-493f-87b6-4225b6657c7b</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">87f87f55-5b71-41f4-8aea-21d494016f81</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2006</X>
                                  <Y>2240</Y>
                                  <W>89</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2052</X>
                                  <Y>2250</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="7">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The delta for the determination of the gradient through finite differences</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">51ce0cbd-7212-424c-a0d3-a662ff2ae76c</item>
                            <item name="Name" type_name="gh_string" type_code="10">gradientDelta</item>
                            <item name="NickName" type_name="gh_string" type_code="10">gradientDelta</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">7207f535-b0a0-4661-a545-92dc1b04ced1</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2006</X>
                                  <Y>2260</Y>
                                  <W>89</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2052</X>
                                  <Y>2270</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="8">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The threshold which describes one stoping criteria</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">e186bb2b-e30c-4ca0-b334-6f8321356bc8</item>
                            <item name="Name" type_name="gh_string" type_code="10">relativeTolerance</item>
                            <item name="NickName" type_name="gh_string" type_code="10">relativeTolerance</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">3267af80-ec77-49b1-94eb-4655a81d51c7</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2006</X>
                                  <Y>2280</Y>
                                  <W>89</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2052</X>
                                  <Y>2290</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="9">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(Integer) The maximum number of iteration steps</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">b94fa5f2-53dc-4b9e-878a-719250b3e8de</item>
                            <item name="Name" type_name="gh_string" type_code="10">maxIterations</item>
                            <item name="NickName" type_name="gh_string" type_code="10">maxIterations</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">e2dae991-e948-4af1-bb80-65e55b098fda</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">48d01794-d3d8-4aef-990e-127168822244</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2006</X>
                                  <Y>2300</Y>
                                  <W>89</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2052</X>
                                  <Y>2310</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="10">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(AlgorithmType) The type of solver from the NLOpt library</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">fb108219-05d7-48a2-8f9a-e1c5b6f3c3c2</item>
                            <item name="Name" type_name="gh_string" type_code="10">optimAlgorithm</item>
                            <item name="NickName" type_name="gh_string" type_code="10">optimAlgorithm</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">10117d4f-52c1-4184-a1f6-99e0b48cdc72</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">37261734-eec7-4f50-b6a8-b8d1f3c4396b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2006</X>
                                  <Y>2320</Y>
                                  <W>89</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2052</X>
                                  <Y>2330</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(optimization set-up) The settings for an optimization that can be performed </item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">65e25d58-9652-46e4-825a-9c904652f6fd</item>
                            <item name="Name" type_name="gh_string" type_code="10">O</item>
                            <item name="NickName" type_name="gh_string" type_code="10">O</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2125</X>
                                  <Y>2120</Y>
                                  <W>18</W>
                                  <H>220</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2134</X>
                                  <Y>2230</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="20">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">Python Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Calculate the structural model
    Inputs:
        TP: (topological diagram) The topological diagram used for the calculation of the structural model
        CPL: (constraintPlaneObject) The constraint planes and their Indices
        N: (originnodeObject) The origin nodes and their Indices
        SW: (selfWeightObject) The Activation of self weight of the structure and their yield stress and specific weight attributes
        O: (optimizationObject) The Settings for an Optimization that can be performed 
    Outputs:
        M: (structural model) The calculated structural model (empty model on error)
    Remarks:
        This generates a new instance of the structural model for a given topological diagram
"""
        
__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"
        
"""
If you use the CEM library in a project, please refer to the GitHub repository: 
        
@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}
        
"""
        
import Grasshopper, GhPython
import System
import rhinoscriptsyntax as rs
import Rhino.Geometry as rh
import math
import System.Drawing.Color
import copy
import time
import clr
import os
import collections
from os.path import expanduser
from System import Array, Func
        
path = expanduser(str(os.getenv('APPDATA')) + ("\\Grasshopper\\Libraries\\NLoptNet\\NLoptNet.dll"))
path = expanduser(path)
        
clr.AddReferenceToFileAndPath(path)
clr.AddReference('System.Core')
        
import NLoptNet as nl
        
global int0_Counter
global pt2_Trails
global pt1_GlobNodeOut
global ln1_GlobTrailEdgeOut
global ln1_GlobDeviation1EdgeOut
global ln1_GlobDeviation2EdgeOut
global vc2_GlobTrailForce
global ln2_GlobExtEdge
global pt2_GlobNode
global pt2_GlobNodeIteration
global ln2_GlobTrailEdge
global cl2_GlobTrailEdge
global db2_GlobTrailEdge
global ln2_GlobDeviation1Edge
global cl2_GlobDeviation1Edge
global db2_GlobDeviation1Edge
global ln2_GlobDeviation2Edge
global cl2_GlobDeviation2Edge
global db2_GlobDeviation2Edge
global ln2_GlobExtFOEdge
global cl2_GlobExtFOEdge
global db2_GlobExtFOEdge
global int0_CounterOpt 
global db0_DistanceBest
global db1_VariableBest
global str1_TrailEdgeID
global str1_Dev1EdgeID
global str1_Dev2EdgeID
global int1_DevEdgeInputID
global str0_GlobSolver
global str0_GlobDivergence
global str0_GlobIteration
global str0_GlobLoadPath
        
class model(object):
    def __repr__(self):
        return self.ToString()
                
    def __str__(self):
        return self.ToString()
                
    def ToString(self):
        if TPC and hasattr(TPC, "db1_StructuralBehaviourOut"):
            str0_Description = "Structural Model\n"
            if str0_GlobLoadPath:
                str0_Description += "\nload path: " + str0_GlobLoadPath
            if str0_GlobSolver:
                str0_Description += "\nsolver: " +  str0_GlobSolver
                if str0_GlobDivergence:
                    str0_Description += "\ndivergence: " +  str0_GlobDivergence
            return str0_Description
        else:
            return "Empty Structural Model"

        
        
        
### AUXILIARY FUNCTIONS
def ListListToList(xx2_Data):
    xx1_DataOut = []
    for xx1_Data in xx2_Data:
        xx1_DataOut.extend(xx1_Data)
    return xx1_DataOut
        
def TransposeListList(xx2_Data):
    xx2_DataOut = list(map(list, zip(*xx2_Data)))
    return xx2_DataOut
            
def ListToListList(xx1_Data, int0_R, int0_C):
    xx2_DataOut = []
    for i in range(int0_R):
        xx1_DataOut = []
        for j in range(int0_C):
            xx1_DataOut.append(xx1_Data[j+i*int0_C])
        xx2_DataOut.append(xx1_DataOut)
    return xx2_DataOut
        
def DataTreeToListList(dt2_Data):
    xx2_DataOut = []
    for i in range(dt2_Data.BranchCount):
        xx1_DataOut = []
        for j in range(len(dt2_Data.Branch(i))):
            xx1_DataOut.append(dt2_Data.Branch(i)[j])
        xx2_DataOut.append(xx1_DataOut)
    return xx2_DataOut
        
        
constraintPlane = []
constraintPlaneID = []
        
if CPL and CPL.ToString() != "Invalid Constraint Planes":
    constraintPlane = CPL.constraintPlane
    constraintPlaneID = CPL.constraintPlaneID
        
        
targetNode = []
targetNodeID = []
targetNodeCoeff = []
        
if O and O.ToString() != "No Target" and hasattr(O, "targetNode") and hasattr(O, "targetNodeID"):
    targetNode = O.targetNode
    targetNodeID = O.targetNodeID
    targetNodeCoeff = O.targetNodeCoeff
        
targetVector = []
targetVectorID = []
targetVectorCoeffMag = []
targetVectorCoeffDir = []
        
if O and O.ToString() != "No Target" and hasattr(O, "targetVector") and hasattr(O, "targetVectorID"):
    targetVector = O.targetVector
    targetVectorID = O.targetVectorID
    targetVectorCoeffMag = O.targetVectorCoeffMag
    targetVectorCoeffDir = O.targetVectorCoeffDir
        
loadPath = False
        
if O and hasattr(O, "loadPath"):
    loadPath = O.loadPath
        
        
yieldStress = None
specWeight = None
        
if SW and SW.ToString() != "No Self Weight" and hasattr(SW, "yieldStress") and hasattr(SW, "specWeight"):
    yieldStress = SW.yieldStress
    specWeight = SW.specWeight
        
TPC = copy.deepcopy(TP)
        
if TPC and TPC.ToString() != "Empty Topology" and hasattr(TPC, "db1_StructuralBehaviourOut"):
    if len(constraintPlane) &gt; 0:
        if len(constraintPlane) == len(constraintPlaneID):
            TPC.pl1_ConstraintPlaneOut = constraintPlane
            TPC.int1_ConstraintPlaneOut = constraintPlaneID
        else:
            TPC.pl1_ConstraintPlaneOut = None
            TPC.int1_ConstraintPlaneOut = None
    else:
        TPC.pl1_ConstraintPlaneOut = None
        TPC.int1_ConstraintPlaneOut = None
        
    if N and N.ToString() != "Undefined Origin Nodes" and hasattr(N, "originNode"):
        if len(N.originNode) == len(TPC.pt1_OriginNodeOut):
            TPC.pt1_OriginNodeOut = N.originNode
        if hasattr(N, "originNodeID") and len(N.originNodeID) == len(TPC.str1_OriginNodeOut):
            int1_OriginNodeOut = [int(str0_OriginNodeOut[1:]) for str0_OriginNodeOut in TPC.str1_OriginNodeOut]
            pt1_OriginNodeShift = []
            if collections.Counter(N.originNodeID) == collections.Counter(int1_OriginNodeOut):
                for int0_OriginNodeID in N.originNodeID:
                    pt1_OriginNodeShift.append(TPC.pt1_OriginNodeOut[int1_OriginNodeOut.index(int0_OriginNodeID)])
                TPC.pt1_OriginNodeOut = pt1_OriginNodeShift
        
        
## CREATE LIST OF EDGES IDS
        
if TPC and hasattr(TPC, "dc2_TrailEndsOut"):
    dc2_TrailEdge = dict( [ [tuple(v),k] for k, v in TPC.dc2_TrailEndsOut.items() ] )
        
str1_NodeOrder = []
if TPC and hasattr(TPC, "db1_StructuralBehaviourOut"):
    str1_NodeOrder = TPC.str1_NodeOrderOut[:]
        
    # Trail Edge
    str1_TrailEdgeID = []
    for str0_NodeOrder in str1_NodeOrder:
        for key in dc2_TrailEdge:
            if str0_NodeOrder == key[0] and dc2_TrailEdge[key] != "X":
                str1_TrailEdgeID.append( dc2_TrailEdge[key] )
                dc2_TrailEdge[key] = "X"
            if str0_NodeOrder == key[1] and dc2_TrailEdge[key] != "X":
                str1_TrailEdgeID.append( dc2_TrailEdge[key] )
                dc2_TrailEdge[key] = "X"
        
# Direct Deviation Edges
        
dc2_Deviation1EndsOut = []
dc2_Deviation2EndsOut = []
db1_StructuralBehaviourOut = []
pt1_OriginNodeOut = []
        
if TPC and hasattr(TPC, "db1_StructuralBehaviourOut"):
    dc2_Deviation1EndsOut = TPC.dc2_Deviation1EndsOut
    dc2_Deviation2EndsOut = TPC.dc2_Deviation2EndsOut
    db1_StructuralBehaviourOut = TPC.db1_StructuralBehaviourOut
    pt1_OriginNodeOut = TPC.pt1_OriginNodeOut
        
        
    dc2_Dev1Edge = dict( [ [tuple(v),k] for k, v in dc2_Deviation1EndsOut.items() ] )
    dc2_Dev2Edge = dict( [ [tuple(v),k] for k, v in dc2_Deviation2EndsOut.items() ] )
        
    str1_Dev1EdgeID = []
    db2_StructuralBehaviourOut = []
    for i in range(len(str1_NodeOrder)):
        db1_StructuralBehaviourOutRow = db1_StructuralBehaviourOut[i*(3+len(pt1_OriginNodeOut)+1):(i+1)*(3+len(pt1_OriginNodeOut)+1)]
        db2_StructuralBehaviourOut.append(db1_StructuralBehaviourOutRow)
            
    for i in range(len(db2_StructuralBehaviourOut)):
        for j in range(4+(i % (len(db2_StructuralBehaviourOut[i])-4) ) ,len(db2_StructuralBehaviourOut[i])-1):
            if db2_StructuralBehaviourOut[i][j] != 0:
                id_i = str1_NodeOrder[i]
                id_j = str1_NodeOrder[ (i // (len(db2_StructuralBehaviourOut[i])-4)) * (len(db2_StructuralBehaviourOut[i])-4) + j-3]
                if (id_i,id_j) in dc2_Dev1Edge:
                    str1_Dev1EdgeID.append(dc2_Dev1Edge[(id_i,id_j)])
                else:
                    str1_Dev1EdgeID.append(dc2_Dev1Edge[(id_j,id_i)])
            
    # Indirect Deviation Edges
    int1_Dev2EdgeID = sorted([int(key) for key in dc2_Deviation2EndsOut.copy()])
    str1_Dev2EdgeID = [str(key) for key in int1_Dev2EdgeID]
            
    int1_DevEdgeInputID = []
    if TPC and hasattr(TPC, "db1_StructuralBehaviourOut"):
        int1_DevEdgeInputID = TPC.int1_Deviation1ID[:]
        int1_DevEdgeInputID.extend(TPC.int1_Deviation2ID)
        
        
# Add External Forces to StructuralBehaviourOut
                
int0_TrailNumber = len(pt1_OriginNodeOut)
int0_C = 3+int0_TrailNumber+1
int0_R = int(len(db1_StructuralBehaviourOut)/int0_C)
        
dc2_ForceOut = []
        
if TPC and hasattr(TPC, "dc2_ForceOut"):
    dc2_ForceOut = TPC.dc2_ForceOut
            
    for key in dc2_ForceOut:
        int0_StructuralBehaviourRow = int(str1_NodeOrder.index(dc2_ForceOut[key][3]))
        int0_ExtForcePosX = int0_StructuralBehaviourRow*(int0_C)
        int0_ExtForcePosY = int0_StructuralBehaviourRow*(int0_C)+1 
        int0_ExtForcePosZ = int0_StructuralBehaviourRow*(int0_C)+2
                
        db1_StructuralBehaviourOut[int0_ExtForcePosX] += dc2_ForceOut[key][0]
        db1_StructuralBehaviourOut[int0_ExtForcePosY] += dc2_ForceOut[key][1]
        db1_StructuralBehaviourOut[int0_ExtForcePosZ] += dc2_ForceOut[key][2]
        
db2_StructuralBehaviour = ListToListList(db1_StructuralBehaviourOut, int0_R, int0_C)
        
        
        
### EQUILIBRIUM FUNCTION
def Equilibrium(db1_StructuralBehaviour, xx1_Bracing, pt1_OriginNode, pl1_ConstraintPlane):
            
            
    global int0_Counter     # global counter
            
            
    g = 0                                   
    ### ITERATE FOR EACH LAYER OF THE STRUCTURE
            
    ## Initialize
    pt1_InputNode = []
            
            
    for g in range(int0_LayerCount):
                
        vc1_TrailForceIn = []
                
        if g == 0:
            pt1_InputNode = pt1_OriginNode
            for i in range(int0_TrailNumber):
                vc1_TrailForceIn.append(rh.Vector3d(0,0,0)) 
        else:
            pt1_InputNode = pt2_GlobNode[g-1]
            for i in range(int0_TrailNumber):
                vc1_TrailForceIn.append(-vc2_GlobTrailForce[g-1][i])
            
        # Extract Deviation Matrix
        db2_DevForceMag = []
        
        for i in range(g * int0_TrailNumber, (g + 1) * int0_TrailNumber):
            db1_DevForceMag = []
            for j in range(3, int0_TrailNumber + 3):
                db1_DevForceMag.append(db2_StructuralBehaviour[i][j])
            db2_DevForceMag.append(db1_DevForceMag)
            
            
        ### LAYER DEVELOPMENT
                
        ## Initialize Layer
                
                
        # Create Deviation Length and Unit Vector Matrix
        vc2_DevLengthVector = []
        vc2_DevUnitVector = []
        db2_DevLengthVector = []
                
        vc2_DevLengthVector = [ [rh.Vector3d(0.0,0.0,0.0) for i in range(int0_TrailNumber)] for i in range(int0_TrailNumber)]
        vc2_DevUnitVector = [ [rh.Vector3d(0.0,0.0,0.0) for i in range(int0_TrailNumber)] for i in range(int0_TrailNumber)]
        db2_DevLengthVector = [ [0.0 for i in range(int0_TrailNumber)] for i in range(int0_TrailNumber)]
                
        for i in range(int0_TrailNumber):
            for j in range(int0_TrailNumber):
                if abs(db2_DevForceMag[i][j]) &gt; db0_Threshold:
                    vc0_InputNode_j = rh.Vector3d(pt1_InputNode[j])
                    vc0_InputNode_i = rh.Vector3d(pt1_InputNode[i])
                    vc0_DevLengthVector = vc0_InputNode_j - vc0_InputNode_i
                    vc2_DevLengthVector[i][j] = vc0_DevLengthVector
                    vc2_DevLengthVector[j][i] = -vc0_DevLengthVector
                    db0_DevLengthVector = vc0_DevLengthVector.Length
                    db2_DevLengthVector[i][j] = db0_DevLengthVector
                    db2_DevLengthVector[j][i] = db0_DevLengthVector
                    vc0_DevUnitVector = rh.Vector3d(vc0_DevLengthVector.X/db0_DevLengthVector, vc0_DevLengthVector.Y/db0_DevLengthVector, vc0_DevLengthVector.Z/db0_DevLengthVector)
                    vc2_DevUnitVector[i][j] = vc0_DevUnitVector
                    vc2_DevUnitVector[j][i] = -vc0_DevUnitVector
                
                
        # Create List of External Forces
        # list for external and bracing forces
        db1_ExtForceX = []
        db1_ExtForceY = []
        db1_ExtForceZ = []
                
        # list for external forces only
        db1_ExtFOX = []
        db1_ExtFOY = []
        db1_ExtFOZ = []
                
        # Add External Forces from Matrix    
        for i in range(g*int0_TrailNumber,(g+1)*int0_TrailNumber):
            db1_ExtFOX.append(db2_StructuralBehaviour[i][0])
            db1_ExtFOY.append(db2_StructuralBehaviour[i][1])
            db1_ExtFOZ.append(db2_StructuralBehaviour[i][2])
                    
        for i in range(g*int0_TrailNumber,(g+1)*int0_TrailNumber):
            db1_ExtForceX.append(db2_StructuralBehaviour[i][0])
            db1_ExtForceY.append(db2_StructuralBehaviour[i][1])
            db1_ExtForceZ.append(db2_StructuralBehaviour[i][2])
        
        
            # Add Magnitudes of Bracing Forces as External Forces
            # Start node of bracing
            if len(xx1_Bracing) &gt; 0:
                if int0_Counter != 0:
                    for j in range(0,len(xx1_Bracing),3):
                        int0_BracingFromLayerIndex = int(xx1_Bracing[j]) // int0_TrailNumber
                        if i == int(xx1_Bracing[j]):
                            pt0_BracingFrom = pt2_GlobNodeIteration[g][i-g*int0_TrailNumber]
                            int0_BracingToLayerIndex = int(xx1_Bracing[j+1]) // int0_TrailNumber
                            int0_BracingToTrailIndex = int(xx1_Bracing[j+1]) % int0_TrailNumber
                            pt0_BracingTo = pt2_GlobNodeIteration[int0_BracingToLayerIndex][int0_BracingToTrailIndex]
                            vc0_ForceA = rh.Vector3d(pt0_BracingTo-pt0_BracingFrom)
                            rh.Vector3d.Unitize(vc0_ForceA)
                            vc0_ForceA = float(xx1_Bracing[j+2])*vc0_ForceA
                            db1_ExtForceX[i-g*int0_TrailNumber] += vc0_ForceA.X
                            db1_ExtForceY[i-g*int0_TrailNumber] += vc0_ForceA.Y
                            db1_ExtForceZ[i-g*int0_TrailNumber] += vc0_ForceA.Z
                                
            # End node of bracing
            if len(xx1_Bracing) &gt; 0:
                if int0_Counter != 0:
                    for j in range(1,len(xx1_Bracing),3):
                        int0_BracingFromLayerIndex = int(xx1_Bracing[j]) // int0_TrailNumber
                        if i == int(xx1_Bracing[j]):
                            pt0_BracingFrom = pt2_GlobNodeIteration[g][i-g*int0_TrailNumber]
                            int0_BracingToLayerIndex = int(xx1_Bracing[j-1]) // int0_TrailNumber
                            int0_BracingToTrailIndex = int(xx1_Bracing[j-1]) % int0_TrailNumber
                            pt0_BracingTo = pt2_GlobNodeIteration[int0_BracingToLayerIndex][int0_BracingToTrailIndex]
                            vc0_ForceA = rh.Vector3d(pt0_BracingTo-pt0_BracingFrom)
                            rh.Vector3d.Unitize(vc0_ForceA)
                            vc0_ForceA = float(xx1_Bracing[j+1])*vc0_ForceA
                            db1_ExtForceX[i-g*int0_TrailNumber] += vc0_ForceA.X
                            db1_ExtForceY[i-g*int0_TrailNumber] += vc0_ForceA.Y
                            db1_ExtForceZ[i-g*int0_TrailNumber] += vc0_ForceA.Z
                
        # Vector sum of external and bracing forces for the equilibrium calculation
        vc1_ExtForce = []
        for i in range(int0_TrailNumber):
            vc0_ExtForce = rh.Vector3d(db1_ExtForceX[i],db1_ExtForceY[i],db1_ExtForceZ[i])
            vc1_ExtForce.append(vc0_ExtForce)
                
                
        # Extract Deviation Matrix
        db2_DevForceMag = []
                
        for i in range(g*int0_TrailNumber,(g+1)*int0_TrailNumber):
            db1_DevForceMag = []
            for j in range(3,int0_TrailNumber+3):
                db1_DevForceMag.append(db2_StructuralBehaviour[i][j])
            db2_DevForceMag.append(db1_DevForceMag)
                
                
        # Create Trail Length and Static Action Matrix from Input Origin Points
        db1_TrailLength = []
        db1_TrailStatAct = []
                
        for i in range(g*int0_TrailNumber,(g+1)*int0_TrailNumber):
            db1_TrailLength.append(db2_StructuralBehaviour[i][int0_TrailNumber+3])
            if g == 0:
                db1_TrailStatAct.append(0)
            else:
                db1_TrailStatAct.append(abs((db2_StructuralBehaviour[i-int0_TrailNumber][int0_TrailNumber+3]*vc1_TrailForceIn[i-g*int0_TrailNumber]).Length))
                
        # Calculate Hadamard Product of Deviation Length Matrix and Deviation Matrix
        vc2_DevForce = []
        db2_DevStatAct = []
                
        for i in range(int0_TrailNumber):
            vc1_DevForce = []
            db1_DevStatAct = []
            for j in range(int0_TrailNumber):
                vc0_DevForce = vc2_DevUnitVector[i][j]*db2_DevForceMag[i][j]
                db0_DevStatAct = abs(db2_DevLengthVector[i][j]*db2_DevForceMag[i][j])
                vc1_DevForce.append(vc0_DevForce)
                db1_DevStatAct.append(db0_DevStatAct)
            vc2_DevForce.append(vc1_DevForce)
            db2_DevStatAct.append(db1_DevStatAct)
        
                
        # Sum Deviation Vectors and Static Action per each Node
        vc1_DevForceSum = []
        db1_DevStatActSum = []
        db1_IndDevStatActSum = []
                
        for i in range(int0_TrailNumber):
            vc0_DevForceSum = rh.Vector3d(0,0,0)
            db0_DevStatActSum = 0
            for j in range(int0_TrailNumber):
                vc0_DevForceSum += vc2_DevForce[i][j]
                db0_DevStatActSum += db2_DevStatAct[i][j]
            vc1_DevForceSum.append(vc0_DevForceSum)
            db1_DevStatActSum.append(db0_DevStatActSum)
        # Get Static Action per Node for Indirect Deviations
        # Start Node of Inderect Deviations
        if specWeight and yieldStress and len(xx1_Bracing) &gt; 0:
            int1_StartBracingIndex = []
            int1_EndBracingIndex = []
            db1_BracingValue = []
            for i in range(0,len(xx1_Bracing),3):
                int1_StartBracingIndex.append(int(xx1_Bracing[i]))
                int1_EndBracingIndex.append(int(xx1_Bracing[i+1]))
                db1_BracingValue.append(float(xx1_Bracing[i+2]))
            for i in range(int0_TrailNumber):
                if int0_Counter != 0:
                    int1_StartBracingIndex_C = int1_StartBracingIndex[:]
                    int1_EndBracingIndex_C = int1_EndBracingIndex[:]
                    db1_BracingValue_C = db1_BracingValue[:]
                    db0_IndDevStatActSum = 0
                    for j in int1_StartBracingIndex:
                        if g*int0_TrailNumber + i == j:
                            int0_StartBracingIndex = int1_StartBracingIndex_C.index(g*int0_TrailNumber + i)
                            int0_StartBracingGlobIndex = g*int0_TrailNumber + i
                            int0_EndBracingGlobIndex = int1_EndBracingIndex_C[ int0_StartBracingIndex ]
                            db0_ValueBracingGlobIndex = db1_BracingValue_C[ int0_StartBracingIndex ]
                            int1_StartBracingIndex_C.pop( int0_StartBracingIndex )
                            int1_EndBracingIndex_C.pop( int0_StartBracingIndex )
                            db1_BracingValue_C.pop( int0_StartBracingIndex )
                            # Get Start and End Nodes of Bracing
                            int0_StartBracingLayer = g
                            int0_StartBracingTrail = i
                            int0_EndBracingLayer = int0_EndBracingGlobIndex // int0_TrailNumber
                            int0_EndBracingTrail = int0_EndBracingGlobIndex % int0_TrailNumber
                            pt0_StartBracing = pt2_GlobNodeIteration[int0_StartBracingLayer][int0_StartBracingTrail]
                            pt0_EndBracing = pt2_GlobNodeIteration[int0_EndBracingLayer][int0_EndBracingTrail]
                            db0_IndDevStatActSum += abs(db0_ValueBracingGlobIndex*pt0_StartBracing.DistanceTo(pt0_EndBracing))
                    db1_IndDevStatActSum.append(db0_IndDevStatActSum)
                                
            # End Node of Inderect Deviations
            int1_StartBracingIndex = []
            int1_EndBracingIndex = []
            db1_BracingValue = []
            for i in range(1,len(xx1_Bracing),3):
                int1_StartBracingIndex.append(int(xx1_Bracing[i-1]))
                int1_EndBracingIndex.append(int(xx1_Bracing[i]))
                db1_BracingValue.append(float(xx1_Bracing[i+1]))
            for i in range(int0_TrailNumber):
                if int0_Counter != 0:
                    int1_StartBracingIndex_C = int1_StartBracingIndex[:]
                    int1_EndBracingIndex_C = int1_EndBracingIndex[:]
                    db1_BracingValue_C = db1_BracingValue[:]
                    db0_IndDevStatActSum = 0
                    for j in int1_EndBracingIndex:
                        if g*int0_TrailNumber + i == j:
                            int0_EndBracingIndex = int1_EndBracingIndex_C.index(g*int0_TrailNumber + i)
                            int0_EndBracingGlobIndex = g*int0_TrailNumber + i
                            int0_StartBracingGlobIndex = int1_StartBracingIndex_C[ int0_EndBracingIndex ]
                            db0_ValueBracingGlobIndex = db1_BracingValue_C[ int0_EndBracingIndex ]
                            int1_StartBracingIndex_C.pop( int0_EndBracingIndex )
                            int1_EndBracingIndex_C.pop( int0_EndBracingIndex )
                            db1_BracingValue_C.pop( int0_EndBracingIndex )
                            # Get Start and End Nodes of Bracing
                            int0_EndBracingLayer = g
                            int0_EndBracingTrail = i
                            int0_StartBracingLayer = int0_StartBracingGlobIndex // int0_TrailNumber
                            int0_StartBracingTrail = int0_StartBracingGlobIndex % int0_TrailNumber
                            pt0_StartBracing = pt2_GlobNodeIteration[int0_StartBracingLayer][int0_StartBracingTrail]
                            pt0_EndBracing = pt2_GlobNodeIteration[int0_EndBracingLayer][int0_EndBracingTrail]
                            db0_IndDevStatActSum += abs(db0_ValueBracingGlobIndex*pt0_StartBracing.DistanceTo(pt0_EndBracing))
                    db1_IndDevStatActSum[i] += db0_IndDevStatActSum
        else:
            db1_IndDevStatActSum = [0.0 for i in range(int0_TrailNumber)]
                
        # Construct Equilibrium per each Node
        vc1_TrailForceOut = []
        vc1_SelfWeight = []
        
                
        for i in range(int0_TrailNumber):
            if int0_Counter == 0 and len(xx1_Bracing) &gt; 0:
                if specWeight and yieldStress:
                    vc0_SelfWeight = rh.Vector3d(((db1_TrailStatAct[i] + db1_DevStatActSum[i]/2)*specWeight/yieldStress)*(-rh.Vector3d.ZAxis))
                    vc0_TrailForceOut = -(vc1_ExtForce[i] + vc1_DevForceSum[i] + vc1_TrailForceIn[i] + vc0_SelfWeight)
                    vc1_TrailForceOut.append(vc0_TrailForceOut)
                    vc1_SelfWeight.append(vc0_SelfWeight)
                else:
                    vc0_TrailForceOut = -(vc1_ExtForce[i] + vc1_DevForceSum[i] + vc1_TrailForceIn[i])
                    vc1_TrailForceOut.append(vc0_TrailForceOut)
            else:
                if specWeight and yieldStress:
                    vc0_SelfWeight = rh.Vector3d(((db1_TrailStatAct[i] + db1_DevStatActSum[i]/2 + db1_IndDevStatActSum[i]/2 )*specWeight/yieldStress)*(-rh.Vector3d.ZAxis))
                    vc0_TrailForceOut = -(vc1_ExtForce[i] + vc1_DevForceSum[i] + vc1_TrailForceIn[i] + vc0_SelfWeight)
                    vc1_TrailForceOut.append(vc0_TrailForceOut)
                    vc1_SelfWeight.append(vc0_SelfWeight)
                else:
                    vc0_TrailForceOut = -(vc1_ExtForce[i] + vc1_DevForceSum[i] + vc1_TrailForceIn[i])
                    vc1_TrailForceOut.append(vc0_TrailForceOut)
                        
        
        
        # Add External Forces to the Form Diagram
        ln1_ExtFOEdge = []
        cl1_ExtFOEdge = []
        db1_ExtFOEdge = []
        
        
        # Vector sum of external forces only for visualization
        vc1_ExtFO = []
        for i in range(int0_TrailNumber):
            vc0_ExtFO = rh.Vector3d(db1_ExtFOX[i],db1_ExtFOY[i],db1_ExtFOZ[i])
            vc1_ExtFO.append(vc0_ExtFO)
                
        for i in range(len(vc1_ExtFO)):
            if len(vc1_SelfWeight) == len(vc1_ExtFO):
                ln1_ExtFOEdge.append(rh.Line(pt1_InputNode[i],(pt1_InputNode[i] + vc1_SelfWeight[i] + vc1_ExtFO[i])))
                cl1_ExtFOEdge.append(System.Drawing.Color.DarkGreen)
                db1_ExtFOEdge.append(abs(vc1_SelfWeight[i].Length + vc1_ExtFO[i].Length))
            else:
                ln1_ExtFOEdge.append(rh.Line(pt1_InputNode[i],(pt1_InputNode[i] + vc1_ExtFO[i])))
                cl1_ExtFOEdge.append(System.Drawing.Color.DarkGreen)
                db1_ExtFOEdge.append(abs(vc1_ExtFO[i].Length))
        
        
                
        ## Construction Form Diagram
                
        # Find New Nodes
               
        pt1_Node = []
                
        for i in range(int0_TrailNumber):
            vc0_TrailForceOutUn = rh.Vector3d(vc1_TrailForceOut[i])
            rh.Vector3d.Unitize(vc0_TrailForceOutUn)
            ln0_TrailOut = rh.Line(pt1_InputNode[i],vc0_TrailForceOutUn)
            pt0_Node = pt1_InputNode[i] + vc0_TrailForceOutUn*db1_TrailLength[i]
            pt1_Node.append(pt0_Node)
                    
            # Modify result in case of constraint planes
            if pl1_ConstraintPlane:
                if g != int0_LayerCount-1:
                    for j in range(len(id_NodePlane)):
                        if str(str1_NodeOrderC[((g+1)*int0_TrailNumber)+i]) == str(id_NodePlane[j]):
                            pl0_PlaneTrailOut = pl1_ConstraintPlane[j]
                            if pl0_PlaneTrailOut is not None:
                                xx1_Intersect = rh.Intersect.Intersection.LinePlane(ln0_TrailOut,pl0_PlaneTrailOut)
                                bl0_Intersect = xx1_Intersect[0]
                                db0_Intersect = xx1_Intersect[1]
                                if abs(db0_Intersect) &lt; abs(db0_Threshold):
                                    db1_TrailLength[i] = 0.0
                                    pt0_Node = pt1_InputNode[i]
                                if bl0_Intersect and abs(db0_Intersect) &gt; abs(db0_Threshold):
                                    pt0_Node = ln0_TrailOut.PointAt(db0_Intersect)
                                    db1_TrailLength[i] = pt1_InputNode[i].DistanceTo(pt0_Node)*db0_Intersect/abs(db0_Intersect)
                    pt1_Node[len(pt1_Node)-1] = pt0_Node
                
        # Build Trail Edges
        ln1_TrailEdge = []
        cl1_TrailEdge = []
        db1_TrailEdge = []
                
        for i in range(int0_TrailNumber):
            ln0_TrailEdge = rh.Line(pt1_InputNode[i],pt1_Node[i])
            ln1_TrailEdge.append(ln0_TrailEdge)
            if db1_TrailLength[i] &gt; 0.0:
                cl1_TrailEdge.append(System.Drawing.Color.Red)
                db1_TrailEdge.append(vc1_TrailForceOut[i].Length)
            elif db1_TrailLength[i] &lt; 0.0:
                cl1_TrailEdge.append(System.Drawing.Color.Blue)
                db1_TrailEdge.append(-vc1_TrailForceOut[i].Length)
            else:
                cl1_TrailEdge.append(System.Drawing.Color.Black)
                db1_TrailEdge.append(0.0)
            #db1_TrailEdge.append(abs(vc1_TrailForceOut[i].Length))
        
        
        # Build Deviation Edges
        ln1_Deviation1Edge = []
        cl1_Deviation1Edge = []
        db1_Deviation1Edge = []
        k = 3
                
        for i in range(g*int0_TrailNumber,(g+1)*int0_TrailNumber):
            k += 1
            for j in range(k,int0_TrailNumber+3):
                if db2_StructuralBehaviour[i][j] != 0:
                    ln0_Deviation1Edge = rh.Line(pt1_InputNode[i % int0_TrailNumber],pt1_InputNode[j-3])
                    ln1_Deviation1Edge.append(ln0_Deviation1Edge)
                    if db2_StructuralBehaviour[i][j] &gt; 0.0:
                        cl1_Deviation1Edge.append(System.Drawing.Color.Red)
                    else:
                        cl1_Deviation1Edge.append(System.Drawing.Color.Blue)
                    #db1_Deviation1Edge.append(abs(db2_StructuralBehaviour[i][j]))
                    db1_Deviation1Edge.append(db2_StructuralBehaviour[i][j])
        vc2_GlobTrailForce.append(vc1_TrailForceOut)
        
        
        # Form Diagram
        ln2_GlobTrailEdge.append(ln1_TrailEdge)
        db2_GlobTrailEdge.append(db1_TrailEdge)
        cl2_GlobTrailEdge.append(cl1_TrailEdge)
        ln2_GlobDeviation1Edge.append(ln1_Deviation1Edge)
        cl2_GlobDeviation1Edge.append(cl1_Deviation1Edge)
        db2_GlobDeviation1Edge.append(db1_Deviation1Edge)
        ln2_GlobExtFOEdge.append(ln1_ExtFOEdge)
        cl2_GlobExtFOEdge.append(cl1_ExtFOEdge)
        db2_GlobExtFOEdge.append(db1_ExtFOEdge)
        pt2_GlobNode.append(pt1_Node)
        
        g += 1
            
    # Add Reactions to Form Diagram
    for i in range(len(vc2_GlobTrailForce[g-1])):
        if cl2_GlobTrailEdge[g-1][i] != System.Drawing.Color.Blue:
            ln1_ExtFOEdge.append(rh.Line(pt2_GlobNode[g-1][i],(pt2_GlobNode[g-1][i] + vc2_GlobTrailForce[g-1][i])))
            db1_ExtFOEdge.append(abs(ln1_ExtFOEdge[len(ln1_ExtFOEdge)-1].Length))
        else:
            ln1_ExtFOEdge.append(rh.Line((pt2_GlobNode[g-1][i] - vc2_GlobTrailForce[g-1][i]),pt2_GlobNode[g-1][i]))
            db1_ExtFOEdge.append(abs(ln1_ExtFOEdge[len(ln1_ExtFOEdge)-1].Length))
        cl1_ExtFOEdge.append(System.Drawing.Color.DarkGreen)
                
    # Update Counter
    int0_Counter += 1
            
            
    return
        
        
### MAIN FUNCTION
def Main(db1_StructuralBehaviour, str1_NodeOrderC, str1_Load, xx1_Bracing, pl1_ConstraintPlane, id_NodePlane, pt1_OriginNode, str1_Edge, db0_Divergence, db0_Threshold, int0_CounterBracing, int0_TrailNumber, int0_C, int0_R, db2_StructuralBehaviour, int0_LayerCount, db1_Variable, bl0_Print):
        
    ### GLOBAL VARIABLES
            
    global pt2_Trails
    global pt1_GlobNodeOut
    global ln1_GlobTrailEdgeOut
    global ln1_GlobDeviation1EdgeOut
    global ln1_GlobDeviation2EdgeOut
    global vc2_GlobTrailForce
    global ln2_GlobExtEdge
    global pt2_GlobNode
    global pt2_GlobNodeIteration
    global ln2_GlobTrailEdge
    global cl2_GlobTrailEdge
    global db2_GlobTrailEdge
    global ln2_GlobDeviation1Edge
    global cl2_GlobDeviation1Edge
    global db2_GlobDeviation1Edge
    global ln2_GlobDeviation2Edge
    global cl2_GlobDeviation2Edge
    global db2_GlobDeviation2Edge
    global ln2_GlobExtFOEdge
    global cl2_GlobExtFOEdge
    global db2_GlobExtFOEdge
    global int0_CounterOpt 
    global db0_DistanceBest
    global db1_VariableBest
    global str1_TrailEdgeID
    global str1_Dev1EdgeID
    global str1_Dev2EdgeID
    global int1_DevEdgeInputID
    global str0_GlobSolver
    global str0_GlobDivergence
    global str0_GlobIteration
    global str0_GlobLoadPath
            
            
    if bl0_Print:
        int0_CounterOpt += 1
        str0_DescriptionOpt = ""
        str0_DescriptionOpt += "\niteration: " + str(int0_CounterOpt)
            
    str0_GlobIteration = str(int0_CounterOpt)
            
            
    # Initialization of Nodes' Position
    for j in range(int0_LayerCount+1):
        pt1_GlobNodeIteration = []
        pt2_GlobNodeIteration.append(pt1_GlobNodeIteration)
            
            
    # Re-Inatialize Global Variables
    dbl0_Divergence = 0
    vc2_GlobTrailForce = []
    ln2_GlobExtEdge = []
    pt2_GlobNode = []
    ln2_GlobTrailEdge = []
    cl2_GlobTrailEdge = []
    db2_GlobTrailEdge = []
    ln2_GlobDeviation1Edge = []
    cl2_GlobDeviation1Edge = []
    db2_GlobDeviation1Edge = []
    ln2_GlobDeviation2Edge = []
    cl2_GlobDeviation2Edge = []
    db2_GlobDeviation2Edge = []
    ln2_GlobExtFOEdge = []
    cl2_GlobExtFOEdge = []
    db2_GlobExtFOEdge = []
            
            
    # Initial Check
    int0_StructuralLayersMatrix = int(len(db1_StructuralBehaviour)/(3+len(pt1_OriginNode)+1)/len(pt1_OriginNode))
    if db1_StructuralBehaviour == None or int0_StructuralLayersMatrix == 0:
        print(str("Please input Matrix of Structural Behaviour"))
        if len(pt1_OriginNode) == 0:
            print(str("Please input Origin Points"))
    else:
        if len(pt1_OriginNode) == 0:
            print(str("Please input Origin Points"))
        else:
            pt1_OriginNodeMod = [pt0_OriginNode for pt0_OriginNode in pt1_OriginNode]
                    
                    
            # Update Variables for Optimization
            if len(db1_Variable) &gt; 0:
                int0_CountVar = 0
                        
                for i in range(len(int2_Deviation1Edge)):
                    key1 = int2_Deviation1Edge[i][0] % int0_TrailNumber + 3
                    key0 = (int2_Deviation1Edge[i][0] // int0_TrailNumber)*int0_TrailNumber + int2_Deviation1Edge[i][1] - 3
                    db2_StructuralBehaviour[int2_Deviation1Edge[i][0]][int2_Deviation1Edge[i][1]] =  db1_Variable[int0_CountVar]
                    db2_StructuralBehaviour[key0][key1] = db1_Variable[int0_CountVar]
                    int0_CountVar += 1
                for i in range(len(int2_TrailEdge)):
                    db2_StructuralBehaviour[ int2_TrailEdge[i][0] ][ int2_TrailEdge[i][1]]  =  db1_Variable[int0_CountVar]
                    int0_CountVar += 1
                for i in range(2,len(xx1_Bracing),3):
                    xx1_Bracing[i] = db1_Variable[int0_CountVar]
                    int0_CountVar += 1
                for i in range(len(pt1_OriginNode)):
                    pt1_OriginNodeMod[i] = rh.Point3d(db1_Variable[int0_CountVar], pt1_OriginNode[i].Y, pt1_OriginNode[i].Z)
                    int0_CountVar += 1
                for i in range(len(pt1_OriginNode)):
                    pt1_OriginNodeMod[i] = rh.Point3d(pt1_OriginNodeMod[i].X, db1_Variable[int0_CountVar], pt1_OriginNode[i].Z)
                    int0_CountVar += 1
                for i in range(len(pt1_OriginNode)):
                    pt1_OriginNodeMod[i] = rh.Point3d(pt1_OriginNodeMod[i].X, pt1_OriginNodeMod[i].Y, db1_Variable[int0_CountVar])
                    int0_CountVar += 1
                            
                for i in range(len(str1_Load)):
                    dc2_ExtForce[str1_Load[i]][0] = db1_Variable[int0_CountVar]
                    dc2_ExtForce[str1_Load[i]][1] = db1_Variable[int0_CountVar + len(str1_Load)]
                    dc2_ExtForce[str1_Load[i]][2] = db1_Variable[int0_CountVar + 2*len(str1_Load)]
                    int0_CountVar += 1
                            
                dc2_ExtForceSum = {}
                for i in range(len(str1_Load)):
                            
                    key = dc2_ExtForce[str1_Load[i]][3]
                    if key not in dc2_ExtForceSum:
                        dc2_ExtForceSum[key] = [ dc2_ExtForce[str1_Load[i]][0], dc2_ExtForce[str1_Load[i]][1], dc2_ExtForce[str1_Load[i]][2] ]
                    else:
                        dc2_ExtForceSum[key][0] += dc2_ExtForce[str1_Load[i]][0]
                        dc2_ExtForceSum[key][1] += dc2_ExtForce[str1_Load[i]][1]
                        dc2_ExtForceSum[key][2] += dc2_ExtForce[str1_Load[i]][2]
                            
                for key in dc2_ExtForceSum:
                    int0_Row = int(str1_NodeOrder.index(key))
                    db2_StructuralBehaviour[int0_Row][0] = dc2_ExtForceSum[key][0]
                    db2_StructuralBehaviour[int0_Row][1] = dc2_ExtForceSum[key][1]
                    db2_StructuralBehaviour[int0_Row][2] = dc2_ExtForceSum[key][2]
                    int0_CountVar += 1
        
            # Start Iteration
            while int0_Counter &lt; int0_CounterBracing and db0_Divergence &gt; db0_Threshold:
        
                # Call Main Function
                Equilibrium(db1_StructuralBehaviour, xx1_Bracing, pt1_OriginNodeMod, pl1_ConstraintPlane)
                        
                # Store Nodes' Position
                # Here the original line was:
                # pt2_GlobNodeIteration[0] = pt1_OriginNode
                        
                pt2_GlobNodeIteration[0] = pt1_OriginNodeMod
                        
                for j in range(1,len(pt2_GlobNode)+1):
                    if int0_Counter-1 != 0:
                        db0_Divergence = 0
                        for k in range(len(pt2_GlobNode[j-1])):
                            db0_Divergence += pt2_GlobNode[j-1][k].DistanceTo(pt2_GlobNodeIteration[j][k])
                    pt2_GlobNodeIteration[j] = pt2_GlobNode[j-1]
                        
                if bl0_Print:
                    str0_Description = ""
                            
                    str0_Description += "sub-iteration: " + str(int0_Counter) + "\n"
                    if len(xx1_Bracing) == 0:
                        db0_Divergence = 0.00
                    str0_Description += "divergence: " + str(db0_Divergence)
                            
                    print str0_Description
        
                        
                if int0_Counter &lt; int0_CounterBracing and db0_Divergence &gt; db0_Threshold:
                    # Re-Inatialize Global Variables
                    dbl0_Divergence = 0
                    vc2_GlobTrailForce = []
                    ln2_GlobExtEdge = []
                    pt2_GlobNode = []
                    ln2_GlobTrailEdge = []
                    cl2_GlobTrailEdge = []
                    db2_GlobTrailEdge = []
                    ln2_GlobDeviation1Edge = []
                    cl2_GlobDeviation1Edge = []
                    db2_GlobDeviation1Edge = []
                    ln2_GlobDeviation2Edge = []
                    cl2_GlobDeviation2Edge = []
                    db2_GlobDeviation2Edge = []
                    ln2_GlobExtFOEdge = []
                    cl2_GlobExtFOEdge = []
                    db2_GlobExtFOEdge = []
            
                if int0_Counter == int0_CounterBracing or db0_Divergence &lt; db0_Threshold:
                            
                    # Add Bracing
                    ln1_Deviation2Edge = []
                    cl1_Deviation2Edge = []
                    db1_Deviation2Edge = []
                    for i in range(0,len(xx1_Bracing),3):
                        int0_BracingFromLayerIndex = int(xx1_Bracing[i]) // int0_TrailNumber
                        int0_BracingFromTrailIndex = int(xx1_Bracing[i]) % int0_TrailNumber
                        int0_BracingToLayerIndex = int(xx1_Bracing[i+1]) // int0_TrailNumber
                        int0_BracingToTrailIndex = int(xx1_Bracing[i+1]) % int0_TrailNumber
                        ln0_Deviation2Edge = rh.Line(pt2_GlobNodeIteration[int0_BracingFromLayerIndex][int0_BracingFromTrailIndex],pt2_GlobNodeIteration[int0_BracingToLayerIndex][int0_BracingToTrailIndex])
                        ln1_Deviation2Edge.append(ln0_Deviation2Edge)
                        if float(xx1_Bracing[i+2]) &gt; 0.0:
                            cl1_Deviation2Edge.append(System.Drawing.Color.Red)
                        elif float(xx1_Bracing[i+2]) &lt; 0.0:
                            cl1_Deviation2Edge.append(System.Drawing.Color.Blue)
                        else:
                            cl1_Deviation2Edge.append(System.Drawing.Color.Black)
                        db1_Deviation2Edge.append(xx1_Bracing[i+2])
                                
                                
                    ### OUTPUT
            
                    ln1_GlobExtEdgeOut = ListListToList(ln2_GlobExtEdge)
                    pt1_GlobNodeOut = ListListToList(pt2_GlobNodeIteration)
                    ln1_GlobTrailEdgeOut = ListListToList(ln2_GlobTrailEdge)
                    cl1_GlobTrailEdgeOut = ListListToList(cl2_GlobTrailEdge)
                    db1_GlobTrailEdgeOut = ListListToList(db2_GlobTrailEdge)
                    ln1_GlobDeviation1EdgeOut = ListListToList(ln2_GlobDeviation1Edge)
                    cl1_GlobDeviation1EdgeOut = ListListToList(cl2_GlobDeviation1Edge)
                    db1_GlobDeviation1EdgeOut = ListListToList(db2_GlobDeviation1Edge)
                    ln1_GlobDeviation2EdgeOut = ln1_Deviation2Edge
                    cl1_GlobDeviation2EdgeOut = cl1_Deviation2Edge
                    db1_GlobDeviation2EdgeOut = db1_Deviation2Edge
                    ln1_GlobDeviationEdgeOut = ln1_GlobDeviation1EdgeOut[:]
                    ln1_GlobDeviationEdgeOut.extend(ln1_GlobDeviation2EdgeOut)
                    str1_GlobDeviationEdgeOut = str1_Dev1EdgeID[:]
                    str1_GlobDeviationEdgeOut.extend(str1_Dev2EdgeID)
                    cl1_GlobDeviationEdgeOut = cl1_GlobDeviation1EdgeOut[:]
                    cl1_GlobDeviationEdgeOut.extend(cl1_GlobDeviation2EdgeOut)
                    db1_GlobDeviationEdgeOut = db1_GlobDeviation1EdgeOut[:]
                    db1_GlobDeviationEdgeOut.extend(db1_GlobDeviation2EdgeOut)
                    int1_DevEdgeInputSortID = int1_DevEdgeInputID[:]
                    if len(ln1_GlobDeviationEdgeOut) &gt; 0:
                        str1_GlobDeviationEdgeOut, ln1_GlobDeviationEdgeOut, cl1_GlobDeviationEdgeOut, db1_GlobDeviationEdgeOut = (list(t) for t in zip(*sorted(zip(str1_GlobDeviationEdgeOut, ln1_GlobDeviationEdgeOut, cl1_GlobDeviationEdgeOut, db1_GlobDeviationEdgeOut))))
                        int1_DevEdgeInputSortID, ln1_GlobDeviationEdgeOut, str1_GlobDeviationEdgeOut, cl1_GlobDeviationEdgeOut, db1_GlobDeviationEdgeOut = (list(t) for t in zip(*sorted(zip(int1_DevEdgeInputSortID, ln1_GlobDeviationEdgeOut, str1_GlobDeviationEdgeOut, cl1_GlobDeviationEdgeOut, db1_GlobDeviationEdgeOut))))
                    ln1_GlobExtFOEdgeOut = ListListToList(ln2_GlobExtFOEdge)
                    cl1_GlobExtFOEdgeOut = ListListToList(cl2_GlobExtFOEdge)
                    db1_GlobExtFOEdgeOut = ListListToList(db2_GlobExtFOEdge)
                            
                            
                    M.ln1_GlobExtEdgeOut = ln1_GlobExtEdgeOut
                    M.pt1_GlobNodeOut = pt1_GlobNodeOut[:len(str1_NodeOrderC)]
                    M.ln1_GlobTrailEdgeOut = ln1_GlobTrailEdgeOut[:len(str1_TrailEdgeID)]
                    M.str1_GlobTrailEdgeOut = str1_TrailEdgeID
                    M.cl1_GlobTrailEdgeOut = cl1_GlobTrailEdgeOut[:len(str1_TrailEdgeID)]
                    M.db1_GlobTrailEdgeOut = db1_GlobTrailEdgeOut[:len(str1_TrailEdgeID)]
                    M.ln1_GlobDeviation1EdgeOut = ln1_GlobDeviation1EdgeOut
                    M.str1_GlobDeviation1EdgeOut = str1_Dev1EdgeID
                    M.cl1_GlobDeviation1EdgeOut = cl1_GlobDeviation1EdgeOut
                    M.db1_GlobDeviation1EdgeOut = db1_GlobDeviation1EdgeOut
                    M.ln1_GlobDeviation2EdgeOut = ln1_GlobDeviation2EdgeOut
                    M.str1_GlobDeviation2EdgeOut = str1_Dev2EdgeID
                    M.cl1_GlobDeviation2EdgeOut = cl1_GlobDeviation2EdgeOut
                    M.db1_GlobDeviation2EdgeOut = db1_GlobDeviation2EdgeOut
                    M.ln1_GlobDeviationEdgeOut = ln1_GlobDeviationEdgeOut
                    M.str1_GlobDeviationEdgeOut = str1_GlobDeviationEdgeOut
                    M.cl1_GlobDeviationEdgeOut = cl1_GlobDeviationEdgeOut
                    M.db1_GlobDeviationEdgeOut = db1_GlobDeviationEdgeOut
                    M.ln1_GlobExtFOEdgeOut = ln1_GlobExtFOEdgeOut
                    M.cl1_GlobExtFOEdgeOut = cl1_GlobExtFOEdgeOut
                    M.db1_GlobExtFOEdgeOut = db1_GlobExtFOEdgeOut
                            
                    M.str1_NodeOrderOut = str1_NodeOrderC
                    M.str1_EdgeOut = str1_Edge
                    M.str1_ExtFOEdge = str1_ExtFOEdge
                    M.str1_SupportAux = str1_SupportAux
        
        
        
    global int0_Counter
    int0_Counter = 0
            
    db0_Distance = 0.0
        
    if targetNode and targetNodeID:
        db0_DistanceGeometry = 0.0
        for i in range(0,len(targetNodeID)): 
            if str(targetNodeID[i]) in str1_NodeOrderC:
                int0_IndexGlobNode = int(str1_NodeOrderC.index(str(targetNodeID[i])))
                pt0_GlobNode = pt2_GlobNode[int0_IndexGlobNode // int0_TrailNumber - 1][int0_IndexGlobNode % int0_TrailNumber]
                targetNode0 = pt0_GlobNode
                if isinstance(targetNode[i], rh.Curve):
                    targetNode0 = targetNode[i].PointAt( targetNode[i].ClosestPoint(pt0_GlobNode)[1] )
                elif isinstance(targetNode[i], rh.Brep) or isinstance(targetNode[i], rh.BrepFace):
                    targetNode[i] = rs.coercesurface(targetNode[i])
                    targetNode0 = targetNode[i].PointAt( targetNode[i].ClosestPoint(pt0_GlobNode)[1], targetNode[i].ClosestPoint(pt0_GlobNode)[2] )
                elif isinstance(targetNode[i], rh.Point3d):
                    targetNode0 = targetNode[i]
                db0_DistanceGeometry += targetNodeCoeff[i]*pt0_GlobNode.DistanceToSquared(targetNode0)
        db0_Distance += db0_DistanceGeometry
        
    if targetVector and targetVectorID:
        db0_DistanceVectorDir = 0.0
        db0_DistanceVectorMag = 0.0
        for i in range(0,len(targetVectorID)):
            if str(targetVectorID[i]) in str1_NodeOrderC:
                int0_IndexGlobNode = int(str1_NodeOrderC.index(str(targetVectorID[i])))
                vc0_GlobVector = vc2_GlobTrailForce[int0_IndexGlobNode // int0_TrailNumber][int0_IndexGlobNode % int0_TrailNumber]
                targetVector0 = vc0_GlobVector
                if isinstance(targetVector[i], rh.Vector3d):
                    targetVector0 = targetVector[i]
                db0_DistanceVectorMag += targetVectorCoeffMag[i]*(vc0_GlobVector.Length - targetVector0.Length)**2
                vc0_GlobVectorU = rh.Vector3d(vc0_GlobVector)
                targetVector0U = rh.Vector3d(targetVector0)
                vc0_GlobVectorU.Unitize()
                targetVector0U.Unitize()
                db0_DistanceVectorDir += targetVectorCoeffDir[i]*((1- abs(rh.Vector3d.Multiply(vc0_GlobVectorU,targetVector0U)))**2)
        db0_Distance += db0_DistanceVectorMag + db0_DistanceVectorDir
        
    if len(str1_SupportAux) &gt; 0:
        db0_DistanceVectorMag = 0.0
        for i in range(0,len(str1_SupportAux)):
            if str1_SupportAux[i] in str1_NodeOrderC:
                int0_IndexGlobNode = int(str1_NodeOrderC.index(str1_SupportAux[i]))
                vc0_GlobVector = vc2_GlobTrailForce[int0_IndexGlobNode // int0_TrailNumber][int0_IndexGlobNode % int0_TrailNumber]
                db0_DistanceVectorMag += 10*(vc0_GlobVector.Length)**2
        db0_Distance += db0_DistanceVectorMag
        
    # Calculate Absolute Total Load Path of the Structure
    db0_LoadPath = 0.0
    for i in range(len(ln2_GlobTrailEdge)):
        for j in range(len(ln2_GlobTrailEdge[i])):
            db0_LoadPath += ln2_GlobTrailEdge[i][j].Length*abs(db2_GlobTrailEdge[i][j])
    for i in range(len(ln2_GlobDeviation1Edge)):
        for j in range(len(ln2_GlobDeviation1Edge[i])):
            db0_LoadPath += ln2_GlobDeviation1Edge[i][j].Length*abs(db2_GlobDeviation1Edge[i][j])
    for i in range(len(ln2_GlobDeviation2Edge)):
        for j in range(len(ln2_GlobDeviation2Edge[i])):
            db0_LoadPath += ln2_GlobDeviation2Edge[i][j].Length*abs(db2_GlobDeviation2Edge[i][j])
    str0_GlobLoadPath = str(int(db0_LoadPath*1E5)/1E5) + " kNm"
            
    """
    # Calculate Total Load Path of the Structure
    for i in range(len(ln2_GlobExtFOEdge)):
        for j in range(len(ln2_GlobExtFOEdge[i])):
            pt0_ExtForce_B = ln2_GlobExtFOEdge[i][j].To
            pt0_ExtForce_A = ln2_GlobExtFOEdge[i][j].From
            vc0_ExtForce = rh.Vector3d(pt0_ExtForce_B - pt0_ExtForce_A)
            db0_LoadPath += rh.Vector3d.Multiply(vc0_ExtForce,-rh.Vector3d(pt0_ExtForce_A))
    db0_Distance = db0_LoadPath
    """
                
    if loadPath == True:
        db0_Distance += db0_LoadPath/100
        
    if bl0_Print:
        str0_DescriptionOpt += "\nobjective: " + str(db0_Distance)
        str0_DescriptionOpt += "\n\n\n "
        print str0_DescriptionOpt
            
    str0_GlobDivergence = str(int(db0_Distance*1E5)/1E5)
            
    if db0_Distance &lt; db0_DistanceBest:
        db0_DistanceBest = db0_Distance
        db1_VariableBest = db1_Variable
                
    return(db0_Distance)
        
pt2_Trails = []
        
        
M = model()
        
        
        
if TPC and hasattr(TPC,"db1_StructuralBehaviourOut"):
        
    vc2_GlobTrailForce = []
    ln2_GlobExtEdge = []
    pt2_GlobNode = []
    pt2_GlobNodeIteration = []
    ln2_GlobTrailEdge = []
    cl2_GlobTrailEdge = []
    db2_GlobTrailEdge = []
    ln2_GlobDeviation1Edge = []
    cl2_GlobDeviation1Edge = []
    db2_GlobDeviation1Edge = []
    ln2_GlobDeviation2Edge = []
    cl2_GlobDeviation2Edge = []
    db2_GlobDeviation2Edge = []
    ln2_GlobExtFOEdge = []
    cl2_GlobExtFOEdge = []
    db2_GlobExtFOEdge = []
            
            
    db1_StructuralBehaviour = TPC.db1_StructuralBehaviourOut
    str1_NodeOrderC = TPC.str1_NodeOrderOut
    xx1_Bracing = TPC.db1_DeviationIndirectOut
    pl1_ConstraintPlane = TPC.pl1_ConstraintPlaneOut
    id_NodePlane = TPC.int1_ConstraintPlaneOut
    pt1_OriginNode = TPC.pt1_OriginNodeOut
    dc2_ExtForce = TPC.dc2_ForceOut
    str1_Edge = TPC.str1_EdgeOut
            
    # Counters and Tolerance
    int0_Counter = 0
    db0_Divergence = float("inf")
    db0_Threshold = 1e-3
    int0_CounterBracing = 50
    db0_DistanceBest = float("inf")
    db1_VariableBest = []
        
    if len(xx1_Bracing) == 0: int0_CounterBracing = 1
        
    int0_TrailNumber = len(pt1_OriginNode)  # input nodes
    int0_C = 3+int0_TrailNumber+1
    int0_R = int(len(db1_StructuralBehaviour)/int0_C)
    db2_StructuralBehaviour = ListToListList(db1_StructuralBehaviour, int0_R, int0_C)
    int0_LayerCount = int(len(db2_StructuralBehaviour)/int0_TrailNumber) # amount of layers
            
            
    # Add labels external forces
            
    str1_ExtFOEdge = []
    int0_TrailAux = len(TPC.crv1_TrailAux)

    for i in range(len(str1_NodeOrder)):
        str1_ExtFOEdge.append("")
        
    str1_SupportAux = []
    for i in range(int0_TrailAux):
        str1_SupportAux.append( str(len(TPC.pt1_NodeOut) - int0_TrailAux +i) )
            
    if specWeight and yieldStress:
        for i in range(len(str1_NodeOrder)):
            if str1_NodeOrder[i][0] != "W" and str1_NodeOrder[i] not in str1_SupportAux:
                if len(str1_ExtFOEdge[i]) == 0:
                    str1_ExtFOEdge[i] = "G" + str1_NodeOrder[i]
                else:
                    str1_ExtFOEdge[i] = "G" + str1_NodeOrder[i] + "-" + str1_ExtFOEdge[i]

    str1_ExtFOReact = str1_ExtFOEdge[-int0_TrailNumber:]

            
    for i in range(len(str1_ExtFOReact)):
        if str1_ExtFOReact[i] == "":
            str1_ExtFOReactExt = str1_ExtFOEdge[-2*int0_TrailNumber:]
            str1_ExtFOReact[i] = str1_ExtFOReactExt[i]

    for i in range(len(str1_ExtFOReact)):
        str0_ExtFOReact = str1_ExtFOReact[i].split("-")[0]
        str0_ExtFOReact = str0_ExtFOReact.replace('G', 'R')
        str1_ExtFOReact[i] = str0_ExtFOReact

            
    for i in range( len(str1_NodeOrder)-int0_TrailNumber, len(str1_NodeOrder)):
        int0_NodeReact = i - (len(str1_NodeOrder)-int0_TrailNumber)
        if len(str1_ExtFOReact[ int0_NodeReact ]) == 0:
            int0_React = int(str1_NodeOrder[i]) - int0_TrailAux
            if "V" + str(int0_React) in TPC.str1_OriginNodeOut:
                str1_ExtFOReact[ int0_NodeReact ] = "R" + str(int0_React)
            else:
                str1_ExtFOReact[ int0_NodeReact ] = "R" + str1_NodeOrder[i]

    for key in dc2_ExtForce:
        i = int( str1_NodeOrder.index((dc2_ExtForce[key][3])) )
        if str1_ExtFOEdge[i] == "":  
            str1_ExtFOEdge[i] = "L" + key
        else:
            str1_ExtFOEdge[i] += "-" + "L" + key

    str1_ExtFOEdge.extend(str1_ExtFOReact)
            
        
            
    # Variables for Optimization
            
    # Deviation 1
    int2_Deviation1Edge = []
    db1_Deviation1Edge = []
    for g in range(int0_LayerCount):
        k = 3
        for i in range(g*int0_TrailNumber,(g+1)*int0_TrailNumber):
            k += 1
            for j in range(k,int0_TrailNumber+3):
                if db2_StructuralBehaviour[i][j] != 0:
                    int2_Deviation1Edge.append((i,j))
                    db1_Deviation1Edge.append(db2_StructuralBehaviour[i][j])
    # Trail
    int2_TrailEdge = []
    db1_TrailEdge = []
    for g in range(int0_LayerCount-1):
        for i in range(int0_TrailNumber):
            int2_TrailEdge.append([g*int0_TrailNumber + i,int0_TrailNumber+3]) 
            db1_TrailEdge.append(db2_StructuralBehaviour[g*int0_TrailNumber + i][int0_TrailNumber+3])
        
    # Deviation 2
    db1_Deviation2Edge = []
    for i in range(2,len(xx1_Bracing),3):
        db1_Deviation2Edge.append(xx1_Bracing[i])
        
    # Origin Nodes
    db1_OriginNodeX = [pt0_OriginNode.X for pt0_OriginNode in pt1_OriginNode]
    db1_OriginNodeY = [pt0_OriginNode.Y for pt0_OriginNode in pt1_OriginNode]
    db1_OriginNodeZ = [pt0_OriginNode.Z for pt0_OriginNode in pt1_OriginNode]
        
    # Loads
    str1_Load = []
    db1_LoadX = []
    db1_LoadY = []
    db1_LoadZ = []
    for key in dc2_ExtForce:
        str1_Load.append(key)
        db1_LoadX.append(dc2_ExtForce[key][0])
        db1_LoadY.append(dc2_ExtForce[key][1])
        db1_LoadZ.append(dc2_ExtForce[key][2])
        
        
    int0_CounterOpt = 0
    print "Iteration report\n\n "
        
    # Calculate gradient
    def Grad(var, grad):
        if grad:
            global db0_Dx
            fX_0 = Main(db1_StructuralBehaviour, str1_NodeOrderC, str1_Load, xx1_Bracing, pl1_ConstraintPlane, id_NodePlane, pt1_OriginNode, str1_Edge, db0_Divergence, db0_Threshold, int0_CounterBracing, int0_TrailNumber, int0_C, int0_R, db2_StructuralBehaviour, int0_LayerCount, var, False)
            for i in range(len(var)):
                varDx = var[:]
                varDx[i] += db0_Dx
                if db1_BoundUp[i] != db1_BoundLow[i]:
                    fX_1 = Main(db1_StructuralBehaviour, str1_NodeOrderC, str1_Load, xx1_Bracing, pl1_ConstraintPlane, id_NodePlane, pt1_OriginNode, str1_Edge, db0_Divergence, db0_Threshold, int0_CounterBracing, int0_TrailNumber, int0_C, int0_R, db2_StructuralBehaviour, int0_LayerCount, varDx, False)
                    dfX_1 = (fX_1 - fX_0) / db0_Dx
                else: dfX_1 = 0.0 
                grad[i] = dfX_1
        out = Main(db1_StructuralBehaviour, str1_NodeOrderC, str1_Load, xx1_Bracing, pl1_ConstraintPlane, id_NodePlane, pt1_OriginNode, str1_Edge, db0_Divergence, db0_Threshold, int0_CounterBracing, int0_TrailNumber, int0_C, int0_R, db2_StructuralBehaviour, int0_LayerCount, var, True)
        return out
        
    # Optimization function
    def Optimization(db1_InitialValues, db1_BoundUp, db1_BoundLow, db0_T, int0_I, nl0_Algo):
        solver = nl.NLoptSolver(nl0_Algo, len(db1_InitialValues), db0_T, int0_I)
        solver.SetLowerBounds(Array[float]( db1_BoundLow ))
        solver.SetUpperBounds(Array[float]( db1_BoundUp ))
        solver.SetMinObjective.Overloads[Func[Array[float], Array[float], float]](Grad)
        initialValue = Array[float](db1_InitialValues)
        out, finalScore = solver.Optimize(initialValue)
        return finalScore
            
    global str0_GlobSolver
    str0_GlobSolver = "None"
            
    if O and (hasattr(O, "targetNode") and hasattr(O, "targetNodeID") or hasattr(O, "targetVector") and hasattr(O, "targetVectorID") or len(str1_SupportAux) &gt; 0 or loadPath == True):
        int1_T_ID = O.boundsTrailID
        db1_T_Up = O.boundsTrailUp
        db1_T_Low = O.boundsTrailLow
                
        int1_D_ID = O.boundsDevID
        db1_D_Up = O.boundsDevUp
        db1_D_Low = O.boundsDevLow
        
        int1_O_ID = O.boundsOriginNodeID
        db1_O_UpX = O.boundsOriginNodeUpX 
        db1_O_LowX = O.boundsOriginNodeLowX
        db1_O_UpY = O.boundsOriginNodeUpY
        db1_O_LowY = O.boundsOriginNodeLowY
        db1_O_UpZ = O.boundsOriginNodeUpZ
        db1_O_LowZ = O.boundsOriginNodeLowZ
        
        int1_L_ID = O.boundsLoadID
        db1_L_UpX = O.boundsLoadUpX 
        db1_L_LowX = O.boundsLoadLowX
        db1_L_UpY = O.boundsLoadUpY
        db1_L_LowY = O.boundsLoadLowY
        db1_L_UpZ = O.boundsLoadUpZ
        db1_L_LowZ = O.boundsLoadLowZ
        
        global db0_Dx
        db0_Dx = O.gradientDelta
        db0_T = O.relativeTolerance
        int0_I = O.maxIterations
        str0_A = O.optimAlgorithm
        str0_GlobSolver = str0_A
        
        dc1_Algo = {"LD_SLSQP" : nl.NLoptAlgorithm.LD_SLSQP,
                    "LN_BOBYQA" : nl.NLoptAlgorithm.LN_BOBYQA,
                    "GD_MLSL" : nl.NLoptAlgorithm.GD_MLSL,
                    "LD_LBFGS" : nl.NLoptAlgorithm.LD_LBFGS,
                    "LD_AUGLAG" : nl.NLoptAlgorithm.LD_AUGLAG,
                    "LN_SBPLX" : nl.NLoptAlgorithm.LN_SBPLX,
                    "LN_COBYLA" : nl.NLoptAlgorithm.LN_COBYLA,
                    "LD_TNEWTON" : nl.NLoptAlgorithm.LD_TNEWTON,
                    "GN_ISRES" : nl.NLoptAlgorithm.GN_ISRES,
                    "GN_MLSL" : nl.NLoptAlgorithm.GN_MLSL}
        
        
        db1_TrailBoundUp = db1_TrailEdge[:]
        for i in range(len(int1_T_ID)):
            if str(int1_T_ID[i]) in str1_TrailEdgeID: db1_TrailBoundUp[ str1_TrailEdgeID.index(str(int1_T_ID[i])) ] += db1_T_Up[i]
        
        db1_TrailBoundLow = db1_TrailEdge[:]
        for i in range(len(int1_T_ID)):
            if str(int1_T_ID[i]) in str1_TrailEdgeID: db1_TrailBoundLow[ str1_TrailEdgeID.index(str(int1_T_ID[i])) ] += db1_T_Low[i]
        
        
        db1_Deviation1BoundUp = db1_Deviation1Edge[:]
        for i in range(len(int1_D_ID)):
            if str(int1_D_ID[i]) in str1_Dev1EdgeID: db1_Deviation1BoundUp[ str1_Dev1EdgeID.index(str(int1_D_ID[i])) ] += db1_D_Up[i]
        
        db1_Deviation1BoundLow = db1_Deviation1Edge[:]
        for i in range(len(int1_D_ID)):
           if str(int1_D_ID[i]) in str1_Dev1EdgeID: db1_Deviation1BoundLow[ str1_Dev1EdgeID.index(str(int1_D_ID[i])) ] += db1_D_Low[i]
        
        db1_Deviation2BoundUp = db1_Deviation2Edge[:]
        for i in range(len(int1_D_ID)):
            if str(int1_D_ID[i]) in str1_Dev2EdgeID: db1_Deviation2BoundUp[ str1_Dev2EdgeID.index(str(int1_D_ID[i])) ] += db1_D_Up[i]
        
        db1_Deviation2BoundLow = db1_Deviation2Edge[:]
        for i in range(len(int1_D_ID)):
            if str(int1_D_ID[i]) in str1_Dev2EdgeID: db1_Deviation2BoundLow[ str1_Dev2EdgeID.index(str(int1_D_ID[i])) ] += db1_D_Low[i]
        
        
        str1_OriginNode = str1_NodeOrderC[:len(pt1_OriginNode)]
        for i in range(len(str1_OriginNode)):
            str1_OriginNode[i] = str1_OriginNode[i].replace("L","")
                
        db1_OriginNodeXBoundUp = db1_OriginNodeX[:]
        for i in range(len(int1_O_ID)):
            if str(int1_O_ID[i]) in str1_OriginNode: db1_OriginNodeXBoundUp[ str1_OriginNode.index(str(int1_O_ID[i])) ] += db1_O_UpX[i]
                
        db1_OriginNodeXBoundLow = db1_OriginNodeX[:]
        for i in range(len(int1_O_ID)):
            if str(int1_O_ID[i]) in str1_OriginNode: db1_OriginNodeXBoundLow[ str1_OriginNode.index(str(int1_O_ID[i])) ] += db1_O_LowX[i]
                
        db1_OriginNodeYBoundUp = db1_OriginNodeY[:]
        for i in range(len(int1_O_ID)):
            if str(int1_O_ID[i]) in str1_OriginNode: db1_OriginNodeYBoundUp[ str1_OriginNode.index(str(int1_O_ID[i])) ] += db1_O_UpY[i]
                
        db1_OriginNodeYBoundLow = db1_OriginNodeY[:]
        for i in range(len(int1_O_ID)):
            if str(int1_O_ID[i]) in str1_OriginNode: db1_OriginNodeYBoundLow[ str1_OriginNode.index(str(int1_O_ID[i])) ] += db1_O_LowY[i]
                
        db1_OriginNodeZBoundUp = db1_OriginNodeZ[:]
        for i in range(len(int1_O_ID)):
            if str(int1_O_ID[i]) in str1_OriginNode: db1_OriginNodeZBoundUp[ str1_OriginNode.index(str(int1_O_ID[i])) ] += db1_O_UpZ[i]
                
        db1_OriginNodeZBoundLow = db1_OriginNodeZ[:]
        for i in range(len(int1_O_ID)):
            if str(int1_O_ID[i]) in str1_OriginNode: db1_OriginNodeZBoundLow[ str1_OriginNode.index(str(int1_O_ID[i])) ] += db1_O_LowZ[i]
        
        
        db1_LoadXBoundUp = db1_LoadX[:]
        for i in range(len(int1_L_ID)):
            if str(int1_L_ID[i]) in str1_Load: db1_LoadXBoundUp[ str1_Load.index( str(int1_L_ID[i])) ] += db1_L_UpX[i]
                
        db1_LoadXBoundLow = db1_LoadX[:]
        for i in range(len(int1_L_ID)):
            if str(int1_L_ID[i]) in str1_Load: db1_LoadXBoundLow[ str1_Load.index( str(int1_L_ID[i])) ] += db1_L_LowX[i]
                
        db1_LoadYBoundUp = db1_LoadY[:]
        for i in range(len(int1_L_ID)):
            if str(int1_L_ID[i]) in str1_Load: db1_LoadYBoundUp[ str1_Load.index( str(int1_L_ID[i])) ] += db1_L_UpY[i]
                
        db1_LoadYBoundLow = db1_LoadY[:]
        for i in range(len(int1_L_ID)):
            if str(int1_L_ID[i]) in str1_Load: db1_LoadYBoundLow[ str1_Load.index( str(int1_L_ID[i])) ] += db1_L_LowY[i]
                
        db1_LoadZBoundUp = db1_LoadZ[:]
        for i in range(len(int1_L_ID)):
            if str(int1_L_ID[i]) in str1_Load: db1_LoadZBoundUp[ str1_Load.index( str(int1_L_ID[i])) ] += db1_L_UpZ[i]
                
        db1_LoadZBoundLow = db1_LoadZ[:]
        for i in range(len(int1_L_ID)):
            if str(int1_L_ID[i]) in str1_Load: db1_LoadZBoundLow[ str1_Load.index( str(int1_L_ID[i])) ] += db1_L_LowZ[i]
        
        
        # Define Initial Values for Optimization
        db1_InitialValues = []
        db1_InitialValues = db1_Deviation1Edge[:]
        db1_InitialValues.extend(db1_TrailEdge[:])
        db1_InitialValues.extend(db1_Deviation2Edge[:])
        db1_InitialValues.extend(db1_OriginNodeX[:])
        db1_InitialValues.extend(db1_OriginNodeY[:])
        db1_InitialValues.extend(db1_OriginNodeZ[:])
        db1_InitialValues.extend(db1_LoadX[:])
        db1_InitialValues.extend(db1_LoadY[:])
        db1_InitialValues.extend(db1_LoadZ[:])
                
        # Define Bounds for Optimization
        db1_BoundUp = []
        db1_BoundUp = db1_Deviation1BoundUp[:]
        db1_BoundUp.extend(db1_TrailBoundUp[:])
        db1_BoundUp.extend(db1_Deviation2BoundUp[:])
        db1_BoundUp.extend(db1_OriginNodeXBoundUp[:])
        db1_BoundUp.extend(db1_OriginNodeYBoundUp[:])
        db1_BoundUp.extend(db1_OriginNodeZBoundUp[:])
        db1_BoundUp.extend(db1_LoadXBoundUp[:])
        db1_BoundUp.extend(db1_LoadYBoundUp[:])
        db1_BoundUp.extend(db1_LoadZBoundUp[:])
        db1_BoundLow = []
        db1_BoundLow = db1_Deviation1BoundLow[:]
        db1_BoundLow.extend(db1_TrailBoundLow[:])
        db1_BoundLow.extend(db1_Deviation2BoundLow[:])
        db1_BoundLow.extend(db1_OriginNodeXBoundLow[:])
        db1_BoundLow.extend(db1_OriginNodeYBoundLow[:])
        db1_BoundLow.extend(db1_OriginNodeZBoundLow[:])
        db1_BoundLow.extend(db1_LoadXBoundLow[:])
        db1_BoundLow.extend(db1_LoadYBoundLow[:])
        db1_BoundLow.extend(db1_LoadZBoundLow[:])
        
        Optimization(db1_InitialValues, db1_BoundUp, db1_BoundLow, db0_T, int0_I, dc1_Algo[str0_A])
                
        Main(db1_StructuralBehaviour, str1_NodeOrderC, str1_Load, xx1_Bracing, pl1_ConstraintPlane, id_NodePlane, pt1_OriginNode, str1_Edge, db0_Divergence, db0_Threshold, int0_CounterBracing, int0_TrailNumber, int0_C, int0_R, db2_StructuralBehaviour, int0_LayerCount, db1_VariableBest, True)
    else:
        Main(db1_StructuralBehaviour, str1_NodeOrderC, str1_Load, xx1_Bracing, pl1_ConstraintPlane, id_NodePlane, pt1_OriginNode, str1_Edge, db0_Divergence, db0_Threshold, int0_CounterBracing, int0_TrailNumber, int0_C, int0_R, db2_StructuralBehaviour, int0_LayerCount, [], True)
        
</item>
                    <item name="Description" type_name="gh_string" type_code="10">Calculate the structural model</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>1912</X>
                      <Y>-8</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1936</W>
                      <H>1216</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">d0445907-ea21-4eed-853b-5e4cea0064d8</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">Python Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Calculate_Structure_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="3">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>2286</X>
                          <Y>1302</Y>
                          <W>79</W>
                          <H>104</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>2328</X>
                          <Y>1354</Y>
                        </item>
                        <item name="Selected" type_name="gh_bool" type_code="1">true</item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="8">
                        <item name="InputCount" type_name="gh_int32" type_code="3">5</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="2" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="3" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="4" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="6">
                        <chunk name="InputParam" index="0">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(topological diagram) The topological diagram used for the calculation of the structural model</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">c1de667e-8d57-430d-a120-4f33a446d672</item>
                            <item name="Name" type_name="gh_string" type_code="10">TP</item>
                            <item name="NickName" type_name="gh_string" type_code="10">TP</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">f424fef5-cffe-4250-ac8f-9c19d0df4fc1</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">87f87f55-5b71-41f4-8aea-21d494016f81</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="3">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2288</X>
                                  <Y>1304</Y>
                                  <W>25</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2302</X>
                                  <Y>1314</Y>
                                </item>
                                <item name="Selected" type_name="gh_bool" type_code="1">true</item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(constraintPlaneObject) The constraint planes and their Indices</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">c10e8340-ae1f-4904-bef4-041eeebe4260</item>
                            <item name="Name" type_name="gh_string" type_code="10">CPL</item>
                            <item name="NickName" type_name="gh_string" type_code="10">CPL</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">fe893ee9-9ff4-4996-8fc3-49d75dad4da8</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="3">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2288</X>
                                  <Y>1324</Y>
                                  <W>25</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2302</X>
                                  <Y>1334</Y>
                                </item>
                                <item name="Selected" type_name="gh_bool" type_code="1">true</item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="2">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(originnodeObject) The origin nodes and their Indices</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">fbee9128-982b-4d48-8deb-afb46053a912</item>
                            <item name="Name" type_name="gh_string" type_code="10">N</item>
                            <item name="NickName" type_name="gh_string" type_code="10">N</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">ed6f0ae9-eed8-4917-9d07-39feb0e56262</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="3">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2288</X>
                                  <Y>1344</Y>
                                  <W>25</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2302</X>
                                  <Y>1354</Y>
                                </item>
                                <item name="Selected" type_name="gh_bool" type_code="1">true</item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="3">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(selfWeightObject) The Activation of self weight of the structure and their yield stress and specific weight attributes</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">05f6025f-097f-4206-9ba7-1ae2168a7ffd</item>
                            <item name="Name" type_name="gh_string" type_code="10">SW</item>
                            <item name="NickName" type_name="gh_string" type_code="10">SW</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">ea66d6c1-2e43-435b-8373-c1b8e49a3d87</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="3">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2288</X>
                                  <Y>1364</Y>
                                  <W>25</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2302</X>
                                  <Y>1374</Y>
                                </item>
                                <item name="Selected" type_name="gh_bool" type_code="1">true</item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="4">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(optimizationObject) The Settings for an Optimization that can be performed </item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">28fce303-861f-4a52-b218-c23f81f8db7c</item>
                            <item name="Name" type_name="gh_string" type_code="10">O</item>
                            <item name="NickName" type_name="gh_string" type_code="10">O</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">65e25d58-9652-46e4-825a-9c904652f6fd</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="3">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2288</X>
                                  <Y>1384</Y>
                                  <W>25</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2302</X>
                                  <Y>1394</Y>
                                </item>
                                <item name="Selected" type_name="gh_bool" type_code="1">true</item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(structural model) The calculated structural model (empty model on error)</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">e0d07d91-702a-4374-8b7e-f3e6e5c497b3</item>
                            <item name="Name" type_name="gh_string" type_code="10">M</item>
                            <item name="NickName" type_name="gh_string" type_code="10">M</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="3">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>2343</X>
                                  <Y>1304</Y>
                                  <W>20</W>
                                  <H>100</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>2353</X>
                                  <Y>1354</Y>
                                </item>
                                <item name="Selected" type_name="gh_bool" type_code="1">true</item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="21">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">2e78987b-9dfb-42a2-8b76-3923ac8bd91a</item>
                <item name="Name" type_name="gh_string" type_code="10">Boolean Toggle</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="7">
                    <item name="Description" type_name="gh_string" type_code="10">Boolean (true/false) toggle</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">dfd879d9-09e1-493f-87b6-4225b6657c7b</item>
                    <item name="Name" type_name="gh_string" type_code="10">Boolean Toggle</item>
                    <item name="NickName" type_name="gh_string" type_code="10">Toggle</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                    <item name="ToggleValue" type_name="gh_bool" type_code="1">true</item>
                  </items>
                  <chunks count="1">
                    <chunk name="Attributes">
                      <items count="1">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>2239</Y>
                          <W>104</W>
                          <H>22</H>
                        </item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="22">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">70484985-959a-4db7-a19e-cff190dfe7d9</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10">boundsCoefficientOriginNode</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1241</X>
                          <Y>1504</Y>
                          <W>285</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1241.187</X>
                          <Y>1504.386</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">2</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">1000</item>
                        <item name="Min" type_name="gh_double" type_code="6">0</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">0.2</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="23">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Assign bounds to origin nodes
    Inputs:
        boundOriginNodeID: (string) The origin nodes ID that are allowed to move
        boundUpOriginNodeX: (float) The upper bound distance in X-direction [m]
        boundLowOriginNodeX: (float) The lower bound distance in X-direction [m]
        boundUpOriginNodeY: (float) The upper bound distance in Y-direction [m]
        boundLowOriginNodeY: (float) The lower bound distance in Y-direction [m]
        boundUpOriginNodeZ: (float) The upper bound distance in Z-direction [m]
        boundLowOriginNodeZ: (float) The lower bound distance in Z-direction [m]
    Outputs:
        BO: (Bounds Origin Nodes) The bounds for the origin nodes.
    Remarks:
        This generates a new instance of bounds for the origin nodes for the optimization
"""

__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""



import Rhino


class BoundOriginNode(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        if boundOriginNodeID and boundOriginNodeID[0] is not None:
            return "Bound Origin Nodes"
        else:
            return "Bound Origin Nodes not defined"


BO = BoundOriginNode()
BO.ID = []
BO.UpX = []
BO.LowX = []
BO.UpY = []
BO.LowY = []
BO.UpZ = []
BO.LowZ = []

if boundOriginNodeID and boundOriginNodeID[0] is not None:
    boundOriginNodeID = [ int(originNodeID[1:]) for originNodeID in boundOriginNodeID]
    if len(boundOriginNodeID) == len(boundUpOriginNodeX) and len(boundOriginNodeID) == len(boundLowOriginNodeX):
        BO.ID = boundOriginNodeID
        BO.UpX = [abs(boundUpOriginNodeX_i) for boundUpOriginNodeX_i in boundUpOriginNodeX]
        BO.LowX = [-abs(boundLowOriginNodeX_i) for boundLowOriginNodeX_i in boundLowOriginNodeX]
    elif len(boundUpOriginNodeX) == 1 and len(boundLowOriginNodeX) == 1:
        boundUpOriginNodeXC = []
        for i in range(len(boundOriginNodeID)):
            boundUpOriginNodeXC.append(abs(boundUpOriginNodeX[0]))
        boundLowOriginNodeXC = []
        for i in range(len(boundOriginNodeID)):
            boundLowOriginNodeXC.append(-abs(boundLowOriginNodeX[0]))
        BO.ID = boundOriginNodeID
        BO.UpX = boundUpOriginNodeXC
        BO.LowX = boundLowOriginNodeXC
    else:
        boundUpOriginNodeXC = []
        for i in range(len(boundOriginNodeID)):
            boundUpOriginNodeXC.append(0.0)
        boundLowOriginNodeXC = []
        for i in range(len(boundOriginNodeID)):
            boundLowOriginNodeXC.append(0.0)
        BO.ID = boundOriginNodeID
        BO.UpX = boundUpOriginNodeXC
        BO.LowX = boundLowOriginNodeXC

    if len(boundOriginNodeID) == len(boundUpOriginNodeY) and len(boundOriginNodeID) == len(boundLowOriginNodeY):
        BO.ID = boundOriginNodeID
        BO.UpY = [abs(boundUpOriginNodeY_i) for boundUpOriginNodeY_i in boundUpOriginNodeY]
        BO.LowY = [-abs(boundLowOriginNodeY_i) for boundLowOriginNodeY_i in boundLowOriginNodeY]
    elif len(boundUpOriginNodeY) == 1 and len(boundLowOriginNodeY) == 1:
        boundUpOriginNodeYC = []
        for i in range(len(boundOriginNodeID)):
            boundUpOriginNodeYC.append(abs(boundUpOriginNodeY[0]))
        boundLowOriginNodeYC = []
        for i in range(len(boundOriginNodeID)):
            boundLowOriginNodeYC.append(-abs(boundLowOriginNodeY[0]))
        BO.ID = boundOriginNodeID
        BO.UpY = boundUpOriginNodeYC
        BO.LowY = boundLowOriginNodeYC
    else:
        boundUpOriginNodeYC = []
        for i in range(len(boundOriginNodeID)):
            boundUpOriginNodeYC.append(0.0)
        boundLowOriginNodeYC = []
        for i in range(len(boundOriginNodeID)):
            boundLowOriginNodeYC.append(0.0)
        BO.ID = boundOriginNodeID
        BO.UpY = boundUpOriginNodeYC
        BO.LowY = boundLowOriginNodeYC

    if len(boundOriginNodeID) == len(boundUpOriginNodeZ) and len(boundOriginNodeID) == len(boundLowOriginNodeZ):
        BO.ID = boundOriginNodeID
        BO.UpZ = [abs(boundUpOriginNodeZ_i) for boundUpOriginNodeZ_i in boundUpOriginNodeZ]
        BO.LowZ = [-abs(boundLowOriginNodeZ_i) for boundLowOriginNodeZ_i in boundLowOriginNodeZ]
    elif len(boundUpOriginNodeZ) == 1 and len(boundLowOriginNodeZ) == 1:
        boundUpOriginNodeZC = []
        for i in range(len(boundOriginNodeID)):
            boundUpOriginNodeZC.append(abs(boundUpOriginNodeZ[0]))
        boundLowOriginNodeZC = []
        for i in range(len(boundOriginNodeID)):
            boundLowOriginNodeZC.append(-abs(boundLowOriginNodeZ[0]))
        BO.ID = boundOriginNodeID
        BO.UpZ = boundUpOriginNodeZC
        BO.LowZ = boundLowOriginNodeZC
    else:
        boundUpOriginNodeZC = []
        for i in range(len(boundOriginNodeID)):
            boundUpOriginNodeZC.append(0.0)
        boundLowOriginNodeZC = []
        for i in range(len(boundOriginNodeID)):
            boundLowOriginNodeZC.append(0.0)
        BO.ID = boundOriginNodeID
        BO.UpZ = boundUpOriginNodeZC
        BO.LowZ = boundLowOriginNodeZC
        
else:
    boundUpOriginNodeXC = []
    for i in range(len(boundOriginNodeID)):
        boundUpOriginNodeXC.append(0.0)
    boundLowOriginNodeXC = []
    for i in range(len(boundOriginNodeID)):
        boundLowOriginNodeXC.append(0.0)
    boundUpOriginNodeYC = []
    for i in range(len(boundOriginNodeID)):
        boundUpOriginNodeYC.append(0.0)
    boundLowOriginNodeYC = []
    for i in range(len(boundOriginNodeID)):
        boundLowOriginNodeYC.append(0.0)
    boundUpOriginNodeZC = []
    for i in range(len(boundOriginNodeID)):
        boundUpOriginNodeZC.append(0.0)
    boundLowOriginNodeZC = []
    for i in range(len(boundOriginNodeID)):
        boundLowOriginNodeZC.append(0.0)
    BO.ID = boundOriginNodeID
    BO.UpX = boundUpOriginNodeXC
    BO.LowX = boundLowOriginNodeXC
    BO.UpY = boundUpOriginNodeYC
    BO.LowY = boundLowOriginNodeYC
    BO.UpZ = boundUpOriginNodeZC
    BO.LowZ = boundLowOriginNodeZC</item>
                    <item name="Description" type_name="gh_string" type_code="10">Assign bounds to origin nodes</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>208</X>
                      <Y>208</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1821</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">3c9ae2af-49b7-475a-b179-8dbf58757e89</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Bound_Origin_Node_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1621</X>
                          <Y>1454</Y>
                          <W>197</W>
                          <H>144</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1776</X>
                          <Y>1526</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="10">
                        <item name="InputCount" type_name="gh_int32" type_code="3">7</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="2" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="3" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="4" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="5" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="6" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="8">
                        <chunk name="InputParam" index="0">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(string) The origin nodes ID that are allowed to move</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">e45182d1-1088-4bf5-99ce-a5dcbe3e6f39</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundOriginNodeID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundOriginNodeID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">441133c2-e05b-449f-918a-77aad1252fc9</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">37261734-eec7-4f50-b6a8-b8d1f3c4396b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1623</X>
                                  <Y>1456</Y>
                                  <W>138</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1701.5</X>
                                  <Y>1466</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The upper bound distance in X-direction [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">aea1b357-7b9a-4837-b803-4647f3facc79</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundUpOriginNodeX</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundUpOriginNodeX</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">70484985-959a-4db7-a19e-cff190dfe7d9</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1623</X>
                                  <Y>1476</Y>
                                  <W>138</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1701.5</X>
                                  <Y>1486</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="2">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The lower bound distance in X-direction [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">742d5975-f598-4815-ac5c-7b32ed798644</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundLowOriginNodeX</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundLowOriginNodeX</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">70484985-959a-4db7-a19e-cff190dfe7d9</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1623</X>
                                  <Y>1496</Y>
                                  <W>138</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1701.5</X>
                                  <Y>1506</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="3">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The upper bound distance in Y-direction [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">41472cf5-7f0a-429d-99be-860b7292c16c</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundUpOriginNodeY</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundUpOriginNodeY</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">70484985-959a-4db7-a19e-cff190dfe7d9</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1623</X>
                                  <Y>1516</Y>
                                  <W>138</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1701.5</X>
                                  <Y>1526</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="4">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The lower bound distance in Y-direction [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">bdd6432b-6075-4471-9bef-f76b56d9069b</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundLowOriginNodeY</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundLowOriginNodeY</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">70484985-959a-4db7-a19e-cff190dfe7d9</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1623</X>
                                  <Y>1536</Y>
                                  <W>138</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1701.5</X>
                                  <Y>1546</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="5">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The upper bound distance in Z-direction [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">c99ae806-a5b3-4d8b-88b9-b0c9016834c3</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundUpOriginNodeZ</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundUpOriginNodeZ</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">ec8b6f04-8757-407a-9e54-2a27426729e0</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1623</X>
                                  <Y>1556</Y>
                                  <W>138</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1701.5</X>
                                  <Y>1566</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="6">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The lower bound distance in Z-direction [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">8d7e061e-f24e-4e59-b39d-9c7c5f8ec98a</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundLowOriginNodeZ</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundLowOriginNodeZ</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">ec8b6f04-8757-407a-9e54-2a27426729e0</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1623</X>
                                  <Y>1576</Y>
                                  <W>138</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1701.5</X>
                                  <Y>1586</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(Bounds Origin Nodes) The bounds for the origin nodes.</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">4cd3d1e7-61b5-4a80-8226-f4a0ad9005c4</item>
                            <item name="Name" type_name="gh_string" type_code="10">BO</item>
                            <item name="NickName" type_name="gh_string" type_code="10">BO</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1791</X>
                                  <Y>1456</Y>
                                  <W>25</W>
                                  <H>140</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1803.5</X>
                                  <Y>1526</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="24">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Assign targets
    Inputs:
        targetNode: (Point3D or Line or Surface) Describes the desired location of a node in the form diagram
        targetNodeID: (string) The corresponding node ID
        targeNodeCoeff: (float) The weight factors for matching target nodes
    Outputs:
        TN: (Targets) The assigned targets, their ID and weights.
    Remarks:
        This generates a new instance of targets for the optimization
"""


__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""



import Rhino


class TargetOptNode(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        bl0_targetNode = False
        if targetNode and targetNodeID and targetNodeID[0] is not None and len(targetNode) == len(targetNodeID):
                bl0_targetNode = True
        if bl0_targetNode:
            return "Target Node"
        else:
            return "Target Node not defined"


TN = TargetOptNode()
if targetNode and targetNodeID and targetNodeID[0] is not None and len(targetNode) == len(targetNodeID):
    
    targetNodeID = [ int(nodeID[1:]) for nodeID in targetNodeID]
    
    TN.targetNode = targetNode
    TN.targetNodeID = targetNodeID
    TN.targetNodeCoeff = [0.0 for i in range(len(targetNode))]

    if targetNodeCoeff and not(targetNodeCoeff.Contains(None)):
        if len(targetNodeCoeff) == len(targetNodeID):
            targetNodeCoeffC = []
            for i in range(len(targetNodeID)):
                targetNodeCoeffC.append( targetNodeCoeff[i] )
            TN.targetNodeCoeff  = targetNodeCoeffC
        elif len(targetNodeCoeff) == 1:
            targetNodeCoeffC = []
            for i in range(len(targetNodeID)):
                targetNodeCoeffC.append( targetNodeCoeff[0] )
            TN.targetNodeCoeff = targetNodeCoeffC
</item>
                    <item name="Description" type_name="gh_string" type_code="10">Assign targets</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>104</X>
                      <Y>104</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1372</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">9a4fc475-3760-4a0a-b613-7874cb9bf4d5</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Target_Node_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1655</X>
                          <Y>1109</Y>
                          <W>163</W>
                          <H>64</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1777</X>
                          <Y>1141</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="6">
                        <item name="InputCount" type_name="gh_int32" type_code="3">3</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="2" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="4">
                        <chunk name="InputParam" index="0">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(Point3D or Line or Surface) Describes the desired location of a node in the form diagram</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">22e09de6-4c37-48b4-bfbb-4886165eea5a</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">targetNode</item>
                            <item name="NickName" type_name="gh_string" type_code="10">targetNode</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">ee7e33d6-0d02-4683-9b4d-7089b0636d96</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1657</X>
                                  <Y>1111</Y>
                                  <W>105</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1719</X>
                                  <Y>1121</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(string) The corresponding node ID</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">0ff2e189-863e-4ac0-8ab5-0f6a600eb891</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">targetNodeID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">targetNodeID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">9d808c17-2f71-45dd-b295-57163d9818bb</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">37261734-eec7-4f50-b6a8-b8d1f3c4396b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1657</X>
                                  <Y>1131</Y>
                                  <W>105</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1719</X>
                                  <Y>1141</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="2">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">Script input targetNodeCoeff.</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">c52c4201-1100-4d53-bc06-912ad15d6235</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">targetNodeCoeff</item>
                            <item name="NickName" type_name="gh_string" type_code="10">targetNodeCoeff</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">4e74f640-39f8-46ab-8ccb-e1ee27da2845</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="2">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1657</X>
                                  <Y>1151</Y>
                                  <W>105</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1719</X>
                                  <Y>1161</Y>
                                </item>
                              </items>
                            </chunk>
                            <chunk name="PersistentData">
                              <items count="1">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Branch" index="0">
                                  <items count="2">
                                    <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                    <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                                  </items>
                                  <chunks count="1">
                                    <chunk name="Item" index="0">
                                      <items count="2">
                                        <item name="TypeName" type_name="gh_string" type_code="10">Grasshopper.Kernel.Types.GH_Integer</item>
                                        <item name="number" type_name="gh_int32" type_code="3">1</item>
                                      </items>
                                    </chunk>
                                  </chunks>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(Targets) The assigned targets, their ID and weights.</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">979b528b-46ec-4f68-a0b4-c7ef00fea659</item>
                            <item name="Name" type_name="gh_string" type_code="10">TN</item>
                            <item name="NickName" type_name="gh_string" type_code="10">TN</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1792</X>
                                  <Y>1111</Y>
                                  <W>24</W>
                                  <H>60</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1804</X>
                                  <Y>1141</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="25">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Assign targets
    Inputs:
        targetVector: (Vector3D) Describes the desired trail vector in the force diagram
        targetVectorID: (string) The corresponding trail edge ID
        targeVectorCoeffMag: (float) The weight factors for matching the magnitudes of the target vectors
        targeVectorCoeffDir: (float) The weight factors for matching the directions of the target vectors
    Outputs:
        TV: (Targets) The assigned targets, their ID and weights.
    Remarks:
        This generates a new instance of targets for the optimization
"""


__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""



import Rhino


class TargetOptVector(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        bl0_targetVector = False
        if targetVector and targetVectorID and targetVectorID[0] is not None and len(targetVector) == len(targetVectorID):
                bl0_targetVector = True
        if bl0_targetVector:
            return "Target Vector"
        else:
            return "Target Vector not defined"


TV = TargetOptVector()
if targetVector and targetVectorID and targetVectorID[0] is not None and len(targetVector) == len(targetVectorID):
    
    targetVectorID = [ int(vectorID[1:]) for vectorID in targetVectorID]
    
    TV.targetVector = targetVector
    TV.targetVectorID = targetVectorID
    TV.targetVectorCoeffMag = [0.0 for i in range(len(targetVector))]
    TV.targetVectorCoeffDir = [0.0 for i in range(len(targetVector))]

    if targetVectorCoeffMag and not(targetVectorCoeffMag.Contains(None)):
        if len(targetVectorCoeffMag) == len(targetVectorID) :
            targetVectorCoeffMagC = []
            for i in range(len(targetVectorID)):
                targetVectorCoeffMagC.append( targetVectorCoeffMag[i] )
            TV.targetVectorCoeffMag  = targetVectorCoeffMagC
        elif len(targetVectorCoeffMag) == 1:
            targetVectorCoeffMagC = []
            for i in range(len(targetVectorID)):
                targetVectorCoeffMagC.append( targetVectorCoeffMag[0] )
            TV.targetVectorCoeffMag = targetVectorCoeffMagC


    if targetVectorCoeffDir and not(targetVectorCoeffDir.Contains(None)):
        if len(targetVectorCoeffDir) == len(targetVectorID):
            targetVectorCoeffDirC = []
            for i in range(len(targetVectorID)):
                targetVectorCoeffDirC.append( targetVectorCoeffDir[i] )
            TV.targetVectorCoeffDir  = targetVectorCoeffDirC
        elif len(targetVectorCoeffDir) == 1:
            targetVectorCoeffDirC = []
            for i in range(len(targetVectorID)):
                targetVectorCoeffDirC.append( targetVectorCoeffDir[0] )
            TV.targetVectorCoeffDir = targetVectorCoeffDirC
</item>
                    <item name="Description" type_name="gh_string" type_code="10">Assign targets</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>182</X>
                      <Y>182</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>2459</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">cbe5355c-8c2b-43fc-b045-26f320fa8394</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Target_Vector_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1629</X>
                          <Y>1272</Y>
                          <W>189</W>
                          <H>84</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1778</X>
                          <Y>1314</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="7">
                        <item name="InputCount" type_name="gh_int32" type_code="3">4</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="2" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="3" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="5">
                        <chunk name="InputParam" index="0">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(Vector3D) Describes the desired trail vector in the force diagram</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">2618021c-d230-4bc1-9319-32ac249fc297</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">targetVector</item>
                            <item name="NickName" type_name="gh_string" type_code="10">targetVector</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">91d4d19b-fcbd-41fd-84c5-98f05074876b</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">15a50725-e3d3-4075-9f7c-142ba5f40747</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1631</X>
                                  <Y>1274</Y>
                                  <W>132</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1706.5</X>
                                  <Y>1284</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(string) The corresponding trail edge ID</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">68afabc3-682f-40e6-9964-3d68953ec9af</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">targetVectorID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">targetVectorID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">965f158e-2fe0-4e80-b18f-b81e95ab78ea</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">37261734-eec7-4f50-b6a8-b8d1f3c4396b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1631</X>
                                  <Y>1294</Y>
                                  <W>132</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1706.5</X>
                                  <Y>1304</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="2">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">Script input targetVectorCoeffMag.</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">5b42e4a9-9c33-43f5-a4e9-4a996f6b7dd6</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">targetVectorCoeffMag</item>
                            <item name="NickName" type_name="gh_string" type_code="10">targetVectorCoeffMag</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">8fd9df30-dd68-4030-a669-838441176593</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1631</X>
                                  <Y>1314</Y>
                                  <W>132</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1706.5</X>
                                  <Y>1324</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="3">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">Script input targetVectorCoeffDir.</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">a27d6643-6de8-49b4-b4fa-03a532dacb2c</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">targetVectorCoeffDir</item>
                            <item name="NickName" type_name="gh_string" type_code="10">targetVectorCoeffDir</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">bb875710-33dc-4b80-9752-4c6278c60077</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1631</X>
                                  <Y>1334</Y>
                                  <W>132</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1706.5</X>
                                  <Y>1344</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(Targets) The assigned targets, their ID and weights.</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">ca8db80d-c9d1-4f15-b8ff-f71a6729fd39</item>
                            <item name="Name" type_name="gh_string" type_code="10">TV</item>
                            <item name="NickName" type_name="gh_string" type_code="10">TV</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1793</X>
                                  <Y>1274</Y>
                                  <W>23</W>
                                  <H>80</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1804.5</X>
                                  <Y>1314</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="26">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">ec8b6f04-8757-407a-9e54-2a27426729e0</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10">boundsCoefficientOriginNode</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>1583</Y>
                          <W>285</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1240.562</X>
                          <Y>1583.926</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">2</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">1000</item>
                        <item name="Min" type_name="gh_double" type_code="6">0</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">0</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="27">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Assign bounds to trail lengths
    Inputs:
        boundTrailID: (string) The trail edges ID that are allowed to change their length
        boundUpTrail: (float) The upper bound of allowable change of lengths for trail edges [m]
        boundLowTrail: (float) The lower bound of allowable change of lengths for trail edges [m]
    Outputs:
        BT: (Bounds Trail Lengths) The bounds for the trail edges lengths
    Remarks:
        This generates a new instance of bounds for the trail edges for the optimization
"""

__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""


import Rhino


class BoundTrail(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        if boundTrailID and boundTrailID[0] is not None:
            return "Bound Trail"
        else:
            return "Bound Trail not defined"


BT = BoundTrail()
BT.ID = []
BT.Up = []
BT.Low = []


if boundTrailID and boundTrailID[0] is not None:
    boundTrailID = [ int(trailID[1:]) for trailID in boundTrailID]
    if len(boundTrailID) == len(boundUpTrail) and len(boundTrailID) == len(boundLowTrail):
        BT.ID = boundTrailID
        BT.Up = [abs(boundUpTrail_i) for boundUpTrail_i in boundUpTrail]
        BT.Low = [-abs(boundLowTrail_i) for boundLowTrail_i in boundLowTrail]
    elif len(boundUpTrail) == 1 and len(boundLowTrail) == 1:
        boundUpTrailC = []
        for i in range(len(boundTrailID)):
            boundUpTrailC.append(abs(boundUpTrail[0]))
        boundLowTrailC = []
        for i in range(len(boundTrailID)):
            boundLowTrailC.append(-abs(boundLowTrail[0]))
        BT.ID = boundTrailID
        BT.Up = boundUpTrailC
        BT.Low = boundLowTrailC
    else:
        boundUpTrailC = []
        for i in range(len(boundTrailID)):
            boundUpTrailC.append(0.0)
        boundLowTrailC = []
        for i in range(len(boundTrailID)):
            boundLowTrailC.append(0.0)
        BT.ID = boundTrailID
        BT.Up = boundUpTrailC
        BT.Low = boundLowTrailC
else:
    boundUpTrailC = []
    for i in range(len(boundTrailID)):
        boundUpTrailC.append(0.0)
    boundLowTrailC = []
    for i in range(len(boundTrailID)):
        boundLowTrailC.append(0.0)
    BT.ID = boundTrailID
    BT.Up = boundUpTrailC
    BT.Low = boundLowTrailC</item>
                    <item name="Description" type_name="gh_string" type_code="10">Assign bounds to trail lengths</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>52</X>
                      <Y>52</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1821</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">8c452fa7-ada3-4044-a807-11ebfb0011ee</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Bound_Trail_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1667</X>
                          <Y>1874</Y>
                          <W>151</W>
                          <H>64</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1779</X>
                          <Y>1906</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="6">
                        <item name="InputCount" type_name="gh_int32" type_code="3">3</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="2" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="4">
                        <chunk name="InputParam" index="0">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(string) The trail edges ID that are allowed to change their length</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">c447a9e1-d07d-4aee-bfdc-5fece962a7e3</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundTrailID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundTrailID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">a406af23-4cf8-4c29-b242-a479859a4e05</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">37261734-eec7-4f50-b6a8-b8d1f3c4396b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1669</X>
                                  <Y>1876</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1726</X>
                                  <Y>1886</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The upper bound of allowable change of lengths for trail edges [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">0af4ceea-3ae5-4ac7-a635-c38f25b2bc85</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundUpTrail</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundUpTrail</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">e89117e1-dcb4-43fc-825e-60f56c7abee3</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1669</X>
                                  <Y>1896</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1726</X>
                                  <Y>1906</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="2">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The lower bound of allowable change of lengths for trail edges [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">f4e5e7b8-a921-498b-8ca7-d3bc13319be4</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundLowTrail</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundLowTrail</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">0091e6a0-1cfc-4ea5-a890-8ba3e2a92e8b</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1669</X>
                                  <Y>1916</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1726</X>
                                  <Y>1926</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(Bounds Trail Lengths) The bounds for the trail edges lengths</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">f8709b4c-3355-4730-b7c4-c85591874de3</item>
                            <item name="Name" type_name="gh_string" type_code="10">BT</item>
                            <item name="NickName" type_name="gh_string" type_code="10">BT</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1794</X>
                                  <Y>1876</Y>
                                  <W>22</W>
                                  <H>60</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1805</X>
                                  <Y>1906</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="28">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Assign bounds to loads
    Inputs:
        boundLoadID: (string) The loads ID that are allowed to move
        boundUpLoadX: (float) The upper bound distance in X-direction [m]
        boundLowLoadX: (float) The lower bound distance in X-direction [m]
        boundUpLoadY: (float) The upper bound distance in Y-direction [m]
        boundLowLoadY: (float) The lower bound distance in Y-direction [m]
        boundUpLoadZ: (float) The upper bound distance in Z-direction [m]
        boundLowLoadZ: (float) The lower bound distance in Z-direction [m]
    Outputs:
        BL: (Bounds Loads) The bounds for the loads.
    Remarks:
        This generates a new instance of bounds for the loads for the optimization
"""

__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""


import Rhino


class BoundLoad(object):
    def __repr__(self):
        return self.ToString()
        
    def __str__(self):
        return self.ToString()
        
    def ToString(self):
        return "Bound Loads"


BL = BoundLoad()
BL.ID = []
BL.UpX = []
BL.LowX = []
BL.UpY = []
BL.LowY = []
BL.UpZ = []
BL.LowZ = []

if boundLoadID:
    boundLoadID = [ int(loadID[1:]) for loadID in boundLoadID]
    if len(boundLoadID) == len(boundUpLoadX) and len(boundLoadID) == len(boundLowLoadX):
        BL.ID = boundLoadID
        BL.UpX = [abs(boundUpLoadX_i) for boundUpLoadX_i in boundUpLoadX]
        BL.LowX = [-abs(boundLowLoadX_i) for boundLowLoadX_i in boundLowLoadX]
    elif len(boundUpLoadX) == 1 and len(boundLowLoadX) == 1:
        boundUpLoadXC = []
        for i in range(len(boundLoadID)):
            boundUpLoadXC.append(abs(boundUpLoadX[0]))
        boundLowLoadXC = []
        for i in range(len(boundLoadID)):
            boundLowLoadXC.append(-abs(boundLowLoadX[0]))
        BL.ID = boundLoadID
        BL.UpX = boundUpLoadXC
        BL.LowX = boundLowLoadXC
    else:
        boundUpLoadXC = []
        for i in range(len(boundLoadID)):
            boundUpLoadXC.append(0.0)
        boundLowLoadXC = []
        for i in range(len(boundLoadID)):
            boundLowLoadXC.append(0.0)
        BL.ID = boundLoadID
        BL.UpX = boundUpLoadXC
        BL.LowX = boundLowLoadXC

    if len(boundLoadID) == len(boundUpLoadY) and len(boundLoadID) == len(boundLowLoadY):
        BL.ID = boundLoadID
        BL.UpY = [abs(boundUpLoadY_i) for boundUpLoadY_i in boundUpLoadY]
        BL.LowY = [-abs(boundLowLoadY_i) for boundLowLoadY_i in boundLowLoadY]
    elif len(boundUpLoadY) == 1 and len(boundLowLoadY) == 1:
        boundUpLoadYC = []
        for i in range(len(boundLoadID)):
            boundUpLoadYC.append(abs(boundUpLoadY[0]))
        boundLowLoadYC = []
        for i in range(len(boundLoadID)):
            boundLowLoadYC.append(-abs(boundLowLoadY[0]))
        BL.ID = boundLoadID
        BL.UpY = boundUpLoadYC
        BL.LowY = boundLowLoadYC
    else:
        boundUpLoadYC = []
        for i in range(len(boundLoadID)):
            boundUpLoadYC.append(0.0)
        boundLowLoadYC = []
        for i in range(len(boundLoadID)):
            boundLowLoadYC.append(0.0)
        BL.ID = boundLoadID
        BL.UpY = boundUpLoadYC
        BL.LowY = boundLowLoadYC

    if len(boundLoadID) == len(boundUpLoadZ) and len(boundLoadID) == len(boundLowLoadZ):
        BL.ID = boundLoadID
        BL.UpZ = [abs(boundUpLoadZ_i) for boundUpLoadZ_i in boundUpLoadZ]
        BL.LowZ = [-abs(boundLowLoadZ_i) for boundLowLoadZ_i in boundLowLoadZ]
    elif len(boundUpLoadZ) == 1 and len(boundLowLoadZ) == 1:
        boundUpLoadZC = []
        for i in range(len(boundLoadID)):
            boundUpLoadZC.append(abs(boundUpLoadZ[0]))
        boundLowLoadZC = []
        for i in range(len(boundLoadID)):
            boundLowLoadZC.append(-abs(boundLowLoadZ[0]))
        BL.ID = boundLoadID
        BL.UpZ = boundUpLoadZC
        BL.LowZ = boundLowLoadZC
    else:
        boundUpLoadZC = []
        for i in range(len(boundLoadID)):
            boundUpLoadZC.append(0.0)
        boundLowLoadZC = []
        for i in range(len(boundLoadID)):
            boundLowLoadZC.append(0.0)
        BL.ID = boundLoadID
        BL.UpZ = boundUpLoadZC
        BL.LowZ = boundLowLoadZC
        
else:
    boundUpLoadXC = []
    for i in range(len(boundLoadID)):
        boundUpLoadXC.append(0.0)
    boundLowLoadXC = []
    for i in range(len(boundLoadID)):
        boundLowLoadXC.append(0.0)
    boundUpLoadYC = []
    for i in range(len(boundLoadID)):
        boundUpLoadYC.append(0.0)
    boundLowLoadYC = []
    for i in range(len(boundLoadID)):
        boundLowLoadYC.append(0.0)
    boundUpLoadZC = []
    for i in range(len(boundLoadID)):
        boundUpLoadZC.append(0.0)
    boundLowLoadZC = []
    for i in range(len(boundLoadID)):
        boundLowLoadZC.append(0.0)
    BL.ID = boundLoadID
    BL.UpX = boundUpLoadXC
    BL.LowX = boundLowLoadXC
    BL.UpY = boundUpLoadYC
    BL.LowY = boundLowLoadYC
    BL.UpZ = boundUpLoadZC
    BL.LowZ = boundLowLoadZC
</item>
                    <item name="Description" type_name="gh_string" type_code="10">Assign bounds to loads</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>66</X>
                      <Y>110</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1821</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">4a8f075e-0c4c-4ba0-b638-5f05f9238923</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Bound_Load_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1657</X>
                          <Y>1658</Y>
                          <W>161</W>
                          <H>144</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1779</X>
                          <Y>1730</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="10">
                        <item name="InputCount" type_name="gh_int32" type_code="3">7</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="2" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="3" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="4" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="5" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="6" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="8">
                        <chunk name="InputParam" index="0">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(string) The loads ID that are allowed to move</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">0a4d1520-f9fd-403c-856c-5547b954582f</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundLoadID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundLoadID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">d4126f83-2ed0-4236-9fac-b42fcaa1aba8</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">37261734-eec7-4f50-b6a8-b8d1f3c4396b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1659</X>
                                  <Y>1660</Y>
                                  <W>105</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1721</X>
                                  <Y>1670</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The upper bound distance in X-direction [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">0e9f4a3b-264b-4356-821d-fd75f472d649</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundUpLoadX</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundUpLoadX</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">34c6449e-0172-4310-87a4-7a03cc983935</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1659</X>
                                  <Y>1680</Y>
                                  <W>105</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1721</X>
                                  <Y>1690</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="2">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The lower bound distance in X-direction [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">716b87ed-078c-48e5-940a-bfc36c8db2b0</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundLowLoadX</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundLowLoadX</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">34c6449e-0172-4310-87a4-7a03cc983935</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1659</X>
                                  <Y>1700</Y>
                                  <W>105</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1721</X>
                                  <Y>1710</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="3">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The upper bound distance in Y-direction [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">b6fca9c6-92d3-4f66-98f2-ce10fc16f3df</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundUpLoadY</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundUpLoadY</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">34c6449e-0172-4310-87a4-7a03cc983935</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1659</X>
                                  <Y>1720</Y>
                                  <W>105</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1721</X>
                                  <Y>1730</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="4">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The lower bound distance in Y-direction [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">c3eb7a9b-b063-429f-936c-a1f436111ba0</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundLowLoadY</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundLowLoadY</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">34c6449e-0172-4310-87a4-7a03cc983935</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1659</X>
                                  <Y>1740</Y>
                                  <W>105</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1721</X>
                                  <Y>1750</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="5">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The upper bound distance in Z-direction [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">b77bf51a-f0c8-4422-b291-82122409afd6</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundUpLoadZ</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundUpLoadZ</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">30637faa-89e2-4e76-ad55-ab56f094e4ef</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1659</X>
                                  <Y>1760</Y>
                                  <W>105</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1721</X>
                                  <Y>1770</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="6">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(float) The lower bound distance in Z-direction [m]</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">ef616b0a-7a64-49be-b5ec-52a6b2bb3e80</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">boundLowLoadZ</item>
                            <item name="NickName" type_name="gh_string" type_code="10">boundLowLoadZ</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">30637faa-89e2-4e76-ad55-ab56f094e4ef</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">39fbc626-7a01-46ab-a18e-ec1c0c41685b</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1659</X>
                                  <Y>1780</Y>
                                  <W>105</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1721</X>
                                  <Y>1790</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(Bounds Loads) The bounds for the loads.</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">d08aec19-728d-4163-91bd-db56d4ba73a8</item>
                            <item name="Name" type_name="gh_string" type_code="10">BL</item>
                            <item name="NickName" type_name="gh_string" type_code="10">BL</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1794</X>
                                  <Y>1660</Y>
                                  <W>22</W>
                                  <H>140</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1805</X>
                                  <Y>1730</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="29">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">34c6449e-0172-4310-87a4-7a03cc983935</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>1708</Y>
                          <W>215</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1240.893</X>
                          <Y>1708.569</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">1</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">5000</item>
                        <item name="Min" type_name="gh_double" type_code="6">0</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">0</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="30">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">5a41528b-12b9-40dc-a3f2-842034d267c4</item>
                <item name="Name" type_name="gh_string" type_code="10">Text Tag 3D</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="4">
                    <item name="Description" type_name="gh_string" type_code="10">Represents a list of 3D text tags in a Rhino viewport</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">960b52ac-11f8-4c8c-924c-71bc93396920</item>
                    <item name="Name" type_name="gh_string" type_code="10">Text Tag 3D</item>
                    <item name="NickName" type_name="gh_string" type_code="10">Tag</item>
                  </items>
                  <chunks count="6">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>2982</X>
                          <Y>1550</Y>
                          <W>45</W>
                          <H>104</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>3013</X>
                          <Y>1602</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="param_input" index="0">
                      <items count="8">
                        <item name="Description" type_name="gh_string" type_code="10">Location and orientation of text tag</item>
                        <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">81b849f8-9c0e-4bc6-ac7a-dfdebd947a29</item>
                        <item name="Name" type_name="gh_string" type_code="10">Location</item>
                        <item name="NickName" type_name="gh_string" type_code="10">L</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="Source" index="0" type_name="gh_guid" type_code="9">82169143-ddaa-4e10-baf4-79eb3f799966</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2984</X>
                              <Y>1552</Y>
                              <W>14</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2992.5</X>
                              <Y>1562</Y>
                            </item>
                          </items>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_input" index="1">
                      <items count="7">
                        <item name="Description" type_name="gh_string" type_code="10">The text to display</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">b3053044-124c-4d99-91b8-b4c437a070f2</item>
                        <item name="Name" type_name="gh_string" type_code="10">Text</item>
                        <item name="NickName" type_name="gh_string" type_code="10">T</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                        <item name="Source" index="0" type_name="gh_guid" type_code="9">61dd57c9-46da-4ca9-a6c1-7d0e8fcdb211</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2984</X>
                              <Y>1572</Y>
                              <W>14</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2992.5</X>
                              <Y>1582</Y>
                            </item>
                          </items>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_input" index="2">
                      <items count="6">
                        <item name="Description" type_name="gh_string" type_code="10">Size of text</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">e0eae9d2-713e-4de8-b562-7ed10d35b736</item>
                        <item name="Name" type_name="gh_string" type_code="10">Size</item>
                        <item name="NickName" type_name="gh_string" type_code="10">S</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="2">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2984</X>
                              <Y>1592</Y>
                              <W>14</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2992.5</X>
                              <Y>1602</Y>
                            </item>
                          </items>
                        </chunk>
                        <chunk name="PersistentData">
                          <items count="1">
                            <item name="Count" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Branch" index="0">
                              <items count="2">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Item" index="0">
                                  <items count="1">
                                    <item name="number" type_name="gh_double" type_code="6">0.1</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_input" index="3">
                      <items count="6">
                        <item name="Description" type_name="gh_string" type_code="10">Optional colour of tag</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">f5232a5c-0318-4d49-9cb3-f021202f8e83</item>
                        <item name="Name" type_name="gh_string" type_code="10">Colour</item>
                        <item name="NickName" type_name="gh_string" type_code="10">C</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="2">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2984</X>
                              <Y>1612</Y>
                              <W>14</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2992.5</X>
                              <Y>1622</Y>
                            </item>
                          </items>
                        </chunk>
                        <chunk name="PersistentData">
                          <items count="1">
                            <item name="Count" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Branch" index="0">
                              <items count="2">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Item" index="0">
                                  <items count="1">
                                    <item name="color" type_name="gh_drawing_color" type_code="36">
                                      <ARGB>255;0;0;0</ARGB>
                                    </item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_input" index="4">
                      <items count="6">
                        <item name="Description" type_name="gh_string" type_code="10">Text justification</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">bef65b2e-6f29-441b-a0d1-3b18d1609249</item>
                        <item name="Name" type_name="gh_string" type_code="10">Justification</item>
                        <item name="NickName" type_name="gh_string" type_code="10">J</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="2">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2984</X>
                              <Y>1632</Y>
                              <W>14</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2992.5</X>
                              <Y>1642</Y>
                            </item>
                          </items>
                        </chunk>
                        <chunk name="PersistentData">
                          <items count="1">
                            <item name="Count" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Branch" index="0">
                              <items count="2">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Item" index="0">
                                  <items count="1">
                                    <item name="number" type_name="gh_int32" type_code="3">7</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="31">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">ccc7b468-e743-4049-891f-299432545898</item>
                <item name="Name" type_name="gh_string" type_code="10">Curve Middle</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="5">
                    <item name="Description" type_name="gh_string" type_code="10">Get the point in the middle of a curve</item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">f4d7c908-ee9f-4c46-890c-bfbaaf65fdcb</item>
                    <item name="Name" type_name="gh_string" type_code="10">Curve Middle</item>
                    <item name="NickName" type_name="gh_string" type_code="10">MidPt</item>
                  </items>
                  <chunks count="3">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>2881</X>
                          <Y>1549</Y>
                          <W>68</W>
                          <H>28</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>2912</X>
                          <Y>1563</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="param_input" index="0">
                      <items count="7">
                        <item name="Description" type_name="gh_string" type_code="10">Curve for mid-point.</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">645f0e0f-0e15-4c0e-976e-7452f18b3129</item>
                        <item name="Name" type_name="gh_string" type_code="10">Curve</item>
                        <item name="NickName" type_name="gh_string" type_code="10">C</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="Source" index="0" type_name="gh_guid" type_code="9">6dfe8acf-d3cd-4f16-a454-8fc784e6c970</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2883</X>
                              <Y>1551</Y>
                              <W>14</W>
                              <H>24</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2891.5</X>
                              <Y>1563</Y>
                            </item>
                          </items>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_output" index="0">
                      <items count="6">
                        <item name="Description" type_name="gh_string" type_code="10">Point in the middle of the curve</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">82169143-ddaa-4e10-baf4-79eb3f799966</item>
                        <item name="Name" type_name="gh_string" type_code="10">Midpoint</item>
                        <item name="NickName" type_name="gh_string" type_code="10">M</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>2927</X>
                              <Y>1551</Y>
                              <W>20</W>
                              <H>24</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>2937</X>
                              <Y>1563</Y>
                            </item>
                          </items>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="32">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">Python No Hint</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="15">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Retrieves automatically geometric properties from the topological diagram
    Inputs:
        TP: (topological diagram) The topological diagram used for the calculation of the structural model
    Outputs:
        nodes: (point 3D) The vertices describing the topological diagram
        nodesID: (integer) The corresponding node number
        edges: (edge midpoint) The edges describing the topological diagram
        edgesID: (integer) The corresponding edge number
        constraintPlane: (plane) The planes which are based on the trails normal vectors of the toplogical diagram 
        constraintPlaneID: (integer) The indices of these planes
        originNode: (point 3D) The origin points from the topological diagram
        originNodeID: (integer) The indices of these points
    Remarks:
        This extract geometric information from TP
"""


__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"

"""
If you use the CEM library in a project, please refer to the GitHub repository: 

@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}

"""


if TP and hasattr(TP, "str1_NodeOut") and hasattr(TP, "pt1_NodeOut"):
    nodes = TP.pt1_NodeOut[:len(TP.pt1_NodeOut)-len(TP.crv1_TrailAux)]
    nodesID = TP.str1_NodeOut[:len(TP.str1_NodeOut)-len(TP.crv1_TrailAux)]


if TP and hasattr(TP, "str1_TrailOut") and hasattr(TP, "pt1_TrailOut"):
    trails = TP.crv1_EdgeOut[:len(TP.pt1_TrailOut)-len(TP.crv1_TrailAux)]
    trailsID = TP.str1_TrailOut[:len(TP.str1_TrailOut)-len(TP.crv1_TrailAux)]


if TP and hasattr(TP, "str1_DeviationOut") and hasattr(TP, "pt1_DeviationOut"):
    deviations = TP.crv1_EdgeOut[len(TP.str1_TrailOut):len(TP.pt1_DeviationOut)+len(TP.str1_TrailOut)]
    deviationsID = TP.str1_DeviationOut

if TP and hasattr(TP, "str1_TrailOut") and hasattr(TP, "pt1_TrailOut"):
    auxTrails = TP.crv1_TrailAux
    auxTrailsID = TP.str1_TrailOut[:len(TP.crv1_TrailAux)]


if TP and hasattr(TP, "pt1_ForceOut") and hasattr(TP, "str1_ForceOut"):
    loads = TP.pt1_ForceOut
    loadsID = TP.str1_ForceOut
    


if TP and hasattr(TP, "pl1_ConstraintPlaneOut") and hasattr(TP, "str1_ConstraintPlaneOut"):
    constraintPlane = TP.pl1_ConstraintPlaneOut
    constraintPlaneID = TP.str1_ConstraintPlaneOut


if TP and hasattr(TP, "pt1_OriginNodeOut"):
    originNode = TP.pt1_OriginNodeOut
    originNodeID = TP.str1_OriginNodeOut




</item>
                    <item name="Description" type_name="gh_string" type_code="10">Retrieves automatically geometric properties from the topological diagram</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>26</X>
                      <Y>26</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1703</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="IconDisplay" type_name="gh_int32" type_code="3">1</item>
                    <item name="IconOverride" type_name="gh_drawing_bitmap" type_code="37">
                      <bitmap length="1249">iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOvAAADrwBlbxySQAABINJREFUSEudlAtQlFUUxxe+ZRdE3jsjg5A6Tk0zZhIEZqWZZgO54oSOLOuDQMrkZdpI2FSgREg1wvAQd4hAKUJUSHDIRxKiYEwkg2hEqIiAyGs/YHd5rOC/79zdgnWSGM7Mf+bs/e45v3PPPXtFTzJ7mUzu6OTMOzg4YCo5ypx52msMm745Os3hk1XncL15BNX1Qzj3qxYnyzXIPTOA1OM8EnL6EJ3WDXnIKQYxhk3fqLqSSg2W+GbA7TkFPOWHsf6jTry9zyDy/fbex5qdzewkxrDpGwWpivvx1GIF3Bb5Y4G7EgFxXQg80M1E/qbPuuAb0TRzwP5v1XjJ/wgWeiixXKFCUFIvgr/qYyJ/a2IP1kbdnDkg/FAvtiT0sIShyWrsSOWxM90g8mltXdT1/wFwXnJzzlu4JHdh04SsrOaZ/P5HH2QPMu3KGkR4Zr8AuIb5lpZYLBKZyNNCxHtwIrnIjPPikzMrceveKOr+HMala0Mou6rDiQotjl3QQlWmRUqJFknFOsQe1yEm36DoPC325GiwLqKGnWD0TgGGauMwcFaB3qNLcCbIAp5ikVo4gjsu/67DitC7eDOyjU0GXR71l1pAVVIiSvrpiWHEFY0wkU9r8rAqBujPt4U6dzZ6VdboTrPC7U8k7CQMUHppECvfa4XPrnY2fjQhdInUZ2oFVUsJ40tGcfCnh0zk05rvuxUMMFDoBP6YDfqyBEC6Ff6KkU4A8kr78boRQDNOY7g5vgPK2FvYHNeEbQcaEfz5TWxPaEDoF/UIiqvFpr3V8AurwDK/FMx3ddJrfpwHPk8AfGONnoxZ+OPDSSdI/b7PBLBhXytWKrMfuc510VN1U2mBm0x/+uDCR5oiFxNAQ+QkQGxmt0mLfMJvYK6Li768MBZj3RUY6yzBWEcextvSMd6agPHb0Rhr3AF9XQBGqlZBV/Y0BgrsTFpU9/4kQERip8klrwqpZdXpWwqgOWkHXYkDhs86YuRnJ4yWy5jIpzX6Rnsev+Tfgi0mAIHRbXg1+C7eCLuHtXs6sFxZzQAjjZlCZbbQFNmzRENljiwpiXyWXPhGe1h7soX2ZM5CV4olrionAVaHtuDlbS3/3sNSf8NkDNUloP87GwNEqFJbbA/taaMEn9boG+1R50xU/+CQJa5sFBsAZuZevOsLR/Hs6l+waM1FPO9zAe6+5xlAe2U3C6TqqAWUbLDQDuo8W3Rl2aAjbTZakqzRHCdMTbQl6iOlqN0uYdXnv8bRH014IYSnwuw/ngoCDJ4PYlXR0am/dIlU1XREydlT8SQjAH/qLXZk6isDCRPC//AMNBe3YLghDQ+7akBGe41h0zcK6s31Zv2kSyMQjR/NuCpYCuUyDkfekaAhSjJzwIPUBbifKEHnl1J0fi1lMFLgUg7+HhwCvTlc3iCeOaAt3gbt+y3QHm+BjgQJg5EOK8RQvGiOjAAxSl8xnxlgjsyeL9wqQevHHO7EiNG0W4wbYRzqQjjUKDlUbeRQud4c6SukcBb2GsOmbzKZvZwCqbqpRHtorzHsMROJ/gZZA8pObvyCAwAAAABJRU5ErkJggg==</bitmap>
                    </item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">8d010ad5-c841-409b-bf33-b8589d3f85cc</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">Python No Hint</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Extract_Topology_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>737</X>
                          <Y>360</Y>
                          <W>148</W>
                          <H>284</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>773</X>
                          <Y>502</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="17">
                        <item name="InputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">14</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="1" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="2" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="3" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="4" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="5" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="6" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="7" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="8" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="9" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="10" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="11" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="12" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                        <item name="OutputId" index="13" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="15">
                        <chunk name="InputParam" index="0">
                          <items count="11">
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">(topological diagram) The topological diagram used for the calculation of the structural model</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">46aac810-195e-47bb-888f-6ae8a3c56ab1</item>
                            <item name="Name" type_name="gh_string" type_code="10">TP</item>
                            <item name="NickName" type_name="gh_string" type_code="10">TP</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">0</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">f424fef5-cffe-4250-ac8f-9c19d0df4fc1</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">35915213-5534-4277-81b8-1bdc9e7383d2</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>739</X>
                                  <Y>362</Y>
                                  <W>19</W>
                                  <H>280</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>750</X>
                                  <Y>502</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(point 3D) The vertices describing the topological diagram</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">771de3e5-ddf9-4fa6-a6fa-a206ebec6e7e</item>
                            <item name="Name" type_name="gh_string" type_code="10">nodes</item>
                            <item name="NickName" type_name="gh_string" type_code="10">nodes</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>362</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>372</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="1">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(integer) The corresponding node number</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">87277aea-0220-40ca-acc3-ca312c29e598</item>
                            <item name="Name" type_name="gh_string" type_code="10">nodesID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">nodesID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>382</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>392</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="2">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Extract_Topology</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">8374c213-1c52-47c1-8935-71e3c6c16c54</item>
                            <item name="Name" type_name="gh_string" type_code="10">trails</item>
                            <item name="NickName" type_name="gh_string" type_code="10">trails</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>402</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>412</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="3">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Extract_Topology</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">f746489e-7f5b-4211-ab35-0ff3937c3650</item>
                            <item name="Name" type_name="gh_string" type_code="10">trailsID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">trailsID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>422</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>432</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="4">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Extract_Topology</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">657c3127-5f11-4807-90f8-69dd63e64ceb</item>
                            <item name="Name" type_name="gh_string" type_code="10">deviations</item>
                            <item name="NickName" type_name="gh_string" type_code="10">deviations</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>442</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>452</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="5">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Extract_Topology</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">efdd6cab-a748-45c6-9ea1-2d1e98df4e82</item>
                            <item name="Name" type_name="gh_string" type_code="10">deviationsID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">deviationsID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>462</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>472</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="6">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Extract_Topology</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">2c7e5a89-e486-441f-bf7e-52e69206a429</item>
                            <item name="Name" type_name="gh_string" type_code="10">auxTrails</item>
                            <item name="NickName" type_name="gh_string" type_code="10">auxTrails</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>482</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>492</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="7">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Extract_Topology</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">e4926493-528e-44d5-8016-38d7ae7f38ff</item>
                            <item name="Name" type_name="gh_string" type_code="10">auxTrailsID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">auxTrailsID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>502</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>512</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="8">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Extract_Topology</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">040f2cc7-78c9-4c42-aeec-d35cc3f014c0</item>
                            <item name="Name" type_name="gh_string" type_code="10">loads</item>
                            <item name="NickName" type_name="gh_string" type_code="10">loads</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>522</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>532</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="9">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script variable CEM_Extract_Topology</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">d4126f83-2ed0-4236-9fac-b42fcaa1aba8</item>
                            <item name="Name" type_name="gh_string" type_code="10">loadsID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">loadsID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>542</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>552</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="10">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(plane) The planes which are based on the trails normal vectors of the toplogical diagram </item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">f125a365-1067-4475-a5d9-f5fd00eb3033</item>
                            <item name="Name" type_name="gh_string" type_code="10">constraintPlane</item>
                            <item name="NickName" type_name="gh_string" type_code="10">constraintPlane</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>562</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>572</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="11">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(integer) The indices of these planes</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">c1e17f3d-8bfe-48b2-a85e-d4ea51b95b72</item>
                            <item name="Name" type_name="gh_string" type_code="10">constraintPlaneID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">constraintPlaneID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>582</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>592</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="12">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(point 3D) The origin points from the topological diagram</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">cdae992c-b011-4c15-9d24-98216134be65</item>
                            <item name="Name" type_name="gh_string" type_code="10">originNode</item>
                            <item name="NickName" type_name="gh_string" type_code="10">originNode</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>602</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>612</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="13">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">(integer) The indices of these points</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">441133c2-e05b-449f-918a-77aad1252fc9</item>
                            <item name="Name" type_name="gh_string" type_code="10">originNodeID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">originNodeID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>788</X>
                                  <Y>622</Y>
                                  <W>95</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>835.5</X>
                                  <Y>632</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="33">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">fbac3e32-f100-4292-8692-77240a42fd1a</item>
                <item name="Name" type_name="gh_string" type_code="10">Point</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="8">
                    <item name="Description" type_name="gh_string" type_code="10">Contains a collection of three-dimensional points</item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">b5e5237d-534d-4823-80b2-00955e8e1fe3</item>
                    <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                    <item name="Name" type_name="gh_string" type_code="10">Point</item>
                    <item name="NickName" type_name="gh_string" type_code="10">support</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>84</X>
                          <Y>892</Y>
                          <W>69</W>
                          <H>24</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>128.2182</X>
                          <Y>904.8422</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="PersistentData">
                      <items count="1">
                        <item name="Count" type_name="gh_int32" type_code="3">1</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Branch" index="0">
                          <items count="2">
                            <item name="Count" type_name="gh_int32" type_code="3">4</item>
                            <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                          </items>
                          <chunks count="4">
                            <chunk name="Item" index="0">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">0c16f318-0e6f-4335-9eeb-034c3a60dce3</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                            <chunk name="Item" index="1">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">8775c8f9-eebc-4a8d-9b41-f886c1696a5a</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                            <chunk name="Item" index="2">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">57823fe3-8fe7-4e61-a178-4bf75d336179</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                            <chunk name="Item" index="3">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">9ae45e61-d10f-40dd-804c-e827037c551e</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="34">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">d5967b9f-e8ee-436b-a8ad-29fdcecf32d5</item>
                <item name="Name" type_name="gh_string" type_code="10">Curve</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="8">
                    <item name="Description" type_name="gh_string" type_code="10">Contains a collection of generic curves</item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">975873b3-c21e-4f57-bd5d-1e072de1672a</item>
                    <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                    <item name="Name" type_name="gh_string" type_code="10">Curve</item>
                    <item name="NickName" type_name="gh_string" type_code="10">deviationEdge</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>100</X>
                          <Y>694</Y>
                          <W>69</W>
                          <H>24</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>144.1885</X>
                          <Y>706.7369</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="PersistentData">
                      <items count="1">
                        <item name="Count" type_name="gh_int32" type_code="3">1</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Branch" index="0">
                          <items count="2">
                            <item name="Count" type_name="gh_int32" type_code="3">16</item>
                            <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                          </items>
                          <chunks count="16">
                            <chunk name="Item" index="0">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">75db2540-2532-4f7c-8069-83f0e1bc2a37</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="1">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">15519db5-2efb-47e9-8272-fa1952198e3d</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="2">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">889cc975-0651-4391-a0bd-babdfda75a25</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="3">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">1d848969-51cd-4441-b3b5-141f28a9d095</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="4">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">4a0f0174-b87d-4e7b-b13a-e2a99593ae0f</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="5">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">010f1fdd-4010-4117-9eab-3f6b3000fbd2</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="6">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">fb419020-a1fc-4ee1-bb5a-c244aa81ef23</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="7">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">037f762e-3d5e-4390-a944-ca82e280de3e</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="8">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">08591133-e475-46c9-90ee-202ce993a0cc</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="9">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">59d23100-dc64-49c7-9f14-2700b6035b64</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="10">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">983345a9-3e31-42e5-9151-bccddfb0d13d</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="11">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">8dc54743-c26f-4e0a-85e0-0edc6fd7f4c9</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="12">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">6e64c482-c486-458e-ac14-cfcca577747e</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="13">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">df28136d-d191-49d4-9d56-710df7a9b4df</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="14">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">b79b8c8c-c213-4cce-a671-e54f88f52345</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="15">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">32afd003-c4cf-473b-86fe-d762a1d1093b</item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="35">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">a847a333-6c84-40ee-ae67-9432356b1a88</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>83</X>
                          <Y>763</Y>
                          <W>206</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>83.983</X>
                          <Y>763.2823</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">3</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">10</item>
                        <item name="Min" type_name="gh_double" type_code="6">-20</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">-2</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="36">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">d5967b9f-e8ee-436b-a8ad-29fdcecf32d5</item>
                <item name="Name" type_name="gh_string" type_code="10">Curve</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="8">
                    <item name="Description" type_name="gh_string" type_code="10">Contains a collection of generic curves</item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">4ffc0dfc-f146-4a7f-b29b-49ef66c29d6e</item>
                    <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                    <item name="Name" type_name="gh_string" type_code="10">Curve</item>
                    <item name="NickName" type_name="gh_string" type_code="10">trailEdge</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>86</X>
                          <Y>398</Y>
                          <W>69</W>
                          <H>24</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>130.6552</X>
                          <Y>410.4249</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="PersistentData">
                      <items count="1">
                        <item name="Count" type_name="gh_int32" type_code="3">1</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Branch" index="0">
                          <items count="2">
                            <item name="Count" type_name="gh_int32" type_code="3">12</item>
                            <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                          </items>
                          <chunks count="12">
                            <chunk name="Item" index="0">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">39a2f0eb-9e24-4fab-9569-259c56569cd5</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="1">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">ef28b7e6-d4af-4907-8b40-bc7001fcbf6e</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="2">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">c160ed46-b33b-4ab9-92f4-ade3e0fe510c</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="3">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">3bae4401-4e01-44b6-9bfd-1ddff1a4497f</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="4">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">e38e2400-7315-4167-917b-67998d3b5641</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="5">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">20d8dc03-c4eb-4c5d-96c4-474cd8cf558a</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="6">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">f7100f4b-a174-4516-80cc-53dce770bac9</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="7">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">a2d1b200-cdd8-434f-afbd-de49cdc956d7</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="8">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">0c917e69-2ec9-43e3-a97b-455c5e5c7065</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="9">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">f445e570-fa89-4def-a7ba-523c79ba263a</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="10">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">24d8d8ae-9a62-4a87-a346-f90a6d065cba</item>
                              </items>
                            </chunk>
                            <chunk name="Item" index="11">
                              <items count="2">
                                <item name="EdgeIndex" type_name="gh_int32" type_code="3">-1</item>
                                <item name="RefID" type_name="gh_guid" type_code="9">8fb6c39e-3572-44e5-b4ae-b80b03f999e2</item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="37">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">a84b9765-6d5f-4d88-8f44-69171189d187</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>83</X>
                          <Y>451</Y>
                          <W>190</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>83.92691</X>
                          <Y>451.0424</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">3</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">10</item>
                        <item name="Min" type_name="gh_double" type_code="6">-10</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">-3</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="38">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">78ab3ff7-bf46-42c5-8905-b92a8cb033b4</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>83</X>
                          <Y>600</Y>
                          <W>199</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>83.93802</X>
                          <Y>600.4357</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">3</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">10</item>
                        <item name="Min" type_name="gh_double" type_code="6">-10</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">-3</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="39">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">3901472b-d20b-44de-a3e2-eaf6e709a6e8</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>83</X>
                          <Y>575</Y>
                          <W>199</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>83.4597</X>
                          <Y>575.194</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">3</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">10</item>
                        <item name="Min" type_name="gh_double" type_code="6">-10</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">0</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="40">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">47897302-9fea-4128-961d-7801c009c67b</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>83</X>
                          <Y>550</Y>
                          <W>199</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>83.63423</X>
                          <Y>550.2745</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">3</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">10</item>
                        <item name="Min" type_name="gh_double" type_code="6">-10</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">0</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="41">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">fbac3e32-f100-4292-8692-77240a42fd1a</item>
                <item name="Name" type_name="gh_string" type_code="10">Point</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="8">
                    <item name="Description" type_name="gh_string" type_code="10">Contains a collection of three-dimensional points</item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">0a88a001-f0a2-44c6-9184-6b232e4de7af</item>
                    <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                    <item name="Name" type_name="gh_string" type_code="10">Point</item>
                    <item name="NickName" type_name="gh_string" type_code="10">pointLoad</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>89</X>
                          <Y>522</Y>
                          <W>69</W>
                          <H>24</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>133.5411</X>
                          <Y>534.8915</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="PersistentData">
                      <items count="1">
                        <item name="Count" type_name="gh_int32" type_code="3">1</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Branch" index="0">
                          <items count="2">
                            <item name="Count" type_name="gh_int32" type_code="3">4</item>
                            <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                          </items>
                          <chunks count="4">
                            <chunk name="Item" index="0">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">1452211e-c4dc-4838-a3a2-ad0928eb0017</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                            <chunk name="Item" index="1">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">ad123a50-5bab-4433-8462-3a595236b32e</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                            <chunk name="Item" index="2">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">abe70580-55f4-41ca-9418-7924f42c2f3a</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                            <chunk name="Item" index="3">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">d8314fc8-aaa1-45da-a350-0b1ff93d7420</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="42">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">59e0b89a-e487-49f8-bab8-b5bab16be14c</item>
                <item name="Name" type_name="gh_string" type_code="10">Panel</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="9">
                    <item name="Description" type_name="gh_string" type_code="10">A panel for custom notes and text values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">4d13cfb4-24b2-4545-9d06-08125c27fe4c</item>
                    <item name="Name" type_name="gh_string" type_code="10">Panel</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="ScrollRatio" type_name="gh_double" type_code="6">0</item>
                    <item name="Source" index="0" type_name="gh_guid" type_code="9">f424fef5-cffe-4250-ac8f-9c19d0df4fc1</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                    <item name="UserText" type_name="gh_string" type_code="10">Double click to edit panel content…</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="5">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>655</X>
                          <Y>183</Y>
                          <W>363</W>
                          <H>147</H>
                        </item>
                        <item name="MarginLeft" type_name="gh_int32" type_code="3">0</item>
                        <item name="MarginRight" type_name="gh_int32" type_code="3">0</item>
                        <item name="MarginTop" type_name="gh_int32" type_code="3">0</item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>655.9487</X>
                          <Y>183.8781</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="PanelProperties">
                      <items count="7">
                        <item name="Colour" type_name="gh_drawing_color" type_code="36">
                          <ARGB>255;255;255;255</ARGB>
                        </item>
                        <item name="DrawIndices" type_name="gh_bool" type_code="1">false</item>
                        <item name="DrawPaths" type_name="gh_bool" type_code="1">false</item>
                        <item name="Multiline" type_name="gh_bool" type_code="1">true</item>
                        <item name="SpecialCodes" type_name="gh_bool" type_code="1">false</item>
                        <item name="Stream" type_name="gh_bool" type_code="1">false</item>
                        <item name="Wrap" type_name="gh_bool" type_code="1">true</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Font">
                          <items count="2">
                            <item name="Family" type_name="gh_string" type_code="10">Courier New</item>
                            <item name="Size" type_name="gh_single" type_code="5">8</item>
                          </items>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="43">
              <items count="3">
                <item name="GUID" type_name="gh_guid" type_code="9">410755b1-224a-4c1e-a407-bf32fb45ea7e</item>
                <item name="Lib" type_name="gh_guid" type_code="9">00000000-0000-0000-0000-000000000000</item>
                <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="13">
                    <item name="CodeInput" type_name="gh_string" type_code="10">"""
Assign self weight
    Inputs:
        selfWeight: (bool) Activate the self weight of the structure
        yieldStress: (double) The yield stress of the structural members
        specWeight: (double) The specific weight of the structural members
    Outputs:
        SW: (self-weight) The assigned self weight properties 
    Remarks:
        This generates a new instance of self weight
"""
        
        
__author__    = ['Patrick Ole Ohlbrock','Pierluigi D''Acunto' ]
__copyright__ = 'Copyright 2021 - ETH Zurich and Technical University of Munich'
__license__   = 'MIT License'
__email__     = ['ohlbrock@arch.ethz.ch','pierluigi.dacunto@tum.de']
__version__   = "2.00"
        
"""
If you use the CEM library in a project, please refer to the GitHub repository: 
        
@Misc{cem2021,
author = {Ohlbrock, Patrick Ole and D'Acunto, Pierluigi},
title = {{CEM: Combinatorial Equilibrium Modeling}},
year = {2021},
note = {Release 2.00},
url = { http://github.com/OleOhlbrock/CEM },
}
        
"""
        
        
class CPlane(object):
    def __repr__(self):
        return self.ToString()
                
    def __str__(self):
        return self.ToString()
                
    def ToString(self):
        if constraintPlane and constraintPlane[0] is not None and len(constraintPlane) == len(constraintPlaneID):
            return str(len(constraintPlane)) + " Constraint Planes"
        else:
            return "Invalid Constraint Planes"
                    
        
CPL = CPlane()
        
if constraintPlane and constraintPlane[0] is not None and len(constraintPlane) == len(constraintPlaneID):
    CPL.constraintPlane = constraintPlane
    CPL.constraintPlaneID = constraintPlaneID
        
        
</item>
                    <item name="Description" type_name="gh_string" type_code="10">Assign self weight</item>
                    <item name="EditorLocation" type_name="gh_drawing_point" type_code="30">
                      <X>26</X>
                      <Y>26</Y>
                    </item>
                    <item name="EditorSize" type_name="gh_drawing_size" type_code="32">
                      <W>1301</W>
                      <H>1220</H>
                    </item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideInput" type_name="gh_bool" type_code="1">true</item>
                    <item name="HideOutput" type_name="gh_bool" type_code="1">true</item>
                    <item name="InputIsPath" type_name="gh_bool" type_code="1">false</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">2bf139b6-53d1-458f-954b-acaa5492cf76</item>
                    <item name="IsAdvancedMode" type_name="gh_bool" type_code="1">false</item>
                    <item name="MarshalOutGuids" type_name="gh_bool" type_code="1">true</item>
                    <item name="Name" type_name="gh_string" type_code="10">GhPython Script</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Constraint_Plane_2.0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1648</X>
                          <Y>551</Y>
                          <W>170</W>
                          <H>44</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1773</X>
                          <Y>573</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="5">
                        <item name="InputCount" type_name="gh_int32" type_code="3">2</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">84fa917c-1ed8-4db3-8be1-7bdc4a6495a2</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">8ec86459-bf01-4409-baee-174d0d2b13d0</item>
                      </items>
                      <chunks count="3">
                        <chunk name="InputParam" index="0">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">Script variable Python</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">8ed86387-fe4c-4ed3-8668-ae2f4e5a40bc</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">constraintPlane</item>
                            <item name="NickName" type_name="gh_string" type_code="10">constraintPlane</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">f125a365-1067-4475-a5d9-f5fd00eb3033</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">3897522d-58e9-4d60-b38c-978ddacfedd8</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1650</X>
                                  <Y>553</Y>
                                  <W>108</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1713.5</X>
                                  <Y>563</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="13">
                            <item name="Access" type_name="gh_int32" type_code="3">1</item>
                            <item name="AllowTreeAccess" type_name="gh_bool" type_code="1">true</item>
                            <item name="Description" type_name="gh_string" type_code="10">Script input constraintPlaneID.</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">8f35c1dc-5a82-4b46-9f2b-ada8689d058b</item>
                            <item name="Mapping" type_name="gh_int32" type_code="3">1</item>
                            <item name="Name" type_name="gh_string" type_code="10">constraintPlaneID</item>
                            <item name="NickName" type_name="gh_string" type_code="10">constraintPlaneID</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="ScriptParamAccess" type_name="gh_int32" type_code="3">1</item>
                            <item name="ShowTypeHints" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">c1e17f3d-8bfe-48b2-a85e-d4ea51b95b72</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                            <item name="TypeHintID" type_name="gh_guid" type_code="9">48d01794-d3d8-4aef-990e-127168822244</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1650</X>
                                  <Y>573</Y>
                                  <W>108</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1713.5</X>
                                  <Y>583</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Script output CPL.</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">fe893ee9-9ff4-4996-8fc3-49d75dad4da8</item>
                            <item name="Name" type_name="gh_string" type_code="10">CPL</item>
                            <item name="NickName" type_name="gh_string" type_code="10">CPL</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1788</X>
                                  <Y>553</Y>
                                  <W>28</W>
                                  <H>40</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1802</X>
                                  <Y>573</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="44">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">fbac3e32-f100-4292-8692-77240a42fd1a</item>
                <item name="Name" type_name="gh_string" type_code="10">Point</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="7">
                    <item name="Description" type_name="gh_string" type_code="10">Contains a collection of three-dimensional points</item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">9c8503be-0683-40a5-ad3d-13f8c2902a11</item>
                    <item name="Name" type_name="gh_string" type_code="10">Point</item>
                    <item name="NickName" type_name="gh_string" type_code="10">originNodes</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1253</X>
                          <Y>708</Y>
                          <W>50</W>
                          <H>24</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1278.336</X>
                          <Y>720.8761</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="PersistentData">
                      <items count="1">
                        <item name="Count" type_name="gh_int32" type_code="3">1</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Branch" index="0">
                          <items count="2">
                            <item name="Count" type_name="gh_int32" type_code="3">4</item>
                            <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                          </items>
                          <chunks count="4">
                            <chunk name="Item" index="0">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">0730a0e1-1301-4201-a8ef-c367f4a91979</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                            <chunk name="Item" index="1">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">fb240e29-a9fa-468a-8742-a1a298853316</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                            <chunk name="Item" index="2">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">068df75a-36b6-48b8-9725-3e9673ef2881</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                            <chunk name="Item" index="3">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">cfbf8d62-299f-4d60-99e1-e80be135fd2e</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="45">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">36b9d765-08a5-4e7e-ad88-833a3447e9b4</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10">YieldStress (kN/m2)</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>934</Y>
                          <W>282</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1240.068</X>
                          <Y>934.3461</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">1</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">1000000</item>
                        <item name="Min" type_name="gh_double" type_code="6">50</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">500000</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="46">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">a2b124ff-1377-4c97-b8c3-4d88ff8ceed0</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"> Specific Weight (kN/m3)</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>999</Y>
                          <W>290</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1240.017</X>
                          <Y>999.4154</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">2</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">500</item>
                        <item name="Min" type_name="gh_double" type_code="6">5</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">73.5</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="47">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">4e74f640-39f8-46ab-8ccb-e1ee27da2845</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1241</X>
                          <Y>1182</Y>
                          <W>236</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1241.205</X>
                          <Y>1182.423</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">3</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">1</item>
                        <item name="Max" type_name="gh_double" type_code="6">10000</item>
                        <item name="Min" type_name="gh_double" type_code="6">0</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">1</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="48">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">fbac3e32-f100-4292-8692-77240a42fd1a</item>
                <item name="Name" type_name="gh_string" type_code="10">Point</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="7">
                    <item name="Description" type_name="gh_string" type_code="10">Contains a collection of three-dimensional points</item>
                    <item name="Hidden" type_name="gh_bool" type_code="1">true</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">ee7e33d6-0d02-4683-9b4d-7089b0636d96</item>
                    <item name="Name" type_name="gh_string" type_code="10">Point</item>
                    <item name="NickName" type_name="gh_string" type_code="10">targetNodes</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1252</X>
                          <Y>1079</Y>
                          <W>50</W>
                          <H>24</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1277.828</X>
                          <Y>1091.106</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="PersistentData">
                      <items count="1">
                        <item name="Count" type_name="gh_int32" type_code="3">1</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Branch" index="0">
                          <items count="2">
                            <item name="Count" type_name="gh_int32" type_code="3">4</item>
                            <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                          </items>
                          <chunks count="4">
                            <chunk name="Item" index="0">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">2c162c70-b4e1-44b4-82d3-d184d0c4baf5</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                            <chunk name="Item" index="1">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">15447b30-c2b2-46eb-bb2f-292aedfbff4b</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                            <chunk name="Item" index="2">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">f2254545-8fa1-446c-91f8-f0d10ba4abb5</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                            <chunk name="Item" index="3">
                              <!--GH_Point only stores data which exists, test the existence of data fields prior to reading.-->
                              <chunks count="1">
                                <chunk name="ReferenceData">
                                  <items count="5">
                                    <item name="RefID" type_name="gh_guid" type_code="9">8fe64dfd-221d-40e6-b6b1-5f5d4a29248a</item>
                                    <item name="RefIndex" type_name="gh_int32" type_code="3">-1</item>
                                    <item name="RefParam" index="0" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefParam" index="1" type_name="gh_double" type_code="6">0</item>
                                    <item name="RefType" type_name="gh_string" type_code="10">point_object</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="49">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">59e0b89a-e487-49f8-bab8-b5bab16be14c</item>
                <item name="Name" type_name="gh_string" type_code="10">Panel</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="8">
                    <item name="Description" type_name="gh_string" type_code="10">A panel for custom notes and text values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">9d808c17-2f71-45dd-b295-57163d9818bb</item>
                    <item name="Name" type_name="gh_string" type_code="10">Panel</item>
                    <item name="NickName" type_name="gh_string" type_code="10">targetNode</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="ScrollRatio" type_name="gh_double" type_code="6">0</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                    <item name="UserText" type_name="gh_string" type_code="10">V15
V13
V12
V14</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="5">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1073</X>
                          <Y>1091</Y>
                          <W>113</W>
                          <H>100</H>
                        </item>
                        <item name="MarginLeft" type_name="gh_int32" type_code="3">0</item>
                        <item name="MarginRight" type_name="gh_int32" type_code="3">0</item>
                        <item name="MarginTop" type_name="gh_int32" type_code="3">0</item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1073.814</X>
                          <Y>1091.725</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="PanelProperties">
                      <items count="7">
                        <item name="Colour" type_name="gh_drawing_color" type_code="36">
                          <ARGB>255;255;255;255</ARGB>
                        </item>
                        <item name="DrawIndices" type_name="gh_bool" type_code="1">false</item>
                        <item name="DrawPaths" type_name="gh_bool" type_code="1">false</item>
                        <item name="Multiline" type_name="gh_bool" type_code="1">false</item>
                        <item name="SpecialCodes" type_name="gh_bool" type_code="1">false</item>
                        <item name="Stream" type_name="gh_bool" type_code="1">false</item>
                        <item name="Wrap" type_name="gh_bool" type_code="1">true</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Font">
                          <items count="2">
                            <item name="Family" type_name="gh_string" type_code="10">Courier New</item>
                            <item name="Size" type_name="gh_single" type_code="5">4</item>
                          </items>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="50">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">16ef3e75-e315-4899-b531-d3166b42dac9</item>
                <item name="Name" type_name="gh_string" type_code="10">Vector</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Contains a collection of three-dimensional vectors</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">91d4d19b-fcbd-41fd-84c5-98f05074876b</item>
                    <item name="Name" type_name="gh_string" type_code="10">Vector</item>
                    <item name="NickName" type_name="gh_string" type_code="10">targetVector</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="1">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1252</X>
                          <Y>1244</Y>
                          <W>50</W>
                          <H>24</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1277.644</X>
                          <Y>1256.007</Y>
                        </item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="51">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">8fd9df30-dd68-4030-a669-838441176593</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10">targetVectorCoeffMag</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>1326</Y>
                          <W>242</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1240.477</X>
                          <Y>1326.291</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">3</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">1</item>
                        <item name="Max" type_name="gh_double" type_code="6">10000</item>
                        <item name="Min" type_name="gh_double" type_code="6">0</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">0</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="52">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">bb875710-33dc-4b80-9752-4c6278c60077</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10">targetVectorCoeffDir</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>1365</Y>
                          <W>234</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1240.966</X>
                          <Y>1365.862</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">3</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">1</item>
                        <item name="Max" type_name="gh_double" type_code="6">10000</item>
                        <item name="Min" type_name="gh_double" type_code="6">0</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">0</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="53">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">2e3ab970-8545-46bb-836c-1c11e5610bce</item>
                <item name="Name" type_name="gh_string" type_code="10">Integer</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Contains a collection of integer numbers</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">965f158e-2fe0-4e80-b18f-b81e95ab78ea</item>
                    <item name="Name" type_name="gh_string" type_code="10">Integer</item>
                    <item name="NickName" type_name="gh_string" type_code="10">targetVectorID</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="1">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1257</X>
                          <Y>1284</Y>
                          <W>50</W>
                          <H>24</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1282.943</X>
                          <Y>1296.321</Y>
                        </item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="54">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">30637faa-89e2-4e76-ad55-ab56f094e4ef</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>1775</Y>
                          <W>215</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1240.453</X>
                          <Y>1775.682</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">1</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">5000</item>
                        <item name="Min" type_name="gh_double" type_code="6">0</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">0</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="55">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">e89117e1-dcb4-43fc-825e-60f56c7abee3</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>1896</Y>
                          <W>246</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1240.677</X>
                          <Y>1896.586</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">1</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">5000</item>
                        <item name="Min" type_name="gh_double" type_code="6">0</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">10</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="56">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">2e3ab970-8545-46bb-836c-1c11e5610bce</item>
                <item name="Name" type_name="gh_string" type_code="10">Integer</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="7">
                    <item name="Description" type_name="gh_string" type_code="10">Contains a collection of integer numbers</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">6910b25e-d174-40ea-94be-549766bc8513</item>
                    <item name="Name" type_name="gh_string" type_code="10">Integer</item>
                    <item name="NickName" type_name="gh_string" type_code="10">boundTrailID</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="Source" index="0" type_name="gh_guid" type_code="9">23a4040b-6f2c-4154-8637-3023ab331904</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                  </items>
                  <chunks count="1">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1254</X>
                          <Y>1858</Y>
                          <W>50</W>
                          <H>24</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1279.069</X>
                          <Y>1870.044</Y>
                        </item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="57">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">0091e6a0-1cfc-4ea5-a890-8ba3e2a92e8b</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1241</X>
                          <Y>1946</Y>
                          <W>246</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1241.116</X>
                          <Y>1946.754</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">1</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">5000</item>
                        <item name="Min" type_name="gh_double" type_code="6">0</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">10</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="58">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">e64c5fb1-845c-4ab1-8911-5f338516ba67</item>
                <item name="Name" type_name="gh_string" type_code="10">Series</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="4">
                    <item name="Description" type_name="gh_string" type_code="10">Create a series of numbers.</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">0d63cd78-02f6-4db2-ab76-c83cdaca01f0</item>
                    <item name="Name" type_name="gh_string" type_code="10">Series</item>
                    <item name="NickName" type_name="gh_string" type_code="10">Series</item>
                  </items>
                  <chunks count="5">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1144</X>
                          <Y>1838</Y>
                          <W>65</W>
                          <H>64</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1176</X>
                          <Y>1870</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="param_input" index="0">
                      <items count="6">
                        <item name="Description" type_name="gh_string" type_code="10">First number in the series</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">54198dca-3a54-428b-83e5-6a1fe1caf8ca</item>
                        <item name="Name" type_name="gh_string" type_code="10">Start</item>
                        <item name="NickName" type_name="gh_string" type_code="10">S</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="2">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>1146</X>
                              <Y>1840</Y>
                              <W>15</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>1155</X>
                              <Y>1850</Y>
                            </item>
                          </items>
                        </chunk>
                        <chunk name="PersistentData">
                          <items count="1">
                            <item name="Count" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Branch" index="0">
                              <items count="2">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Item" index="0">
                                  <items count="1">
                                    <item name="number" type_name="gh_double" type_code="6">0</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_input" index="1">
                      <items count="6">
                        <item name="Description" type_name="gh_string" type_code="10">Step size for each successive number</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">52349f99-ee93-4a5b-9daa-6ead9c041c5d</item>
                        <item name="Name" type_name="gh_string" type_code="10">Step</item>
                        <item name="NickName" type_name="gh_string" type_code="10">N</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="2">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>1146</X>
                              <Y>1860</Y>
                              <W>15</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>1155</X>
                              <Y>1870</Y>
                            </item>
                          </items>
                        </chunk>
                        <chunk name="PersistentData">
                          <items count="1">
                            <item name="Count" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Branch" index="0">
                              <items count="2">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Item" index="0">
                                  <items count="1">
                                    <item name="number" type_name="gh_double" type_code="6">1</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_input" index="2">
                      <items count="6">
                        <item name="Description" type_name="gh_string" type_code="10">Number of values in the series</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">c7199ad0-1683-4b7c-8d70-a48411aa3487</item>
                        <item name="Name" type_name="gh_string" type_code="10">Count</item>
                        <item name="NickName" type_name="gh_string" type_code="10">C</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="2">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>1146</X>
                              <Y>1880</Y>
                              <W>15</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>1155</X>
                              <Y>1890</Y>
                            </item>
                          </items>
                        </chunk>
                        <chunk name="PersistentData">
                          <items count="1">
                            <item name="Count" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Branch" index="0">
                              <items count="2">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Item" index="0">
                                  <items count="1">
                                    <item name="number" type_name="gh_int32" type_code="3">11</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_output" index="0">
                      <items count="7">
                        <item name="Access" type_name="gh_int32" type_code="3">1</item>
                        <item name="Description" type_name="gh_string" type_code="10">Series of numbers</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">23a4040b-6f2c-4154-8637-3023ab331904</item>
                        <item name="Name" type_name="gh_string" type_code="10">Series</item>
                        <item name="NickName" type_name="gh_string" type_code="10">S</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>1191</X>
                              <Y>1840</Y>
                              <W>16</W>
                              <H>60</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>1199</X>
                              <Y>1870</Y>
                            </item>
                          </items>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="59">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">2013e425-8713-42e2-a661-b57e78840337</item>
                <item name="Name" type_name="gh_string" type_code="10">Concatenate</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="4">
                    <item name="Description" type_name="gh_string" type_code="10">Concatenate some fragments of text</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">e7d57165-d548-441a-b8a9-d7f4c36e18a7</item>
                    <item name="Name" type_name="gh_string" type_code="10">Concatenate</item>
                    <item name="NickName" type_name="gh_string" type_code="10">Concat</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1374</X>
                          <Y>1835</Y>
                          <W>65</W>
                          <H>44</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1405</X>
                          <Y>1857</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="5">
                        <item name="InputCount" type_name="gh_int32" type_code="3">2</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">3ede854e-c753-40eb-84cb-b48008f14fd4</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">3ede854e-c753-40eb-84cb-b48008f14fd4</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">3ede854e-c753-40eb-84cb-b48008f14fd4</item>
                      </items>
                      <chunks count="3">
                        <chunk name="InputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">First text fragment</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">11ef6a83-d91a-49af-b9c4-e161ca05b1cf</item>
                            <item name="Name" type_name="gh_string" type_code="10">Fragment A</item>
                            <item name="NickName" type_name="gh_string" type_code="10">A</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="2">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1376</X>
                                  <Y>1837</Y>
                                  <W>14</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1384.5</X>
                                  <Y>1847</Y>
                                </item>
                              </items>
                            </chunk>
                            <chunk name="PersistentData">
                              <items count="1">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Branch" index="0">
                                  <items count="2">
                                    <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                    <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                                  </items>
                                  <chunks count="1">
                                    <chunk name="Item" index="0">
                                      <items count="2">
                                        <item name="null_string" type_name="gh_bool" type_code="1">false</item>
                                        <item name="string" type_name="gh_string" type_code="10">T</item>
                                      </items>
                                    </chunk>
                                  </chunks>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="7">
                            <item name="Description" type_name="gh_string" type_code="10">Second text fragment</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">aac3d146-d211-4b2f-ba69-4c2bae44c007</item>
                            <item name="Name" type_name="gh_string" type_code="10">Fragment B</item>
                            <item name="NickName" type_name="gh_string" type_code="10">B</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">6910b25e-d174-40ea-94be-549766bc8513</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1376</X>
                                  <Y>1857</Y>
                                  <W>14</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1384.5</X>
                                  <Y>1867</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Resulting text consisting of all the fragments</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">a406af23-4cf8-4c29-b242-a479859a4e05</item>
                            <item name="Name" type_name="gh_string" type_code="10">Result</item>
                            <item name="NickName" type_name="gh_string" type_code="10">R</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1420</X>
                                  <Y>1837</Y>
                                  <W>17</W>
                                  <H>40</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1428.5</X>
                                  <Y>1857</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="60">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">2e3ab970-8545-46bb-836c-1c11e5610bce</item>
                <item name="Name" type_name="gh_string" type_code="10">Integer</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="7">
                    <item name="Description" type_name="gh_string" type_code="10">Contains a collection of integer numbers</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">a1950b2b-7ff0-4d78-bafd-49003deb190d</item>
                    <item name="Name" type_name="gh_string" type_code="10">Integer</item>
                    <item name="NickName" type_name="gh_string" type_code="10">boundDevID</item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="Source" index="0" type_name="gh_guid" type_code="9">8876c1ec-4691-4d9e-99ae-681ab41f2994</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                  </items>
                  <chunks count="1">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1252</X>
                          <Y>2037</Y>
                          <W>50</W>
                          <H>24</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1277.717</X>
                          <Y>2049.834</Y>
                        </item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="61">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">57da07bd-ecab-415d-9d86-af36d7073abc</item>
                <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="6">
                    <item name="Description" type_name="gh_string" type_code="10">Numeric slider for single values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">d7978c6b-5a1d-410d-856d-a9152361f2f8</item>
                    <item name="Name" type_name="gh_string" type_code="10">Number Slider</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1240</X>
                          <Y>2116</Y>
                          <W>246</W>
                          <H>20</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1240.551</X>
                          <Y>2116.092</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="Slider">
                      <items count="7">
                        <item name="Digits" type_name="gh_int32" type_code="3">1</item>
                        <item name="GripDisplay" type_name="gh_int32" type_code="3">1</item>
                        <item name="Interval" type_name="gh_int32" type_code="3">0</item>
                        <item name="Max" type_name="gh_double" type_code="6">5000</item>
                        <item name="Min" type_name="gh_double" type_code="6">0</item>
                        <item name="SnapCount" type_name="gh_int32" type_code="3">0</item>
                        <item name="Value" type_name="gh_double" type_code="6">10</item>
                      </items>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="62">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">e64c5fb1-845c-4ab1-8911-5f338516ba67</item>
                <item name="Name" type_name="gh_string" type_code="10">Series</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="4">
                    <item name="Description" type_name="gh_string" type_code="10">Create a series of numbers.</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">b6a705d9-ec0e-4b54-a61e-d70ecd1b7bdb</item>
                    <item name="Name" type_name="gh_string" type_code="10">Series</item>
                    <item name="NickName" type_name="gh_string" type_code="10">Series</item>
                  </items>
                  <chunks count="5">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1148</X>
                          <Y>2017</Y>
                          <W>65</W>
                          <H>64</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1180</X>
                          <Y>2049</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="param_input" index="0">
                      <items count="6">
                        <item name="Description" type_name="gh_string" type_code="10">First number in the series</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">ce3e465e-8331-407f-bdca-7cf567d429b7</item>
                        <item name="Name" type_name="gh_string" type_code="10">Start</item>
                        <item name="NickName" type_name="gh_string" type_code="10">S</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="2">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>1150</X>
                              <Y>2019</Y>
                              <W>15</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>1159</X>
                              <Y>2029</Y>
                            </item>
                          </items>
                        </chunk>
                        <chunk name="PersistentData">
                          <items count="1">
                            <item name="Count" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Branch" index="0">
                              <items count="2">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Item" index="0">
                                  <items count="1">
                                    <item name="number" type_name="gh_double" type_code="6">12</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_input" index="1">
                      <items count="6">
                        <item name="Description" type_name="gh_string" type_code="10">Step size for each successive number</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">cf89ac79-99e3-4081-b923-f79e4340261d</item>
                        <item name="Name" type_name="gh_string" type_code="10">Step</item>
                        <item name="NickName" type_name="gh_string" type_code="10">N</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="2">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>1150</X>
                              <Y>2039</Y>
                              <W>15</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>1159</X>
                              <Y>2049</Y>
                            </item>
                          </items>
                        </chunk>
                        <chunk name="PersistentData">
                          <items count="1">
                            <item name="Count" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Branch" index="0">
                              <items count="2">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Item" index="0">
                                  <items count="1">
                                    <item name="number" type_name="gh_double" type_code="6">1</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_input" index="2">
                      <items count="6">
                        <item name="Description" type_name="gh_string" type_code="10">Number of values in the series</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">ecd972d0-d199-46ad-b70c-1e7bf896c33d</item>
                        <item name="Name" type_name="gh_string" type_code="10">Count</item>
                        <item name="NickName" type_name="gh_string" type_code="10">C</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="2">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>1150</X>
                              <Y>2059</Y>
                              <W>15</W>
                              <H>20</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>1159</X>
                              <Y>2069</Y>
                            </item>
                          </items>
                        </chunk>
                        <chunk name="PersistentData">
                          <items count="1">
                            <item name="Count" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Branch" index="0">
                              <items count="2">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Item" index="0">
                                  <items count="1">
                                    <item name="number" type_name="gh_int32" type_code="3">16</item>
                                  </items>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                    <chunk name="param_output" index="0">
                      <items count="7">
                        <item name="Access" type_name="gh_int32" type_code="3">1</item>
                        <item name="Description" type_name="gh_string" type_code="10">Series of numbers</item>
                        <item name="InstanceGuid" type_name="gh_guid" type_code="9">8876c1ec-4691-4d9e-99ae-681ab41f2994</item>
                        <item name="Name" type_name="gh_string" type_code="10">Series</item>
                        <item name="NickName" type_name="gh_string" type_code="10">S</item>
                        <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                        <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Attributes">
                          <items count="2">
                            <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                              <X>1195</X>
                              <Y>2019</Y>
                              <W>16</W>
                              <H>60</H>
                            </item>
                            <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                              <X>1203</X>
                              <Y>2049</Y>
                            </item>
                          </items>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="63">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">2013e425-8713-42e2-a661-b57e78840337</item>
                <item name="Name" type_name="gh_string" type_code="10">Concatenate</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="4">
                    <item name="Description" type_name="gh_string" type_code="10">Concatenate some fragments of text</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">0497979e-029a-4a9e-9efe-17a5391e4b1f</item>
                    <item name="Name" type_name="gh_string" type_code="10">Concatenate</item>
                    <item name="NickName" type_name="gh_string" type_code="10">Concat</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="2">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>1374</X>
                          <Y>2014</Y>
                          <W>65</W>
                          <H>44</H>
                        </item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>1405</X>
                          <Y>2036</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="ParameterData">
                      <items count="5">
                        <item name="InputCount" type_name="gh_int32" type_code="3">2</item>
                        <item name="InputId" index="0" type_name="gh_guid" type_code="9">3ede854e-c753-40eb-84cb-b48008f14fd4</item>
                        <item name="InputId" index="1" type_name="gh_guid" type_code="9">3ede854e-c753-40eb-84cb-b48008f14fd4</item>
                        <item name="OutputCount" type_name="gh_int32" type_code="3">1</item>
                        <item name="OutputId" index="0" type_name="gh_guid" type_code="9">3ede854e-c753-40eb-84cb-b48008f14fd4</item>
                      </items>
                      <chunks count="3">
                        <chunk name="InputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">First text fragment</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">113431c9-3d80-435c-9201-02420db37700</item>
                            <item name="Name" type_name="gh_string" type_code="10">Fragment A</item>
                            <item name="NickName" type_name="gh_string" type_code="10">A</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="2">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1376</X>
                                  <Y>2016</Y>
                                  <W>14</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1384.5</X>
                                  <Y>2026</Y>
                                </item>
                              </items>
                            </chunk>
                            <chunk name="PersistentData">
                              <items count="1">
                                <item name="Count" type_name="gh_int32" type_code="3">1</item>
                              </items>
                              <chunks count="1">
                                <chunk name="Branch" index="0">
                                  <items count="2">
                                    <item name="Count" type_name="gh_int32" type_code="3">1</item>
                                    <item name="Path" type_name="gh_string" type_code="10">{0}</item>
                                  </items>
                                  <chunks count="1">
                                    <chunk name="Item" index="0">
                                      <items count="2">
                                        <item name="null_string" type_name="gh_bool" type_code="1">false</item>
                                        <item name="string" type_name="gh_string" type_code="10">D</item>
                                      </items>
                                    </chunk>
                                  </chunks>
                                </chunk>
                              </chunks>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="InputParam" index="1">
                          <items count="7">
                            <item name="Description" type_name="gh_string" type_code="10">Second text fragment</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">21bdd547-edb2-4b5e-ad57-fb3aa7b2f6cb</item>
                            <item name="Name" type_name="gh_string" type_code="10">Fragment B</item>
                            <item name="NickName" type_name="gh_string" type_code="10">B</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">true</item>
                            <item name="Source" index="0" type_name="gh_guid" type_code="9">a1950b2b-7ff0-4d78-bafd-49003deb190d</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1376</X>
                                  <Y>2036</Y>
                                  <W>14</W>
                                  <H>20</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1384.5</X>
                                  <Y>2046</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                        <chunk name="OutputParam" index="0">
                          <items count="6">
                            <item name="Description" type_name="gh_string" type_code="10">Resulting text consisting of all the fragments</item>
                            <item name="InstanceGuid" type_name="gh_guid" type_code="9">e2f19f88-a407-404f-b400-7920351312ac</item>
                            <item name="Name" type_name="gh_string" type_code="10">Result</item>
                            <item name="NickName" type_name="gh_string" type_code="10">R</item>
                            <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                            <item name="SourceCount" type_name="gh_int32" type_code="3">0</item>
                          </items>
                          <chunks count="1">
                            <chunk name="Attributes">
                              <items count="2">
                                <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                                  <X>1420</X>
                                  <Y>2016</Y>
                                  <W>17</W>
                                  <H>40</H>
                                </item>
                                <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                                  <X>1428.5</X>
                                  <Y>2036</Y>
                                </item>
                              </items>
                            </chunk>
                          </chunks>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="64">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">59e0b89a-e487-49f8-bab8-b5bab16be14c</item>
                <item name="Name" type_name="gh_string" type_code="10">Panel</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="9">
                    <item name="Description" type_name="gh_string" type_code="10">A panel for custom notes and text values</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">6b20b51a-1303-4e5d-b5e7-ef6d718656d8</item>
                    <item name="Name" type_name="gh_string" type_code="10">Panel</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                    <item name="Optional" type_name="gh_bool" type_code="1">false</item>
                    <item name="ScrollRatio" type_name="gh_double" type_code="6">0</item>
                    <item name="Source" index="0" type_name="gh_guid" type_code="9">e0d07d91-702a-4374-8b7e-f3e6e5c497b3</item>
                    <item name="SourceCount" type_name="gh_int32" type_code="3">1</item>
                    <item name="UserText" type_name="gh_string" type_code="10">Double click to edit panel content…</item>
                  </items>
                  <chunks count="2">
                    <chunk name="Attributes">
                      <items count="5">
                        <item name="Bounds" type_name="gh_drawing_rectanglef" type_code="35">
                          <X>2510</X>
                          <Y>470</Y>
                          <W>444</W>
                          <H>574</H>
                        </item>
                        <item name="MarginLeft" type_name="gh_int32" type_code="3">0</item>
                        <item name="MarginRight" type_name="gh_int32" type_code="3">21</item>
                        <item name="MarginTop" type_name="gh_int32" type_code="3">0</item>
                        <item name="Pivot" type_name="gh_drawing_pointf" type_code="31">
                          <X>2510.65</X>
                          <Y>470.6151</Y>
                        </item>
                      </items>
                    </chunk>
                    <chunk name="PanelProperties">
                      <items count="7">
                        <item name="Colour" type_name="gh_drawing_color" type_code="36">
                          <ARGB>255;255;255;255</ARGB>
                        </item>
                        <item name="DrawIndices" type_name="gh_bool" type_code="1">false</item>
                        <item name="DrawPaths" type_name="gh_bool" type_code="1">false</item>
                        <item name="Multiline" type_name="gh_bool" type_code="1">true</item>
                        <item name="SpecialCodes" type_name="gh_bool" type_code="1">false</item>
                        <item name="Stream" type_name="gh_bool" type_code="1">false</item>
                        <item name="Wrap" type_name="gh_bool" type_code="1">true</item>
                      </items>
                      <chunks count="1">
                        <chunk name="Font">
                          <items count="2">
                            <item name="Family" type_name="gh_string" type_code="10">Courier New</item>
                            <item name="Size" type_name="gh_single" type_code="5">8</item>
                          </items>
                        </chunk>
                      </chunks>
                    </chunk>
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="65">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">c552a431-af5b-46a9-a8a4-0fcbc27ef596</item>
                <item name="Name" type_name="gh_string" type_code="10">Group</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="21">
                    <item name="Border" type_name="gh_int32" type_code="3">1</item>
                    <item name="Colour" type_name="gh_drawing_color" type_code="36">
                      <ARGB>150;127;219;66</ARGB>
                    </item>
                    <item name="Description" type_name="gh_string" type_code="10">A group of Grasshopper objects</item>
                    <item name="ID" index="0" type_name="gh_guid" type_code="9">312bd41b-ca79-47c3-b1da-1c109bacfc2f</item>
                    <item name="ID" index="1" type_name="gh_guid" type_code="9">e7291208-4884-4a61-8513-2a4acf53647c</item>
                    <item name="ID" index="2" type_name="gh_guid" type_code="9">10f752a8-a273-4caa-8dd2-bdd81296b024</item>
                    <item name="ID" index="3" type_name="gh_guid" type_code="9">bb7350c0-ebc3-4f5b-b4e9-dec17413ffd5</item>
                    <item name="ID" index="4" type_name="gh_guid" type_code="9">d54af319-7fdb-4aeb-9a94-1f2c9c5cb649</item>
                    <item name="ID" index="5" type_name="gh_guid" type_code="9">b5e5237d-534d-4823-80b2-00955e8e1fe3</item>
                    <item name="ID" index="6" type_name="gh_guid" type_code="9">975873b3-c21e-4f57-bd5d-1e072de1672a</item>
                    <item name="ID" index="7" type_name="gh_guid" type_code="9">a847a333-6c84-40ee-ae67-9432356b1a88</item>
                    <item name="ID" index="8" type_name="gh_guid" type_code="9">4ffc0dfc-f146-4a7f-b29b-49ef66c29d6e</item>
                    <item name="ID" index="9" type_name="gh_guid" type_code="9">a84b9765-6d5f-4d88-8f44-69171189d187</item>
                    <item name="ID" index="10" type_name="gh_guid" type_code="9">78ab3ff7-bf46-42c5-8905-b92a8cb033b4</item>
                    <item name="ID" index="11" type_name="gh_guid" type_code="9">3901472b-d20b-44de-a3e2-eaf6e709a6e8</item>
                    <item name="ID" index="12" type_name="gh_guid" type_code="9">47897302-9fea-4128-961d-7801c009c67b</item>
                    <item name="ID" index="13" type_name="gh_guid" type_code="9">0a88a001-f0a2-44c6-9184-6b232e4de7af</item>
                    <item name="ID_Count" type_name="gh_int32" type_code="3">14</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">f2ce8cd3-6cb6-48ea-8793-abf801393be9</item>
                    <item name="Name" type_name="gh_string" type_code="10">Group</item>
                    <item name="NickName" type_name="gh_string" type_code="10">CEM_Build_Topology</item>
                  </items>
                  <chunks count="1">
                    <chunk name="Attributes" />
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
            <chunk name="Object" index="66">
              <items count="2">
                <item name="GUID" type_name="gh_guid" type_code="9">c552a431-af5b-46a9-a8a4-0fcbc27ef596</item>
                <item name="Name" type_name="gh_string" type_code="10">Group</item>
              </items>
              <chunks count="1">
                <chunk name="Container">
                  <items count="47">
                    <item name="Border" type_name="gh_int32" type_code="3">1</item>
                    <item name="Colour" type_name="gh_drawing_color" type_code="36">
                      <ARGB>150;136;194;235</ARGB>
                    </item>
                    <item name="Description" type_name="gh_string" type_code="10">A group of Grasshopper objects</item>
                    <item name="ID" index="0" type_name="gh_guid" type_code="9">4163c080-6465-4b0b-a20e-09bfb6103258</item>
                    <item name="ID" index="1" type_name="gh_guid" type_code="9">8bd1b861-1c18-4024-86eb-0a72a820c36a</item>
                    <item name="ID" index="2" type_name="gh_guid" type_code="9">1cee786c-1a85-428e-8d5c-4c8b766bd569</item>
                    <item name="ID" index="3" type_name="gh_guid" type_code="9">10117d4f-52c1-4184-a1f6-99e0b48cdc72</item>
                    <item name="ID" index="4" type_name="gh_guid" type_code="9">e2dae991-e948-4af1-bb80-65e55b098fda</item>
                    <item name="ID" index="5" type_name="gh_guid" type_code="9">3267af80-ec77-49b1-94eb-4655a81d51c7</item>
                    <item name="ID" index="6" type_name="gh_guid" type_code="9">7207f535-b0a0-4661-a545-92dc1b04ced1</item>
                    <item name="ID" index="7" type_name="gh_guid" type_code="9">1bb3363e-e511-497d-83d4-410b1bafbbb9</item>
                    <item name="ID" index="8" type_name="gh_guid" type_code="9">1ae57ce7-e9ab-4ebf-b3de-4aac7a3cd932</item>
                    <item name="ID" index="9" type_name="gh_guid" type_code="9">d0445907-ea21-4eed-853b-5e4cea0064d8</item>
                    <item name="ID" index="10" type_name="gh_guid" type_code="9">dfd879d9-09e1-493f-87b6-4225b6657c7b</item>
                    <item name="ID" index="11" type_name="gh_guid" type_code="9">70484985-959a-4db7-a19e-cff190dfe7d9</item>
                    <item name="ID" index="12" type_name="gh_guid" type_code="9">3c9ae2af-49b7-475a-b179-8dbf58757e89</item>
                    <item name="ID" index="13" type_name="gh_guid" type_code="9">9a4fc475-3760-4a0a-b613-7874cb9bf4d5</item>
                    <item name="ID" index="14" type_name="gh_guid" type_code="9">cbe5355c-8c2b-43fc-b045-26f320fa8394</item>
                    <item name="ID" index="15" type_name="gh_guid" type_code="9">ec8b6f04-8757-407a-9e54-2a27426729e0</item>
                    <item name="ID" index="16" type_name="gh_guid" type_code="9">8c452fa7-ada3-4044-a807-11ebfb0011ee</item>
                    <item name="ID" index="17" type_name="gh_guid" type_code="9">4a8f075e-0c4c-4ba0-b638-5f05f9238923</item>
                    <item name="ID" index="18" type_name="gh_guid" type_code="9">34c6449e-0172-4310-87a4-7a03cc983935</item>
                    <item name="ID" index="19" type_name="gh_guid" type_code="9">2bf139b6-53d1-458f-954b-acaa5492cf76</item>
                    <item name="ID" index="20" type_name="gh_guid" type_code="9">9c8503be-0683-40a5-ad3d-13f8c2902a11</item>
                    <item name="ID" index="21" type_name="gh_guid" type_code="9">36b9d765-08a5-4e7e-ad88-833a3447e9b4</item>
                    <item name="ID" index="22" type_name="gh_guid" type_code="9">a2b124ff-1377-4c97-b8c3-4d88ff8ceed0</item>
                    <item name="ID" index="23" type_name="gh_guid" type_code="9">4e74f640-39f8-46ab-8ccb-e1ee27da2845</item>
                    <item name="ID" index="24" type_name="gh_guid" type_code="9">ee7e33d6-0d02-4683-9b4d-7089b0636d96</item>
                    <item name="ID" index="25" type_name="gh_guid" type_code="9">9d808c17-2f71-45dd-b295-57163d9818bb</item>
                    <item name="ID" index="26" type_name="gh_guid" type_code="9">91d4d19b-fcbd-41fd-84c5-98f05074876b</item>
                    <item name="ID" index="27" type_name="gh_guid" type_code="9">8fd9df30-dd68-4030-a669-838441176593</item>
                    <item name="ID" index="28" type_name="gh_guid" type_code="9">bb875710-33dc-4b80-9752-4c6278c60077</item>
                    <item name="ID" index="29" type_name="gh_guid" type_code="9">965f158e-2fe0-4e80-b18f-b81e95ab78ea</item>
                    <item name="ID" index="30" type_name="gh_guid" type_code="9">30637faa-89e2-4e76-ad55-ab56f094e4ef</item>
                    <item name="ID" index="31" type_name="gh_guid" type_code="9">e89117e1-dcb4-43fc-825e-60f56c7abee3</item>
                    <item name="ID" index="32" type_name="gh_guid" type_code="9">6910b25e-d174-40ea-94be-549766bc8513</item>
                    <item name="ID" index="33" type_name="gh_guid" type_code="9">0091e6a0-1cfc-4ea5-a890-8ba3e2a92e8b</item>
                    <item name="ID" index="34" type_name="gh_guid" type_code="9">0d63cd78-02f6-4db2-ab76-c83cdaca01f0</item>
                    <item name="ID" index="35" type_name="gh_guid" type_code="9">e7d57165-d548-441a-b8a9-d7f4c36e18a7</item>
                    <item name="ID" index="36" type_name="gh_guid" type_code="9">a1950b2b-7ff0-4d78-bafd-49003deb190d</item>
                    <item name="ID" index="37" type_name="gh_guid" type_code="9">d7978c6b-5a1d-410d-856d-a9152361f2f8</item>
                    <item name="ID" index="38" type_name="gh_guid" type_code="9">b6a705d9-ec0e-4b54-a61e-d70ecd1b7bdb</item>
                    <item name="ID" index="39" type_name="gh_guid" type_code="9">0497979e-029a-4a9e-9efe-17a5391e4b1f</item>
                    <item name="ID_Count" type_name="gh_int32" type_code="3">40</item>
                    <item name="InstanceGuid" type_name="gh_guid" type_code="9">3d1844a8-91a6-4ea7-b9cc-23e6504622da</item>
                    <item name="Name" type_name="gh_string" type_code="10">Group</item>
                    <item name="NickName" type_name="gh_string" type_code="10"></item>
                  </items>
                  <chunks count="1">
                    <chunk name="Attributes" />
                  </chunks>
                </chunk>
              </chunks>
            </chunk>
          </chunks>
        </chunk>
      </chunks>
    </chunk>
    <chunk name="Thumbnail">
      <items count="1">
        <item name="Thumbnail" type_name="gh_drawing_bitmap" type_code="37">
          <bitmap length="10134">iVBORw0KGgoAAAANSUhEUgAAAJYAAABkCAIAAADrOV6nAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAACcrSURBVHhe7Z1ZbBsJnt47QIAgG+xMkkmyWAQ7uTBAFoPdh7zkLS+7QJJNgM1cuzvA7A5mMT3TnZ3O9Ljttts6bEuyDor3fd/3LZK6JeokxbOqxEsndVKyfMjudu9O9i35qopWk5IlU7Rsj48/vi4Ui5Qs1o/f/6gqVr/3Lt6E+H/v4rWNrxD6yDsvSH7qrjuzbZrL+ciDmo33bamCI73sp+4dbXx+4d8yzJfGqfJ+ZWf3zNjZ2VleXmb3wiuJL7/8slgs7u3tVf+gpgK/52UghAKL9xzJdWushJXqFhph3plevViEXmLPMF+czG2/Q3jxAjxLLO9Kb8Eo9EPqvjVJOTPr7MML0oEnu2uMlSZzO+8QXrz8zP41x3JHCC3JrDu7ge21L3s+vUP4gkVjWyi40pugiPxpTqQ9xE5tgXx+eYmKIVZ4h/BFyU8duDJblng+QN2D+cyJlJfcO/aa55chlptY3HyH8EUJ/jPHKTQdXnLfnExerAUhmNsQz4+Sq3cq1Td5WrzJCP2Ld/3oG08X/SzV5K7HLrYlSs70upesAOHFtqMQk5+XhzL5O8/aNW8gwoH8g2D+/kDhoTez402sBTNbASi9CfmSZc/CWo1WvZlKcxThQldmw5ooeogtSzKN6njsBc8p5Gd7eiuUSh+8hQg1o6RuIicNJ8yu8OjwlMXisljcLlfQ6QyEw+Mz04npaGxyMg6NDU/ZJkh/rsm9j47Dksg5syvWFHHhCCE3cRBMJvZ2t6vv8pR4AxHqJ/P6yQIQipQ2pdza1ycXCnW9PdLubolGbddoA0LlmNkSsVkjeo3bNJodKD1iGkt48Xx2xE9ZEzlrirSn8/4XgNBL3g+ksuWN4l5lv/pGnxZvIEJDtGCcLilHsgK5RaN29vcre3tlWPJ4KrHE8fMb45yOz9R97R235TKJiafzOtO7zuSmK7Xlyexix7FzQiM44TxbsmhMzLuyq37ygmsh5CbvDhMrxdXk/t6d6ht9WryZLgRC9RjJk5qkYhPM19Mj43CUPd3irn6PqPWD4db/IOwV3u5VigU6Lo1wx76wbouvWmIly3zBEi/aE6ue7A5AAuex3VorOM+RWtbFxzzE9oXO9VW5iINofrewktjcLld2T21M30CE1vk1w1RRFkl0ceSdt/i3bvFv3uS1t/ffaO/ncdUKkYLL0cgUbqXCLuRpdIPJ0NLntPPQvjLAAM+RXDPHc+b4ojNdPgMknnKkV9WxkI86/tSFiEaY213fKBTWsvuVU434BiKUhRY0Y6R6lOjgKK5+2nH1WldrG+fKpx2XL9/s7BRx+jV9/ZrePgXU1SFUDcQGig/r990Bg+2eO7tjWciZ4gSgPrVbAVpnZlU5HwhQD449dSECwonFLcyF5HJsZ/fUAf8NRDhQOMRcESo+dCY2LdNF6+ySZaZknV2GzFNFU7RwJGM0707vMo3M8d0HITeCnCuzZYyn7KnlkxT9JBCuaeMjAerw2FMXIhbh3b390jpZWqdOM+IbiPBoFwRy94L0jHiWTuN3JDrHUnfNC4Q1mTtGES2MI7OkiQ8GqGM+vhixCPcrOzu728Ty3Gnl8E1GeHGi7WhJkNbkYi1FtDP2zKIq5n/RCPf3DvJr6aXy4lON+A5howI8cyJjTxWPKh9WbJmsJh46mWMvREcI4b/tna3s8kxl9ym76R3CxoU2565xIe7O0ueYsAUILZmUbmHER541ezStI4R4h/uVg9xacmnjKUZ8h/AcAjmMgKCIRgYPGYRxfWLCR+7XvuyiVIsQRtza2UwvRysnjtS8coS//vWvC4XC64EQopNnahHCip+8b87MG5LTHmL3vAfnGlEtQgSMuLi2sLRxvDWtVCowQblc3nwVsbGxscLEa4MQggWNiZiXqGAFCE2peVjzJSBkKuJmZgVGfMrOAsJXFQCJj1H172g2Xi5CNKLpkiVFYMWcmTOnEm5i4yUgROxX7i6uP8WIb0C8VIQQ/GdKxDzEFlxoSadd2XW2Ol6sTiJkjZhenXyqEV/reNkIMUXY0wVLKmXNJq3pDHOm4mUgRNyhjRgvbZBvmBHrENKncOsvsDhd95u+8AJdKHpRS3bBliGd2aUXcbLpqQjZ1jS1OvGGGbEOoXO25I2veBdWsAwk1wOpcjC9QStV9ifXq08x8sSX6XOETVEMUA+NyRl9asiezTuyBXSnx17w/HoqQgSMSK3PL22Se2+QEesQDvi9w0MTkxNxyOsJO50Bm9Vjsbgddp/PG5mKLkxHYxPj89DoUNQ6QTR34QVzgLSoTUQc2ZI9Q/nJiz9ZcRpCxojl9Or4G4tQKVfrdG6TccBmG5RKzT09sr4+hVCg53JVUqlJr/N2CwZ1hojVEtKpXaZRIrzymLli6kEwdz+Qu8ecOGzElwceclu5YLdncrZMBmPiiRc8r05DiIARifWZlc3cG0OxDqHd4tRqXXq9H8w4HPqqCwjrt2+LhQLtR+1DbTd6TD0fdXSr5FJzr9KmHqPUo4R2jNJP5k3TS9b5NVcKc94d5jK4QyxPIYqNe6qk3ZyK2bJAePHnm85AWNndK2+vpNcmMO9XN73mUYdQKlYoFFadzicQ6Lq6RN3dEh5Pw4CU84S2zrbeoeu/q+y50S8wiwS6fq1HFy1qQHEkqxxMycIJSWBe6J0WeKZEvhl5OKGbyDmTWwzOk2em9vSZiD4xjqYm8BITKRswYmZtcn176anHvl+7qENoM1uEAk1rS++N9v621r5bN/ltbX0dt7Dk3LzJU8kN3F6lWOZSyK0C5sKLyMpjZFHkUkCiTxcXkFHp9tKR2DROFRWDKaFvBkRVwxl3ejdUPKwBeWAmovrkuCE99jJrIRtIoStbi8T6NFhWN73OUYeQ0yfo7pFeb+n99GpXS3v39bau1lZB+w0etnSwF15wtX0cJQSPqkPxExdeVAVUYMnmUhhRNZzluSalA3FPdg+Y6ReQD8zEtDkdUyUcL7kWsrG3u59cG8awT2fW1zzqEBqnSpaZJdvcqn1+3TybV0z51dPD1rklx/yWdXbFPFMyzyxVNV3yZCqNNC94DVii2dGOL/bbR5FdQ3hIPrQQcw4iJ18weskL/mYT9EyE9Ji/EctvJN6AiliHEKYJPFEwDw89dFJ5Ezlhp7KB/L2BPJ02madoNcKvVqz/kFdloXi48IWdyDpIUpsctGdzFz4aPhMhpouNnbXU+sibhvDYjoACJNrFA2s2ZciMWjMJL1lhLpVo0jSgHio+lATnZaGEv7BjJqasmYwxNRWkHh175XPqmQgRgAeEAAmc1S3nCfZHLir26qO6tbF4BkJWDMg7GAAA0pKJecgtZMKmD4yBIrxojC5bcxNOoqhM2i98rmgEIXJpbiNW2KRzaaVS2dnZKdRFcXl5eWVldWlpubrhSeTzhVJp6d4pcffu3eoaE3j4zLh//365XMY/t8TEysoK/pjqX9lANISQFUD6ybv2LGnMjJmy005iCQmQtemxV54teNGb3eM7ZqxE3EESyqT1wg+zNYKwsru/tl3MlifAEh/8tbXVSGRibCw+OhrDcmhoxmLxqtVmh2NgfBwb57Gd1eRk0mbzejyeaDQ6Xh+Tk5PYiOVRTNXEzMzM7OwslrUxNzcXDofxU5ubm/gz4O9isbi2ttb4ecRzIGSFZhK7G/xMmWmwtBEZL7nLmPIcDDBgKAfT6tGMNR81ZkY1KW+QenzsNc+jRhAitne2kuuDmA4ZhGtWa9Bqjdhs0KDVGlarXTKZVav1OBxDzMYjDen1zng8lsvlqPpYZIIkSYIgsGQjw0Q2m2U3Yj1dE9g+PT0NlvgDWPPl8/kXi5AVsiiwechtazYBBqZsFO2lj9xvMMHCiJgdxd6EI580kePypMZL7F3gpVANItyr7CfLg1s75f29few1uz1ktw8BmNM5DIQikZ7DUXA4cj5f7XSOYDsrl2tUrbb4/T4Ya6I+WNvBUkcBNiDEQoIFT8b8/HwkEhkbG4P5tra28FfhQ7C+vv7CET7RAZNd7zmJZXN21pAdNmdnUN6esEQLemqOxZgh9E570nsmakSZ0RrS40Hq82OvaVoNItyv3E2XR9a3S/v7d4DQZqMPDtvttOA2nQ6J1KlSOfR6H7vxiYaMRje8hOqF/X7Mi0cuPDIi60LEkQtTqVTVg+k0HgIkAAMbEJZKJWxpHqGLwJtvVL6ar7ywpsQKvGjOThuyI/ClnSDQ+ADkkzRbhxMzhnQgZp0r+xa31aROkuT7CPzCizFigwhRBYFwbbtwh0FosQQsljD8B05Go7+3V9rTI8FDOA/LIzkcw3K50eNxY78nEgl0H2hbHjx4cOfOHbZZxcrZcVAT+EFkzlAoBMBwbU9PD37tua6pqUM4Ess90eLYQn48URyJ50bjOayPxvPYWH02nhuaI13xVd/i8T3ONDj01IFiaSFixuyoMTtmIeaBlsFJP8tUU/rYjSKSNETzA7kv3OQ6L/uxKmUboP7uQi5LbNyFqfLQ+vYS68IjhJDFEtLpPFqt22TCxtARP0YRg8GVzWZgKRgIaTAYDIIli6f6qxsOlGG4GRkYbh4aGkLKRXVs3oWRgUloMDQV9I1KRWohXy4RqWUSLZZGvXMoPMW+IBKKBj1DppGUP3/qsTHWl2DmITftBGUhZmmcxIiFmEEH5CKXgoU7ysGsYWIllP8iSP6tm1rpT//Kls0OUL8+Z4uLF9cJhbZBhGhkFsoDO7tb6ASB0Gz2m80hFhiSZ3e3uKtL2NkpQEbFFmxnhWQrkejS6dTh4SE7Fayuro6MjPh8PsCAI6u/vbEAdXwU3G53LBaDoTFUxONxIATa6iueFXUIjcYgo4DBEMAHUCIxazRuCPVApXJaLQNWs99kDptMA1q1yzCcChQamecOjnIp2h8HkbcSMRMxYcmNC8dN8hmvfXHBTtIp10nmualP0N0EyEdB8nGA/JwptHQDjA8Ec4nNEafqL/cv3vVmHnjS9yF36l5VyXuuzIPJ3DMQ7tFDRSGxEb5Tucd2pCaTD2/NbKZlMgWxBzQaF94+jMhufPJUCB3p6uoKyw/JEBgw2yEfulwu1LlzUcQ/jU8ABhKYjy2lYNk8QoPBjz8df/TNm9y2tt6ODj4+g6z6OTKh1PeztlGFRIc3plbaNaFYsECffAgs3mXPKNEnK/IP6LvknXrsDTjpXAqFCo9kkXndzIJjMWshZ0HOQk6ps5bu9I+kZK+JHDGSw3Yy4yRzQOskiy5yxUNugLSX3PaSFS+55188sC9sGGIO04LRnDA7CJs9S8tBmLRzkXEKefIshAeVBwsbA8vb1N7uHRah0ejFJxh7AJwwS+Bd37rFu31bJBBoYT5sZ4VkCxdaLObh4WGYD3scDMASFPFrMS+iyWTXGwl8AtC/4KdgPlCEI1EL8cc0iRBWUyodcrlNLreKREaZzIJ1vAGsaLWuD6849R3/09XxvY5urUxivMFVCv1zIt8MLf+sJDgvDyc0o6RpZtmd3mGgHsIlJyhWBeTiwLw9thlcpImyNg1SXyCXCtLXtZRNQxmVpAydjp70GslBEzlmJifM5DhWTNSoiRy2lcb7veaPo//553P//sOZ/3h1+Q+vFP8A+mT53302/f5k9u7ptw6q3K0cEpvR5MYgLIjHLEKDwa3X+/E5Rh5CIsVciPSjUNhgRyYz0U8xQoqyl0pFeAV7HFNEIBBARUR3itQKR4IHSmODXkTNQ/PCHhZAIWRnkubbmU8/7bhy5WZra19ray97jvCzz25fvdqJZWsbV8qXma79VzFXoVJ7xEK9KjgXKDzwZPfc6V1HYov9krd6hJAOxDEtQIrBlD1eBirMD8f4QaBLDxWZSv32fVC0Z0lZRgRaTnIRLrSRCTMFbCNmasJKzdrIBTuVspNZd76gm1746ch/+vHcv3o/9c33M79HK/3Nn2T/6cfjfxkl7p9EiOJ3p3K/sltJbQ4tbAT3d9F90C9iEer1Lp3OZzD4AAz8YMEbN/qRiq5fv40PMfwHrhCcKhCoUqkkrAZgQMXWM9RCmBLrCGRUpERYk/13zw7WcBtMlMtljBaN80PUIeRyNXy+js/X8ngagYBegQQCfXe3lNuvksvtIrlfKrdLpWYBT6MJLwSr5wvpDoJOp/Q5Qjqdgpkzua0dp4Q++iS+ZXaFdmRtdqUOnKlt2Df4lAuoMFM+cmXX1Bm7lnSZqUk7mXaTa6ijbrKMjIrsaqPiVmrGUZrnB+0/cv3+d9z/8q+i//pnmd/5SfL3fpr5t3+d+ee/Gv+rKfLhQQX7Zn+/cgBsSJvoPzd2VsmtqfkN9+LWLPzHnLXHzsLr9rDvDAYP7UK9S6v1avVB+A8uVCrt4MdOh+hrGMGg1kIhv71N39cGmZAdKgAMORCNCbbv7Ow4HA7YFDMGu6PPDjCrjerWxqIO4ZVL7R/97ysff3Tt8qW2S79swcOrl2/+8hdXsbGtpUfA1fD6Vax6O4VK/+xA6dQzDADGnM0/tMXWQVHsnwO2o5vJArZxqojEixcc/UitAuQDL1ExZ2aM2SE6f1ITJmrITI1aqTkHSaChxRziz+0borm/HvqDH8e+8ePp3/1z0e33uVfeH/3tv5j9+oeh7w4lVzcrxeVtMr8VS2+MxMv+2XX77LojszFa3l7d3alsbpc3tzegre1NcMzlFqVSg0JubukNf9jqU/E5N24KurpEbW19sCM+yrAmCiQEzAKB2mazDg4ODgwMIIVOTEygjIHc48ePC4WC3W5HJkRviYwKhOdFct6oQyg0BPk6H5YiQ1CoD2JFqA+IDANi4wAeCnT+I3HVbnO0gIJ3bNefFLCFig/Z871ImyxFkAM/Q7T4NBdWhRYUHSk6WFM2asnO2Iks+hoHRdmoJCxogTuLU7yA9UfBb/1w6mt/4vr2jdb2aNu3f2L42p+OfO3Hlv9imnQld3wzZfvkmn58VTu76kqvjeXXk4W1zOJqIreazK9mCqvZwgpVXMmtb2IqGO7q4t/u1V5t1URufkt/629Eci/8JxbTPYFIZIDAD72eWu1WKExra6vAw6JCFzo6OoqKiCXSIPIhKILowsICRr3zjhnnjTqEGBLQZGL5TAWLhwyMRsdwULTMrXDso3Q6hR1z9wSeKIpo7YTwVDFDxQMXfaBgxkiMmohJKxlDIXSSBV++rJ1M/9D3re+Gv/b9iX/xkeMf/1z3238x9zs/nP1HH4R/MEM9vr9376ByH53L3QqS6n1k1L3KHUb7NdqD7uzfQSLVaBxqbVAj4Kpu/EIkcaAQYi5ET9DRIUBb0NenQIJFx6fReLhcBUZ7JE/6YMz+PptLsTfRxXi9XrQk8CJKI/Izula0rC+UYh3CY7vvYhUqHsKL6ELDpUfofVAIT8uiJ8UcKHgEll5yF1kUcyR6HGcxKQx5v2f75n+3/pPvh/7Zn8194wdz3/jhxDe+H/2HPw99b4p88MybWR4F286oVDalwqFSe1W6MDpzAV8L5yGFCoV6CCsymZVp2p0ymQHtTKlUwjAOI4IiOyCyrQ2GCjgSrU0oFMJTgIqRscHWpol4eQihUOGQ74b5dtCs6ibyjeRhZo4EvEMMgmhq6FxKEnYqbaMSzkJaPj78A++/+e7Ib31n4Ot/PvH1Pxuj9Z3xf/DT4J+eC+H+Po1QocAQZVco7OAnlVpu3OCiFra3oylFURR3dgrRxzEIXTyewufzIm2Gw2FwQmAdFoSVQRGjBXIpEGo0GlRK1EKn04nWBnSr/96FxktFCGaGaEEWXpAE5jCNHHu2VkwhRK+07yBJNKUGKmSggkYqgonQQk1ZqXm40FPMCYLB/2b4rT92v/dH1vf+R/i9Pxmg9cfB937k+qNp6vC8COVys0yGmRhC121B5kRn3tcn53LVWEdbjocATHfmIs3q6gp7aBs/jp8lCAJNTTAYRPHDOIF5AyBRI3t6egAYBRINKvz6Iii+VIQQamGnLoDZcaB4WhY9ADw0nBjh9ZTPRI3RIyBZZrYf4ilGD+FL+iF1yBm1dw3Lb4+quoZUXcO0OgalvInBaG7vmcdIj4JFKJOZpFIrsiUoSiQm1L/bt8WsF+FC9l5m4Af198uKxcLnn3/O5k8sYT62NGJABDOwRDlEgwpsHA4HrSlSLjIqvHjhGfVlI4wsfd4mc8CLT5/36cOhd1l4mP8YbJ+jBJ7R9UTyfzeY//vB/P+t0d8HFr9s5N7cR8EilEqNEokF/gNFsdjU0yMDQrjw1i1+b6+sp4d2IejCqRjtg8HA+Pg4ek6KomBBLFEa8UtQVsFyeXkZI8fY2BgeAiQyqkwmw4tRI/FKeBSwq/82E8w0+FVUtzYWLxUhLOjN7l0TGB2JzZPH3sDPS+7oSJeVnGcOuTXa7JxUg2cqjuIYQgiNDMyH+geKWAFOVMT+fhUSKZzK56s8HjcmB6lUqlAogGpychIpFKURkyJciC1zc3OwnUqlikaj8CtKo0QiAVej0Ygl3Pno0aOHDx+yPt7Z2VlfRyWFS9fwX/XPaizqEdLf/WxY57yOFELyVI8QSKS2ePlozGcF83nJio50ouGE82qfakLNIRSL9SKRCf6TSMxoQTs6hEienZ2i1tY+sARIdgUuRCKNRifRZ+ZyuenpaZDDLwESeI6BsY6nkskkxgnQAjk+n49aqNPpBAIBEPb19bW0tAiFQrfbjR9HH4SqicxcLIHg7ma5XFoq4Vexf9szow5hIL0RSG1gGaTvx11dob8imtn0p8rehVVvYq0q+t7czXxFVOSfRSG0zK0G6l0I2xnIkINcZLuY2qeaUHMIRSKdUGgUiYygKBDob9+WoAR2d9NLNqmCH1obOBVz4ezsDPb7DBNwGyAheX7xxRdIkmxdhMMAFQELokEFS4vFotdjOOGr1WpkVJgY2VUsRq7uw4egWCQ97qzdUYgMDy1SVOONTx1CrycUDAx73CG7zevzRjzuAZczgI02qwfbZ6aT0WgcmooujI9On/fe3AOFB7CgZpSUR5L2hTJ7GyhWqHYOkjKSw0Hyi6ONz6PzI9xfW1sVCrUCgUEoNIAiyh6G+paWXrQz1651YYlehjkB0Mfj6fr6JJgmMP+BHwZ5pE3A+OCDD0wmE9ImzIftSKRYQf2DHbPZbLFYxBKzB+zY29vb0dGBHAuQs7OzeA26WYqkTAbr++G/+cD9vxbTxSYRisUGdGISsVEmNWOSRT3AQ6QUgUCn1SD1D9qs9I25rdaIWe8zDKUCp5+1PykUQp5zAitC77S7/gQFLGgkB13kCkb42u1NqzmEAoGWz8ebpcXjaeFCCLMElowL2YcyYIYL5+fn0MVkmAAb9DLwGfyE0uj3+7GRBcwyBlf6AreJCaRNBOoiXqPV4p/jI7X29/eD/dDgoNfj7/EKJH4hmWnWhXK5VSJBJoHZNVhiXSjUgSuPp1apHEB4dP2IUe9lzto3ihAW1IyR8nAC+RMI6wvhAboYAxm5KH5QEwgx5+FtcrlawOPz4TPltWu3r1zp/OyznkuXbly/3oOVy5c7Pvnk5vXrqIh8gsiyZwfZQEuCh2CDoRCmBDkkUiRVdCsn4yjTIseygZpKm5XIFok8kSBg2WMt6xlRh1AqNclkFpATi41Yx6dSqcSEREPVat21148YdB7ahQ0fIcMIAQt6iT1UQXoorGEPck6yxFxvwZ66ugCdFyF6B7SDIhFGeHl/v5LLVXI48o4OfkcH2hn60oWuLiG7fusWr62tTyhUrawsH9vLALm0tAR7gSXmDbSmeEGDXQleyX4U2Gi8l0HUIYTnOBzFk0tgFfhUYom3hJIulZptNhTFgNFEX1yjVTv1Q8kGEQKYdoyShuJDq18qh9La8cXaQ2uYJRwkaSFmXiFCBKYxdDRoSdjAJL56SuAZtCdPdQlsh2qHKohZEEUObQ5+beN+ai6OudAM/8F26KrZI7xIrUikQKvVOIRS92c9Eb3eZzIG1Eq7cSQzuPolc46XvmMCfEafhTixNyGMgFzHuDuzO1A4FPlm6KGw5pXoZew0wtlXixABz2B3NxKnuQTAMFS4XC54GnkyHo9jbMB2GIt9wYuIOoRII0wPLbp1i48emlnHbCtCDuHxTB+0hmWdP1O2f3C1lS+TmDpFOmk4gfIGY6HOGaeK9oUN7D5wqjUZHqIRlUcS4dJDZ2pb4J06do6QcWHOTEy/coQXEih16G58Ph+qIwoeBg8Q3drawsPqKy466hDCeein2RMrWKKxZjtSWjK/+OaVUMu3JVyZQGiSodOxRCyxsnG6pJ/MA5IsvICZD62KJDCvm8j5iH3AY90GC3rpr2gfgjR4Y6V2d2OoRy9qIiae53DMMb1ChAh0K5OTk2hQ2bYFjavT6WQv+j5m9Fo3Y/0oznWMrQ5hR4cAcw9ceONGPyMulu3tHPRjXK5KrXIIxU6l2qNSOSVCvX4oFVr6HPkTrmKvscAS5NCwwHM81wRohUuP1KMEiw3PCr1TcGrtRMiI7kiNxMgr7EgvPOBF9KXoaDY3NzHvo4KiLoJluby+ura6trGxxlTVzc0N5FgWJyoxU2jpYK/KaTDqELL+Y6RDb93fr2K3YF0sNjFnYWwyGX0sX8jXakLx4NPONmBsCDHbQY5jH+XYRpBXgQ3wBJ6p2l70SMilRmLMQ17YvUlfOULYCBTZk/joTguFAuZ3p9M/Nj4/Njw1YHIMDUUHB+HUsUIhjz4WvQ8GCfAGPNRRrMOL1d/1rKhDyB59YC88bGnpuX69u6WlF+PR5cs3URdlMgwYZlZ8rlodij25gu3pGl77WzBrkViRRSNLn8sjSSTYp57mRRVEO+MgLuxL968cIRugiO4GA180Oonh/eZNbj9P33O5o79D3N2j6OqS8niKYDCArItMm8/nUTJhRywxXDaJkMvFbAtpOBwMRir2nGd/P0YLjEoaGBGVkhWXo1QPnIUQtnMmt9j+E7UQszzfPXnsNUeiOxoCHc2FzRW/IQgRsCMaGQwbWLFY3BqNVasy6Q0ug8HJ5ysFAikAUxQVjUbRBCGRwoXIqM0jvHrl1qWPW6592nH5UvvlS22f/Krtyic3Ln3c+n9+cfVmO1fI18F8rHq7xPRFiKcjDBUfiv1zaFMHVx6rR7J9liG0PMcamVp5yT1j9sJumP+bg/AogJBpX75abm1t5vO5+fl5uBCzB0ACIVyLWoj1JhH2ikxQj8jYJzZj5bZAz5FYmI30ln6plSO10JJYegR6/SiBcfDYvmOFHsc6v1ZT+fY/5encZ96nBv4zZaNOonQhTc1vIEI2AJINdh29DJLt4eHh3NwcWJZKJYvFgiGk+VpInzxCu0gdeNmVxbvMCr2OlWM6ec72SCAHfrbYOvIng3P9M6EJFfEMhEwuLZizFzMd/sYifGqg/qHlicfjaGrUanUsFkMixcbq08+Kkwgb1okdx4q+xmmqKA7M0X0pPR0+kARjPOeEeXYZOI+9uFYYEJFLvWTl+fvS1xEhAvmTzaKoi80iPLEvmhCch6HQldpBRwNm7HFt7fiirv7Q6ElhtLdmk7Zs+vln/NcLIdLpxMQEOhoMjvBfmrkNxitDiIYFszzmhycWPBR4ptGUopd5JkJmxt81ZEafvxy+dgjZr2inUilYED0qKDaJ0EPddRN3XNl9VxZLZoV9SNx5sv2J6m+XwAqlzkvsc5nzuuABO7JNDZpS+hsUU0X2VpdnCIXQnKFvr8dctXb82cb12iFEFo1EImhNZ2ZmxsbGwBIbq08/K+oQekfnIjOZ0djiyDw1ytwoYXieGlvIY4ntzO0SKAgvGJrNumIr9EVQNTsOzgMqzRjJNqKMBacscyvhpUcojcB5Rgf0RPgMbRoy428VQrZHRRfK3B2Mjs2mvyJq0Wt97oGRwTmz0S0SKFVyk0RI3y6B3y+VS3SDoanIQJRWKDrgHTKPpGsvvKBn+dQ2qiDbs7BVkJkrDtkz9W7m/7r9TNHTRWbmOW/p9XohRAAYMicb8F/j/BB1CJVyncnoM5tDRmNAp/NqtR7mG5Hs0muxfHXW3qjz0Bde1CCszvLTJbbghWgLRkExmLuP1kbkmz27HT0S+lI3sWFIjz/PDZ9fO4TPE3UIdRqN1eoXi02dnYLeXtnt2yKot1fa3s7hclU2W+SI4pMLL6p7mS57sa9medDCCAHnIbVi/exvg55UgEJFnH0eI769CJUKnUHvZj2n0WCFvncO871I+t4dNXftCOo0LkPNhRds2QNF1moAyXdPsqM9npKFFkDxmb1Mje56iC1jeuIdwkaiDqFWrYYPOzqE7F1zoO5uCYzY0tLTx1FYzPR9BAymiNkU1KgcxuE0e5gbmRP5U+SfZc8xIXPSD30z7EO0MHxP9OzvMZ1UgDq0ZOL2bK65O3e/vQgVcq1O51KpXHK5TaVySqVmrDBfx7KqlNYOXujDGxE1v18itaoUNplr3M3c7gLOQ87EOMFmURBFU8N+awKNDDpSsX+28Sz6RJgRKzBicwe+3+JEKlfodA6BQN/a2tvVJbp5k77g7tYt3vXr3Zx+7bUbluCt3ze0/+W1NrFMYrrJUwkD89JgrEPja5FYVSNZ/WSerYKSwDxrQSxlobh+sqFv5R8TjGjNZKyZbBP3DH6LXShTK5VWIJRIzAKBjjk1aBCL6atpBCKTSiRWtn8okTpRHaUig24wGV5+DOf1O8Zs8bJpZgk9i9A3fU1ocqW26YswmL0JRx7t2fPrwJCabOKo6duLUCaRyeVG5qZBXPgPjShz+Qz32rXbPd1SpcotVweZvGoTCXSacDyy8qV6lEC3Ei49hP8GVx7rJnKduiBaGyTScOkRfCkNxVlHNiEUQns2b0kvnNeIby9CuUzFuNDA4ah4PG1fn4I5X0+fte/tlbNfvGNF3zqI+V+NcB1jaFXYs0iofHiIpTO51WcdxkZMijBoAwdlTlWAum9MTWNSxLx47Kkz9PYiFAnEcrmpr095/XoP+73klpZe9mqaW7f4yK4YGVnx+lX6obRuMq8YZI5oHx3gDifwEFkUQ32veVA6EGN7nKblJ++5squm1Oy5WtO3uZ1RSyX0VyPhOfqrdcz3enp6ZF2dos4OYfXCGaEB4vYp1AMxoX/WS08LtAXhuRpH7g+tfNkmd5y8arQJIYuaUjH6/zdKNdoTvb0Iub0cTq/4k1+1X77UfuWTG5/8qu0ylpfaf/nRtatXbvX2yHq7pay6O0XdKrd6jDqyoGo4o2DPMWEnMuf02xVO1XD2OV0IIYV6iB1jctpPNXpw4C124UBcHU7ohzP64XStDCMZ3VAaT2kijJiVHmPYQ+yzVRCiL9km9tmz+WxSxbAojySfHyFEDxjpjC1NNZhO316EaE8aUWTlsWl2hcHzlQWVg+nQk5xJH5FxT9rjZXFg7oy7rJ1XMKKXrObts/X2InwXr2lUEb6L1zjee+//AwWFPqoW/Z6OAAAAAElFTkSuQmCC</bitmap>
        </item>
      </items>
    </chunk>
  </chunks>
</Archive>